var Ir,xe,Nl,wn,Ca,Dl,Ol,Hl,zl,kn,xn,bn,Fl,Rr={},Bl=[],_u=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Nr=Array.isArray;function Kt(t,a){for(var r in a)t[r]=a[r];return t}function Sn(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function e(t,a,r){var s,n,o,l={};for(o in a)o=="key"?s=a[o]:o=="ref"?n=a[o]:l[o]=a[o];if(arguments.length>2&&(l.children=arguments.length>3?Ir.call(arguments,2):r),typeof t=="function"&&t.defaultProps!=null)for(o in t.defaultProps)l[o]===void 0&&(l[o]=t.defaultProps[o]);return Dr(t,l,s,n,null)}function Dr(t,a,r,s,n){var o={type:t,props:a,key:r,ref:s,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:n??++Nl,__i:-1,__u:0};return n==null&&xe.vnode!=null&&xe.vnode(o),o}function W(t){return t.children}function Jt(t,a){this.props=t,this.context=a}function or(t,a){if(a==null)return t.__?or(t.__,t.__i+1):null;for(var r;a<t.__k.length;a++)if((r=t.__k[a])!=null&&r.__e!=null)return r.__e;return typeof t.type=="function"?or(t):null}function jl(t){var a,r;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,a=0;a<t.__k.length;a++)if((r=t.__k[a])!=null&&r.__e!=null){t.__e=t.__c.base=r.__e;break}return jl(t)}}function hn(t){(!t.__d&&(t.__d=!0)&&Ca.push(t)&&!us.__r++||Dl!=xe.debounceRendering)&&((Dl=xe.debounceRendering)||Ol)(us)}function us(){for(var t,a,r,s,n,o,l,i=1;Ca.length;)Ca.length>i&&Ca.sort(Hl),t=Ca.shift(),i=Ca.length,t.__d&&(r=void 0,s=void 0,n=(s=(a=t).__v).__e,o=[],l=[],a.__P&&((r=Kt({},s)).__v=s.__v+1,xe.vnode&&xe.vnode(r),An(a.__P,r,s,a.__n,a.__P.namespaceURI,32&s.__u?[n]:null,o,n??or(s),!!(32&s.__u),l),r.__v=s.__v,r.__.__k[r.__i]=r,Vl(o,r,l),s.__e=s.__=null,r.__e!=n&&jl(r)));us.__r=0}function Ul(t,a,r,s,n,o,l,i,u,d,y){var f,m,b,h,C,A,M,_=s&&s.__k||Bl,k=a.length;for(u=wu(r,a,_,u,k),f=0;f<k;f++)(b=r.__k[f])!=null&&(m=b.__i==-1?Rr:_[b.__i]||Rr,b.__i=f,A=An(t,b,m,n,o,l,i,u,d,y),h=b.__e,b.ref&&m.ref!=b.ref&&(m.ref&&Cn(m.ref,null,b),y.push(b.ref,b.__c||h,b)),C==null&&h!=null&&(C=h),(M=!!(4&b.__u))||m.__k===b.__k?u=Wl(b,u,t,M):typeof b.type=="function"&&A!==void 0?u=A:h&&(u=h.nextSibling),b.__u&=-7);return r.__e=C,u}function wu(t,a,r,s,n){var o,l,i,u,d,y=r.length,f=y,m=0;for(t.__k=new Array(n),o=0;o<n;o++)(l=a[o])!=null&&typeof l!="boolean"&&typeof l!="function"?(typeof l=="string"||typeof l=="number"||typeof l=="bigint"||l.constructor==String?l=t.__k[o]=Dr(null,l,null,null,null):Nr(l)?l=t.__k[o]=Dr(W,{children:l},null,null,null):l.constructor===void 0&&l.__b>0?l=t.__k[o]=Dr(l.type,l.props,l.key,l.ref?l.ref:null,l.__v):t.__k[o]=l,u=o+m,l.__=t,l.__b=t.__b+1,i=null,(d=l.__i=ku(l,r,u,f))!=-1&&(f--,(i=r[d])&&(i.__u|=2)),i==null||i.__v==null?(d==-1&&(n>y?m--:n<y&&m++),typeof l.type!="function"&&(l.__u|=4)):d!=u&&(d==u-1?m--:d==u+1?m++:(d>u?m--:m++,l.__u|=4))):t.__k[o]=null;if(f)for(o=0;o<y;o++)(i=r[o])!=null&&(2&i.__u)==0&&(i.__e==s&&(s=or(i)),ql(i,i));return s}function Wl(t,a,r,s){var n,o;if(typeof t.type=="function"){for(n=t.__k,o=0;n&&o<n.length;o++)n[o]&&(n[o].__=t,a=Wl(n[o],a,r,s));return a}t.__e!=a&&(s&&(a&&t.type&&!a.parentNode&&(a=or(t)),r.insertBefore(t.__e,a||null)),a=t.__e);do a=a&&a.nextSibling;while(a!=null&&a.nodeType==8);return a}function ps(t,a){return a=a||[],t==null||typeof t=="boolean"||(Nr(t)?t.some(function(r){ps(r,a)}):a.push(t)),a}function ku(t,a,r,s){var n,o,l,i=t.key,u=t.type,d=a[r],y=d!=null&&(2&d.__u)==0;if(d===null&&i==null||y&&i==d.key&&u==d.type)return r;if(s>(y?1:0)){for(n=r-1,o=r+1;n>=0||o<a.length;)if((d=a[l=n>=0?n--:o++])!=null&&(2&d.__u)==0&&i==d.key&&u==d.type)return l}return-1}function Rl(t,a,r){a[0]=="-"?t.setProperty(a,r??""):t[a]=r==null?"":typeof r!="number"||_u.test(a)?r:r+"px"}function ds(t,a,r,s,n){var o,l;e:if(a=="style")if(typeof r=="string")t.style.cssText=r;else{if(typeof s=="string"&&(t.style.cssText=s=""),s)for(a in s)r&&a in r||Rl(t.style,a,"");if(r)for(a in r)s&&r[a]==s[a]||Rl(t.style,a,r[a])}else if(a[0]=="o"&&a[1]=="n")o=a!=(a=a.replace(zl,"$1")),l=a.toLowerCase(),a=l in t||a=="onFocusOut"||a=="onFocusIn"?l.slice(2):a.slice(2),t.l||(t.l={}),t.l[a+o]=r,r?s?r.u=s.u:(r.u=kn,t.addEventListener(a,o?bn:xn,o)):t.removeEventListener(a,o?bn:xn,o);else{if(n=="http://www.w3.org/2000/svg")a=a.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(a!="width"&&a!="height"&&a!="href"&&a!="list"&&a!="form"&&a!="tabIndex"&&a!="download"&&a!="rowSpan"&&a!="colSpan"&&a!="role"&&a!="popover"&&a in t)try{t[a]=r??"";break e}catch{}typeof r=="function"||(r==null||r===!1&&a[4]!="-"?t.removeAttribute(a):t.setAttribute(a,a=="popover"&&r==1?"":r))}}function Il(t){return function(a){if(this.l){var r=this.l[a.type+t];if(a.t==null)a.t=kn++;else if(a.t<r.u)return;return r(xe.event?xe.event(a):a)}}}function An(t,a,r,s,n,o,l,i,u,d){var y,f,m,b,h,C,A,M,_,k,S,O,$,H,I,j,B,L=a.type;if(a.constructor!==void 0)return null;128&r.__u&&(u=!!(32&r.__u),o=[i=a.__e=r.__e]),(y=xe.__b)&&y(a);e:if(typeof L=="function")try{if(M=a.props,_="prototype"in L&&L.prototype.render,k=(y=L.contextType)&&s[y.__c],S=y?k?k.props.value:y.__:s,r.__c?A=(f=a.__c=r.__c).__=f.__E:(_?a.__c=f=new L(M,S):(a.__c=f=new Jt(M,S),f.constructor=L,f.render=Au),k&&k.sub(f),f.state||(f.state={}),f.__n=s,m=f.__d=!0,f.__h=[],f._sb=[]),_&&f.__s==null&&(f.__s=f.state),_&&L.getDerivedStateFromProps!=null&&(f.__s==f.state&&(f.__s=Kt({},f.__s)),Kt(f.__s,L.getDerivedStateFromProps(M,f.__s))),b=f.props,h=f.state,f.__v=a,m)_&&L.getDerivedStateFromProps==null&&f.componentWillMount!=null&&f.componentWillMount(),_&&f.componentDidMount!=null&&f.__h.push(f.componentDidMount);else{if(_&&L.getDerivedStateFromProps==null&&M!==b&&f.componentWillReceiveProps!=null&&f.componentWillReceiveProps(M,S),a.__v==r.__v||!f.__e&&f.shouldComponentUpdate!=null&&f.shouldComponentUpdate(M,f.__s,S)===!1){for(a.__v!=r.__v&&(f.props=M,f.state=f.__s,f.__d=!1),a.__e=r.__e,a.__k=r.__k,a.__k.some(function(q){q&&(q.__=a)}),O=0;O<f._sb.length;O++)f.__h.push(f._sb[O]);f._sb=[],f.__h.length&&l.push(f);break e}f.componentWillUpdate!=null&&f.componentWillUpdate(M,f.__s,S),_&&f.componentDidUpdate!=null&&f.__h.push(function(){f.componentDidUpdate(b,h,C)})}if(f.context=S,f.props=M,f.__P=t,f.__e=!1,$=xe.__r,H=0,_){for(f.state=f.__s,f.__d=!1,$&&$(a),y=f.render(f.props,f.state,f.context),I=0;I<f._sb.length;I++)f.__h.push(f._sb[I]);f._sb=[]}else do f.__d=!1,$&&$(a),y=f.render(f.props,f.state,f.context),f.state=f.__s;while(f.__d&&++H<25);f.state=f.__s,f.getChildContext!=null&&(s=Kt(Kt({},s),f.getChildContext())),_&&!m&&f.getSnapshotBeforeUpdate!=null&&(C=f.getSnapshotBeforeUpdate(b,h)),j=y,y!=null&&y.type===W&&y.key==null&&(j=Gl(y.props.children)),i=Ul(t,Nr(j)?j:[j],a,r,s,n,o,l,i,u,d),f.base=a.__e,a.__u&=-161,f.__h.length&&l.push(f),A&&(f.__E=f.__=null)}catch(q){if(a.__v=null,u||o!=null)if(q.then){for(a.__u|=u?160:128;i&&i.nodeType==8&&i.nextSibling;)i=i.nextSibling;o[o.indexOf(i)]=null,a.__e=i}else{for(B=o.length;B--;)Sn(o[B]);_n(a)}else a.__e=r.__e,a.__k=r.__k,q.then||_n(a);xe.__e(q,a,r)}else o==null&&a.__v==r.__v?(a.__k=r.__k,a.__e=r.__e):i=a.__e=Su(r.__e,a,r,s,n,o,l,u,d);return(y=xe.diffed)&&y(a),128&a.__u?void 0:i}function _n(t){t&&t.__c&&(t.__c.__e=!0),t&&t.__k&&t.__k.forEach(_n)}function Vl(t,a,r){for(var s=0;s<r.length;s++)Cn(r[s],r[++s],r[++s]);xe.__c&&xe.__c(a,t),t.some(function(n){try{t=n.__h,n.__h=[],t.some(function(o){o.call(n)})}catch(o){xe.__e(o,n.__v)}})}function Gl(t){return typeof t!="object"||t==null||t.__b&&t.__b>0?t:Nr(t)?t.map(Gl):Kt({},t)}function Su(t,a,r,s,n,o,l,i,u){var d,y,f,m,b,h,C,A=r.props||Rr,M=a.props,_=a.type;if(_=="svg"?n="http://www.w3.org/2000/svg":_=="math"?n="http://www.w3.org/1998/Math/MathML":n||(n="http://www.w3.org/1999/xhtml"),o!=null){for(d=0;d<o.length;d++)if((b=o[d])&&"setAttribute"in b==!!_&&(_?b.localName==_:b.nodeType==3)){t=b,o[d]=null;break}}if(t==null){if(_==null)return document.createTextNode(M);t=document.createElementNS(n,_,M.is&&M),i&&(xe.__m&&xe.__m(a,o),i=!1),o=null}if(_==null)A===M||i&&t.data==M||(t.data=M);else{if(o=o&&Ir.call(t.childNodes),!i&&o!=null)for(A={},d=0;d<t.attributes.length;d++)A[(b=t.attributes[d]).name]=b.value;for(d in A)if(b=A[d],d!="children"){if(d=="dangerouslySetInnerHTML")f=b;else if(!(d in M)){if(d=="value"&&"defaultValue"in M||d=="checked"&&"defaultChecked"in M)continue;ds(t,d,null,b,n)}}for(d in M)b=M[d],d=="children"?m=b:d=="dangerouslySetInnerHTML"?y=b:d=="value"?h=b:d=="checked"?C=b:i&&typeof b!="function"||A[d]===b||ds(t,d,b,A[d],n);if(y)i||f&&(y.__html==f.__html||y.__html==t.innerHTML)||(t.innerHTML=y.__html),a.__k=[];else if(f&&(t.innerHTML=""),Ul(a.type=="template"?t.content:t,Nr(m)?m:[m],a,r,s,_=="foreignObject"?"http://www.w3.org/1999/xhtml":n,o,l,o?o[0]:r.__k&&or(r,0),i,u),o!=null)for(d=o.length;d--;)Sn(o[d]);i||(d="value",_=="progress"&&h==null?t.removeAttribute("value"):h!=null&&(h!==t[d]||_=="progress"&&!h||_=="option"&&h!=A[d])&&ds(t,d,h,A[d],n),d="checked",C!=null&&C!=t[d]&&ds(t,d,C,A[d],n))}return t}function Cn(t,a,r){try{if(typeof t=="function"){var s=typeof t.__u=="function";s&&t.__u(),s&&a==null||(t.__u=t(a))}else t.current=a}catch(n){xe.__e(n,r)}}function ql(t,a,r){var s,n;if(xe.unmount&&xe.unmount(t),(s=t.ref)&&(s.current&&s.current!=t.__e||Cn(s,null,a)),(s=t.__c)!=null){if(s.componentWillUnmount)try{s.componentWillUnmount()}catch(o){xe.__e(o,a)}s.base=s.__P=null}if(s=t.__k)for(n=0;n<s.length;n++)s[n]&&ql(s[n],a,r||typeof t.type!="function");r||Sn(t.__e),t.__c=t.__=t.__e=void 0}function Au(t,a,r){return this.constructor(t,r)}function Yl(t,a,r){var s,n,o,l;a==document&&(a=document.documentElement),xe.__&&xe.__(t,a),n=(s=typeof r=="function")?null:r&&r.__k||a.__k,o=[],l=[],An(a,t=(!s&&r||a).__k=e(W,null,[t]),n||Rr,Rr,a.namespaceURI,!s&&r?[r]:n?null:a.firstChild?Ir.call(a.childNodes):null,o,!s&&r?r:n?n.__e:a.firstChild,s,l),Vl(o,t,l)}function Kl(t,a,r){var s,n,o,l,i=Kt({},t.props);for(o in t.type&&t.type.defaultProps&&(l=t.type.defaultProps),a)o=="key"?s=a[o]:o=="ref"?n=a[o]:i[o]=a[o]===void 0&&l!=null?l[o]:a[o];return arguments.length>2&&(i.children=arguments.length>3?Ir.call(arguments,2):r),Dr(t.type,i,s||t.key,n||t.ref,null)}function Jl(t){function a(r){var s,n;return this.getChildContext||(s=new Set,(n={})[a.__c]=this,this.getChildContext=function(){return n},this.componentWillUnmount=function(){s=null},this.shouldComponentUpdate=function(o){this.props.value!=o.value&&s.forEach(function(l){l.__e=!0,hn(l)})},this.sub=function(o){s.add(o);var l=o.componentWillUnmount;o.componentWillUnmount=function(){s&&s.delete(o),l&&l.call(o)}}),r.children}return a.__c="__cC"+Fl++,a.__=t,a.Provider=a.__l=(a.Consumer=function(r,s){return r.children(s)}).contextType=a,a}Ir=Bl.slice,xe={__e:function(t,a,r,s){for(var n,o,l;a=a.__;)if((n=a.__c)&&!n.__)try{if((o=n.constructor)&&o.getDerivedStateFromError!=null&&(n.setState(o.getDerivedStateFromError(t)),l=n.__d),n.componentDidCatch!=null&&(n.componentDidCatch(t,s||{}),l=n.__d),l)return n.__E=n}catch(i){t=i}throw t}},Nl=0,wn=function(t){return t!=null&&t.constructor===void 0},Jt.prototype.setState=function(t,a){var r;r=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=Kt({},this.state),typeof t=="function"&&(t=t(Kt({},r),this.props)),t&&Kt(r,t),t!=null&&this.__v&&(a&&this._sb.push(a),hn(this))},Jt.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),hn(this))},Jt.prototype.render=W,Ca=[],Ol=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Hl=function(t,a){return t.__v.__b-a.__v.__b},us.__r=0,zl=/(PointerCapture)$|Capture$/i,kn=0,xn=Il(!1),bn=Il(!0),Fl=0;var Or,ze,Tn,Zl,Hr=0,ni=[],je=xe,Ql=je.__b,Xl=je.__r,ei=je.diffed,ti=je.__c,ai=je.unmount,ri=je.__;function En(t,a){je.__h&&je.__h(ze,t,Hr||a),Hr=0;var r=ze.__H||(ze.__H={__:[],__h:[]});return t>=r.__.length&&r.__.push({}),r.__[t]}function N(t){return Hr=1,Cu(ii,t)}function Cu(t,a,r){var s=En(Or++,2);if(s.t=t,!s.__c&&(s.__=[r?r(a):ii(void 0,a),function(i){var u=s.__N?s.__N[0]:s.__[0],d=s.t(u,i);u!==d&&(s.__N=[d,s.__[1]],s.__c.setState({}))}],s.__c=ze,!ze.__f)){var n=function(i,u,d){if(!s.__c.__H)return!0;var y=s.__c.__H.__.filter(function(m){return!!m.__c});if(y.every(function(m){return!m.__N}))return!o||o.call(this,i,u,d);var f=s.__c.props!==i;return y.forEach(function(m){if(m.__N){var b=m.__[0];m.__=m.__N,m.__N=void 0,b!==m.__[0]&&(f=!0)}}),o&&o.call(this,i,u,d)||f};ze.__f=!0;var o=ze.shouldComponentUpdate,l=ze.componentWillUpdate;ze.componentWillUpdate=function(i,u,d){if(this.__e){var y=o;o=void 0,n(i,u,d),o=y}l&&l.call(this,i,u,d)},ze.shouldComponentUpdate=n}return s.__N||s.__}function le(t,a){var r=En(Or++,3);!je.__s&&li(r.__H,a)&&(r.__=t,r.u=a,ze.__H.__h.push(r))}function $t(t){return Hr=5,Oe(function(){return{current:t}},[])}function Oe(t,a){var r=En(Or++,7);return li(r.__H,a)&&(r.__=t(),r.__H=a,r.__h=t),r.__}function oi(t,a){return Hr=8,Oe(function(){return t},a)}function Tu(){for(var t;t=ni.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(fs),t.__H.__h.forEach(Mn),t.__H.__h=[]}catch(a){t.__H.__h=[],je.__e(a,t.__v)}}je.__b=function(t){ze=null,Ql&&Ql(t)},je.__=function(t,a){t&&a.__k&&a.__k.__m&&(t.__m=a.__k.__m),ri&&ri(t,a)},je.__r=function(t){Xl&&Xl(t),Or=0;var a=(ze=t.__c).__H;a&&(Tn===ze?(a.__h=[],ze.__h=[],a.__.forEach(function(r){r.__N&&(r.__=r.__N),r.u=r.__N=void 0})):(a.__h.forEach(fs),a.__h.forEach(Mn),a.__h=[],Or=0)),Tn=ze},je.diffed=function(t){ei&&ei(t);var a=t.__c;a&&a.__H&&(a.__H.__h.length&&(ni.push(a)!==1&&Zl===je.requestAnimationFrame||((Zl=je.requestAnimationFrame)||Mu)(Tu)),a.__H.__.forEach(function(r){r.u&&(r.__H=r.u),r.u=void 0})),Tn=ze=null},je.__c=function(t,a){a.some(function(r){try{r.__h.forEach(fs),r.__h=r.__h.filter(function(s){return!s.__||Mn(s)})}catch(s){a.some(function(n){n.__h&&(n.__h=[])}),a=[],je.__e(s,r.__v)}}),ti&&ti(t,a)},je.unmount=function(t){ai&&ai(t);var a,r=t.__c;r&&r.__H&&(r.__H.__.forEach(function(s){try{fs(s)}catch(n){a=n}}),r.__H=void 0,a&&je.__e(a,r.__v))};var si=typeof requestAnimationFrame=="function";function Mu(t){var a,r=function(){clearTimeout(s),si&&cancelAnimationFrame(a),setTimeout(t)},s=setTimeout(r,35);si&&(a=requestAnimationFrame(r))}function fs(t){var a=ze,r=t.__c;typeof r=="function"&&(t.__c=void 0,r()),ze=a}function Mn(t){var a=ze;t.__c=t.__(),ze=a}function li(t,a){return!t||t.length!==a.length||a.some(function(r,s){return r!==t[s]})}function ii(t,a){return typeof a=="function"?a(t):a}var Eu={};function vs(t,a){for(var r in a)t[r]=a[r];return t}function Pu(t,a,r){var s,n=/(?:\?([^#]*))?(#.*)?$/,o=t.match(n),l={};if(o&&o[1])for(var i=o[1].split("&"),u=0;u<i.length;u++){var d=i[u].split("=");l[decodeURIComponent(d[0])]=decodeURIComponent(d.slice(1).join("="))}t=Pn(t.replace(n,"")),a=Pn(a||"");for(var y=Math.max(t.length,a.length),f=0;f<y;f++)if(a[f]&&a[f].charAt(0)===":"){var m=a[f].replace(/(^:|[+*?]+$)/g,""),b=(a[f].match(/[+*?]+$/)||Eu)[0]||"",h=~b.indexOf("+"),C=~b.indexOf("*"),A=t[f]||"";if(!A&&!C&&(b.indexOf("?")<0||h)){s=!1;break}if(l[m]=decodeURIComponent(A),h||C){l[m]=t.slice(f).map(decodeURIComponent).join("/");break}}else if(a[f]!==t[f]){s=!1;break}return(r.default===!0||s!==!1)&&l}function $u(t,a){return t.rank<a.rank?1:t.rank>a.rank?-1:t.index-a.index}function Lu(t,a){return t.index=a,t.rank=(function(r){return r.props.default?0:Pn(r.props.path).map(Du).join("")})(t),t.props}function Pn(t){return t.replace(/(^\/+|\/+$)/g,"").split("/")}function Du(t){return t.charAt(0)==":"?1+"*+?".indexOf(t.charAt(t.length-1))||4:5}var Ru={},Ta=[],ci=[],ht=null,ui={url:$n()},Iu=Jl(ui);function $n(){var t;return""+((t=ht&&ht.location?ht.location:ht&&ht.getCurrentLocation?ht.getCurrentLocation():typeof location<"u"?location:Ru).pathname||"")+(t.search||"")}function Nu(t,a){return a===void 0&&(a=!1),typeof t!="string"&&t.url&&(a=t.replace,t=t.url),(function(r){for(var s=Ta.length;s--;)if(Ta[s].canRoute(r))return!0;return!1})(t)&&(function(r,s){s===void 0&&(s="push"),ht&&ht[s]?ht[s](r):typeof history<"u"&&history[s+"State"]&&history[s+"State"](null,null,r)})(t,a?"replace":"push"),pi(t)}function pi(t){for(var a=!1,r=0;r<Ta.length;r++)Ta[r].routeTo(t)&&(a=!0);return a}function Ou(t){if(t&&t.getAttribute){var a=t.getAttribute("href"),r=t.getAttribute("target");if(a&&a.match(/^\//g)&&(!r||r.match(/^_?self$/i)))return Nu(a)}}function Hu(t){return t.stopImmediatePropagation&&t.stopImmediatePropagation(),t.stopPropagation&&t.stopPropagation(),t.preventDefault(),!1}function zu(t){if(!(t.ctrlKey||t.metaKey||t.altKey||t.shiftKey||t.button)){var a=t.target;do if(a.localName==="a"&&a.getAttribute("href")){if(a.hasAttribute("data-native")||a.hasAttribute("native"))return;if(Ou(a))return Hu(t)}while(a=a.parentNode)}}var di=!1;function Ln(t){t.history&&(ht=t.history),this.state={url:t.url||$n()}}vs(Ln.prototype=new Jt,{shouldComponentUpdate:function(t){return t.static!==!0||t.url!==this.props.url||t.onChange!==this.props.onChange},canRoute:function(t){var a=ps(this.props.children);return this.g(a,t)!==void 0},routeTo:function(t){this.setState({url:t});var a=this.canRoute(t);return this.p||this.forceUpdate(),a},componentWillMount:function(){this.p=!0},componentDidMount:function(){var t=this;di||(di=!0,ht||addEventListener("popstate",function(){pi($n())}),addEventListener("click",zu)),Ta.push(this),ht&&(this.u=ht.listen(function(a){var r=a.location||a;t.routeTo(""+(r.pathname||"")+(r.search||""))})),this.p=!1},componentWillUnmount:function(){typeof this.u=="function"&&this.u(),Ta.splice(Ta.indexOf(this),1)},componentWillUpdate:function(){this.p=!0},componentDidUpdate:function(){this.p=!1},g:function(t,a){t=t.filter(Lu).sort($u);for(var r=0;r<t.length;r++){var s=t[r],n=Pu(a,s.props.path,s.props);if(n)return[s,n]}},render:function(t,a){var r,s,n=t.onChange,o=a.url,l=this.c,i=this.g(ps(t.children),o);if(i&&(s=Kl(i[0],vs(vs({url:o,matches:r=i[1]},r),{key:void 0,ref:void 0}))),o!==(l&&l.url)){vs(ui,l=this.c={url:o,previous:l&&l.url,current:s,path:s?s.props.path:null,matches:r}),l.router=this,l.active=s?[s]:[];for(var u=ci.length;u--;)ci[u]({});typeof n=="function"&&n(l)}return e(Iu.Provider,{value:l},s)}});var Fu=Symbol.for("preact-signals");function ys(){if(ua>1)ua--;else{for(var t,a=!1;zr!==void 0;){var r=zr;for(zr=void 0,Dn++;r!==void 0;){var s=r.o;if(r.o=void 0,r.f&=-3,!(8&r.f)&&mi(r))try{r.c()}catch(n){a||(t=n,a=!0)}r=s}}if(Dn=0,ua--,a)throw t}}function Rn(t){if(ua>0)return t();ua++;try{return t()}finally{ys()}}var be=void 0;function In(t){var a=be;be=void 0;try{return t()}finally{be=a}}var fi,zr=void 0,ua=0,Dn=0,ms=0;function vi(t){if(be!==void 0){var a=t.n;if(a===void 0||a.t!==be)return a={i:0,S:t,p:be.s,n:void 0,t:be,e:void 0,x:void 0,r:a},be.s!==void 0&&(be.s.n=a),be.s=a,t.n=a,32&be.f&&t.S(a),a;if(a.i===-1)return a.i=0,a.n!==void 0&&(a.n.p=a.p,a.p!==void 0&&(a.p.n=a.n),a.p=be.s,a.n=void 0,be.s.n=a,be.s=a),a}}function Ge(t,a){this.v=t,this.i=0,this.n=void 0,this.t=void 0,this.W=a?.watched,this.Z=a?.unwatched,this.name=a?.name}Ge.prototype.brand=Fu;Ge.prototype.h=function(){return!0};Ge.prototype.S=function(t){var a=this,r=this.t;r!==t&&t.e===void 0&&(t.x=r,this.t=t,r!==void 0?r.e=t:In(function(){var s;(s=a.W)==null||s.call(a)}))};Ge.prototype.U=function(t){var a=this;if(this.t!==void 0){var r=t.e,s=t.x;r!==void 0&&(r.x=s,t.e=void 0),s!==void 0&&(s.e=r,t.x=void 0),t===this.t&&(this.t=s,s===void 0&&In(function(){var n;(n=a.Z)==null||n.call(a)}))}};Ge.prototype.subscribe=function(t){var a=this;return Ea(function(){var r=a.value,s=be;be=void 0;try{t(r)}finally{be=s}},{name:"sub"})};Ge.prototype.valueOf=function(){return this.value};Ge.prototype.toString=function(){return this.value+""};Ge.prototype.toJSON=function(){return this.value};Ge.prototype.peek=function(){var t=be;be=void 0;try{return this.value}finally{be=t}};Object.defineProperty(Ge.prototype,"value",{get:function(){var t=vi(this);return t!==void 0&&(t.i=this.i),this.v},set:function(t){if(t!==this.v){if(Dn>100)throw new Error("Cycle detected");this.v=t,this.i++,ms++,ua++;try{for(var a=this.t;a!==void 0;a=a.x)a.t.N()}finally{ys()}}}});function aa(t,a){return new Ge(t,a)}function mi(t){for(var a=t.s;a!==void 0;a=a.n)if(a.S.i!==a.i||!a.S.h()||a.S.i!==a.i)return!0;return!1}function yi(t){for(var a=t.s;a!==void 0;a=a.n){var r=a.S.n;if(r!==void 0&&(a.r=r),a.S.n=a,a.i=-1,a.n===void 0){t.s=a;break}}}function gi(t){for(var a=t.s,r=void 0;a!==void 0;){var s=a.p;a.i===-1?(a.S.U(a),s!==void 0&&(s.n=a.n),a.n!==void 0&&(a.n.p=s)):r=a,a.S.n=a.r,a.r!==void 0&&(a.r=void 0),a=s}t.s=r}function Ma(t,a){Ge.call(this,void 0),this.x=t,this.s=void 0,this.g=ms-1,this.f=4,this.W=a?.watched,this.Z=a?.unwatched,this.name=a?.name}Ma.prototype=new Ge;Ma.prototype.h=function(){if(this.f&=-3,1&this.f)return!1;if((36&this.f)==32||(this.f&=-5,this.g===ms))return!0;if(this.g=ms,this.f|=1,this.i>0&&!mi(this))return this.f&=-2,!0;var t=be;try{yi(this),be=this;var a=this.x();(16&this.f||this.v!==a||this.i===0)&&(this.v=a,this.f&=-17,this.i++)}catch(r){this.v=r,this.f|=16,this.i++}return be=t,gi(this),this.f&=-2,!0};Ma.prototype.S=function(t){if(this.t===void 0){this.f|=36;for(var a=this.s;a!==void 0;a=a.n)a.S.S(a)}Ge.prototype.S.call(this,t)};Ma.prototype.U=function(t){if(this.t!==void 0&&(Ge.prototype.U.call(this,t),this.t===void 0)){this.f&=-33;for(var a=this.s;a!==void 0;a=a.n)a.S.U(a)}};Ma.prototype.N=function(){if(!(2&this.f)){this.f|=6;for(var t=this.t;t!==void 0;t=t.x)t.t.N()}};Object.defineProperty(Ma.prototype,"value",{get:function(){if(1&this.f)throw new Error("Cycle detected");var t=vi(this);if(this.h(),t!==void 0&&(t.i=this.i),16&this.f)throw this.v;return this.v}});function gs(t,a){return new Ma(t,a)}function xi(t){var a=t.u;if(t.u=void 0,typeof a=="function"){ua++;var r=be;be=void 0;try{a()}catch(s){throw t.f&=-2,t.f|=8,Nn(t),s}finally{be=r,ys()}}}function Nn(t){for(var a=t.s;a!==void 0;a=a.n)a.S.U(a);t.x=void 0,t.s=void 0,xi(t)}function Bu(t){if(be!==this)throw new Error("Out-of-order effect");gi(this),be=t,this.f&=-2,8&this.f&&Nn(this),ys()}function lr(t,a){this.x=t,this.u=void 0,this.s=void 0,this.o=void 0,this.f=32,this.name=a?.name,fi&&fi.push(this)}lr.prototype.c=function(){var t=this.S();try{if(8&this.f||this.x===void 0)return;var a=this.x();typeof a=="function"&&(this.u=a)}finally{t()}};lr.prototype.S=function(){if(1&this.f)throw new Error("Cycle detected");this.f|=1,this.f&=-9,xi(this),yi(this),ua++;var t=be;return be=this,Bu.bind(this,t)};lr.prototype.N=function(){2&this.f||(this.f|=2,this.o=zr,zr=this)};lr.prototype.d=function(){this.f|=8,1&this.f||Nn(this)};lr.prototype.dispose=function(){this.d()};function Ea(t,a){var r=new lr(t,a);try{r.c()}catch(n){throw r.d(),n}var s=r.d.bind(r);return s[Symbol.dispose]=s,s}var bi,On,xs,ju=typeof window<"u"&&!!window.__PREACT_SIGNALS_DEVTOOLS__;var hi=[];Ea(function(){bi=this.N})();function ir(t,a){xe[t]=a.bind(null,xe[t]||function(){})}function bs(t){if(xs){var a=xs;xs=void 0,a()}xs=t&&t.S()}function _i(t){var a=this,r=t.data,s=Wu(r);s.value=r;var n=Oe(function(){for(var i=a,u=a.__v;u=u.__;)if(u.__c){u.__c.__$f|=4;break}var d=gs(function(){var b=s.value.value;return b===0?0:b===!0?"":b||""}),y=gs(function(){return!Array.isArray(d.value)&&!wn(d.value)}),f=Ea(function(){if(this.N=wi,y.value){var b=d.value;i.__v&&i.__v.__e&&i.__v.__e.nodeType===3&&(i.__v.__e.data=b)}}),m=a.__$u.d;return a.__$u.d=function(){f(),m.call(this)},[y,d]},[]),o=n[0],l=n[1];return o.value?l.peek():l.value}_i.displayName="ReactiveTextNode";Object.defineProperties(Ge.prototype,{constructor:{configurable:!0,value:void 0},type:{configurable:!0,value:_i},props:{configurable:!0,get:function(){return{data:this}}},__b:{configurable:!0,value:1}});ir("__b",function(t,a){if(typeof a.type=="string"){var r,s=a.props;for(var n in s)if(n!=="children"){var o=s[n];o instanceof Ge&&(r||(a.__np=r={}),r[n]=o,s[n]=o.peek())}}t(a)});ir("__r",function(t,a){if(t(a),a.type!==W){bs();var r,s=a.__c;s&&(s.__$f&=-2,(r=s.__$u)===void 0&&(s.__$u=r=(function(n,o){var l;return Ea(function(){l=this},{name:o}),l.c=n,l})(function(){var n;ju&&((n=r.y)==null||n.call(r)),s.__$f|=1,s.setState({})},typeof a.type=="function"?a.type.displayName||a.type.name:""))),On=s,bs(r)}});ir("__e",function(t,a,r,s){bs(),On=void 0,t(a,r,s)});ir("diffed",function(t,a){bs(),On=void 0;var r;if(typeof a.type=="string"&&(r=a.__e)){var s=a.__np,n=a.props;if(s){var o=r.U;if(o)for(var l in o){var i=o[l];i!==void 0&&!(l in s)&&(i.d(),o[l]=void 0)}else o={},r.U=o;for(var u in s){var d=o[u],y=s[u];d===void 0?(d=Uu(r,u,y,n),o[u]=d):d.o(y,n)}}}t(a)});function Uu(t,a,r,s){var n=a in t&&t.ownerSVGElement===void 0,o=aa(r);return{o:function(l,i){o.value=l,s=i},d:Ea(function(){this.N=wi;var l=o.value.value;s[a]!==l&&(s[a]=l,n?t[a]=l:l!=null&&(l!==!1||a[4]==="-")?t.setAttribute(a,l):t.removeAttribute(a))})}}ir("unmount",function(t,a){if(typeof a.type=="string"){var r=a.__e;if(r){var s=r.U;if(s){r.U=void 0;for(var n in s){var o=s[n];o&&o.d()}}}}else{var l=a.__c;if(l){var i=l.__$u;i&&(l.__$u=void 0,i.d())}}t(a)});ir("__h",function(t,a,r,s){(s<3||s===9)&&(a.__$f|=2),t(a,r,s)});Jt.prototype.shouldComponentUpdate=function(t,a){if(this.__R)return!0;var r=this.__$u,s=r&&r.s!==void 0;for(var n in a)return!0;if(this.__f||typeof this.u=="boolean"&&this.u===!0){var o=2&this.__$f;if(!(s||o||4&this.__$f)||1&this.__$f)return!0}else if(!(s||4&this.__$f)||3&this.__$f)return!0;for(var l in t)if(l!=="__source"&&t[l]!==this.props[l])return!0;for(var i in this.props)if(!(i in t))return!0;return!1};function Wu(t,a){return Oe(function(){return aa(t,a)},[])}var Vu=function(t){queueMicrotask(function(){queueMicrotask(t)})};function Gu(){Rn(function(){for(var t;t=hi.shift();)bi.call(t)})}function wi(){hi.push(this)===1&&(xe.requestAnimationFrame||Vu)(Gu)}var qu=window.location.pathname.replace(/\/ui(\/.*)?$/,""),pa=window.location.origin+qu,hs=new Map;function de(t){if(hs.has(t))return hs.get(t);let a=fetch(`${pa}${t}`).then(r=>{if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);return r.json()}).finally(()=>{hs.delete(t)});return hs.set(t,a),a}function fa(t,a){return fetch(`${pa}${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).then(r=>{if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);return r.json()})}function _s(t,a){return fetch(`${pa}${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).then(r=>{if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);return r.json()})}var ws=new Map;function Pa(t){return ws.has(t)||ws.set(t,aa({data:null,loading:!1,error:null,stale:!1,lastFetched:0})),ws.get(t)}async function ur(t){let a=Pa(t),r=a.value;if(r.loading||r.lastFetched&&Date.now()-r.lastFetched<2e3)return;r.data!==null&&r.stale||(a.value={...r,loading:!0,error:null});try{let o=await de(`/api/cache/${t}`);a.value={data:o,loading:!1,error:null,stale:!1,lastFetched:Date.now()}}catch(o){let l=o.message&&o.message.startsWith("HTTP 404");a.value={...a.value,data:l?{data:{}}:a.value.data,loading:!1,error:l?null:o.message,stale:!1,lastFetched:Date.now()}}}var dr=aa(!1),cr=aa(""),$a=aa(Yu());function Yu(){if(typeof window>"u")return"light";let t=localStorage.getItem("aria-theme");return t==="light"||t==="dark"?t:window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function Ku(t){$a.value=t,document.documentElement.setAttribute("data-theme",t),localStorage.setItem("aria-theme",t)}function ks(){Ku($a.value==="dark"?"light":"dark")}typeof document<"u"&&document.documentElement.setAttribute("data-theme",$a.value);var dt=null,Fr=1e3,Ju=3e4,Br=null,jr=null;function Hn(){if(dt&&(dt.readyState===WebSocket.CONNECTING||dt.readyState===WebSocket.OPEN))return;let t=window.location.protocol==="https:"?"wss:":"ws:",a=window.location.pathname.replace(/\/ui(\/.*)?$/,""),r=`${t}//${window.location.host}${a}/ws`;dt=new WebSocket(r),dt.onopen=()=>{Fr=1e3,dr.value=!0,cr.value="Connected",Qu(),clearInterval(Br),Br=setInterval(()=>{dt&&dt.readyState===WebSocket.OPEN&&dt.send(JSON.stringify({type:"ping"}))},3e4)},dt.onmessage=s=>{try{let n=JSON.parse(s.data);if(n.type==="cache_updated"&&n.data&&n.data.category){let o=n.data.category,l=Pa(o);l.value={...l.value,stale:!0},ur(o)}}catch{}},dt.onclose=()=>{dr.value=!1,cr.value=`Disconnected \u2014 reconnecting in ${(Fr/1e3).toFixed(0)}s`,clearInterval(Br),Zu()},dt.onerror=()=>{cr.value="Connection error"}}function Zu(){clearTimeout(jr),jr=setTimeout(()=>{jr=null,Hn()},Fr),Fr=Math.min(Fr*2,Ju)}function ki(){clearInterval(Br),Br=null,clearTimeout(jr),jr=null,dt&&(dt.onclose=null,dt.close(),dt=null),dr.value=!1,cr.value=""}function Qu(){for(let[t,a]of ws)a.value={...a.value,stale:!0},ur(t)}var Xu=[[1,0],[2,0],[3,0],[0,1],[1,1],[3,1],[4,1],[0,2],[1,2],[2,2],[3,2],[4,2],[0,3],[1,3],[3,3],[4,3],[0,4],[1,4],[3,4],[4,4],[7,0],[8,0],[9,0],[10,0],[11,0],[7,1],[8,1],[10,1],[11,1],[7,2],[8,2],[9,2],[10,2],[7,3],[8,3],[10,3],[7,4],[8,4],[11,4],[14,0],[14,1],[14,2],[14,3],[14,4],[18,0],[19,0],[20,0],[17,1],[18,1],[20,1],[21,1],[17,2],[18,2],[19,2],[20,2],[21,2],[17,3],[18,3],[20,3],[21,3],[17,4],[18,4],[20,4],[21,4]],zn=10,Fn=2,Si=zn-Fn,ep=1;function pr({className:t="",color:a="currentColor"}){return e("svg",{viewBox:"0 0 220 50",class:t,fill:a,role:"img","aria-label":"ARIA"},Xu.map(([r,s],n)=>e("rect",{key:n,x:r*zn+Fn/2,y:s*zn+Fn/2,width:Si,height:Si,rx:ep})))}var Ss=[{path:"/",label:"Home",icon:Ci},{section:"Data Collection"},{path:"/discovery",label:"Discovery",icon:rp},{path:"/capabilities",label:"Capabilities",icon:sp},{path:"/data-curation",label:"Data Curation",icon:cp},{path:"/presence",label:"Presence",icon:dp},{section:"Learning"},{path:"/intelligence",label:"Intelligence",icon:Mi},{path:"/ml-engine",label:"ML Engine",icon:ip},{path:"/predictions",label:"Predictions",icon:Ti},{path:"/patterns",label:"Patterns",icon:np},{section:"Actions"},{path:"/shadow",label:"Shadow Mode",icon:Ei},{path:"/automations",label:"Automations",icon:op},{path:"/settings",label:"Settings",icon:lp}],tp=[{path:"/",label:"Home",icon:Ci},{path:"/intelligence",label:"Intel",icon:Mi},{path:"/predictions",label:"Predict",icon:Ti},{path:"/shadow",label:"Shadow",icon:Ei},{key:"more",label:"More",icon:up}],ap=Ss.filter(t=>!t.section&&!["/","/intelligence","/predictions","/shadow"].includes(t.path));function Ci(){return e("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","aria-hidden":"true"},e("rect",{x:"3",y:"3",width:"7",height:"7"}),e("rect",{x:"14",y:"3",width:"7",height:"7"}),e("rect",{x:"3",y:"14",width:"7",height:"7"}),e("rect",{x:"14",y:"14",width:"7",height:"7"}))}function rp(){return e("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","aria-hidden":"true"},e("circle",{cx:"11",cy:"11",r:"8"}),e("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"}))}function sp(){return e("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","aria-hidden":"true"},e("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"}))}function Ti(){return e("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","aria-hidden":"true"},e("polyline",{points:"23 6 13.5 15.5 8.5 10.5 1 18"}),e("polyline",{points:"17 6 23 6 23 12"}))}function np(){return e("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","aria-hidden":"true"},e("polygon",{points:"12 2 2 7 12 12 22 7 12 2"}),e("polyline",{points:"2 17 12 22 22 17"}),e("polyline",{points:"2 12 12 17 22 12"}))}function Mi(){return e("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","aria-hidden":"true"},e("path",{d:"M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a2 2 0 0 0 2 2h4a2 2 0 0 0 2-2v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7z"}),e("line",{x1:"9",y1:"21",x2:"15",y2:"21"}),e("line",{x1:"10",y1:"19",x2:"14",y2:"19"}))}function Ei(){return e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round","aria-hidden":"true"},e("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),e("circle",{cx:"12",cy:"12",r:"3"}))}function op(){return e("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","aria-hidden":"true"},e("circle",{cx:"12",cy:"12",r:"3"}),e("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"}))}function lp(){return e("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","aria-hidden":"true"},e("line",{x1:"4",y1:"21",x2:"4",y2:"14"}),e("line",{x1:"4",y1:"10",x2:"4",y2:"3"}),e("line",{x1:"12",y1:"21",x2:"12",y2:"12"}),e("line",{x1:"12",y1:"8",x2:"12",y2:"3"}),e("line",{x1:"20",y1:"21",x2:"20",y2:"16"}),e("line",{x1:"20",y1:"12",x2:"20",y2:"3"}),e("line",{x1:"1",y1:"14",x2:"7",y2:"14"}),e("line",{x1:"9",y1:"8",x2:"15",y2:"8"}),e("line",{x1:"17",y1:"16",x2:"23",y2:"16"}))}function ip(){return e("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","aria-hidden":"true"},e("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"}),e("rect",{x:"9",y:"9",width:"6",height:"6"}),e("line",{x1:"9",y1:"1",x2:"9",y2:"4"}),e("line",{x1:"15",y1:"1",x2:"15",y2:"4"}),e("line",{x1:"9",y1:"20",x2:"9",y2:"23"}),e("line",{x1:"15",y1:"20",x2:"15",y2:"23"}),e("line",{x1:"20",y1:"9",x2:"23",y2:"9"}),e("line",{x1:"20",y1:"15",x2:"23",y2:"15"}),e("line",{x1:"1",y1:"9",x2:"4",y2:"9"}),e("line",{x1:"1",y1:"15",x2:"4",y2:"15"}))}function cp(){return e("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","aria-hidden":"true"},e("polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"}))}function dp(){return e("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","aria-hidden":"true"},e("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),e("circle",{cx:"9",cy:"7",r:"4"}),e("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),e("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"}))}function Bn(){return e("svg",{class:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","aria-hidden":"true"},e("circle",{cx:"12",cy:"12",r:"5"}),e("line",{x1:"12",y1:"1",x2:"12",y2:"3"}),e("line",{x1:"12",y1:"21",x2:"12",y2:"23"}),e("line",{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64"}),e("line",{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78"}),e("line",{x1:"1",y1:"12",x2:"3",y2:"12"}),e("line",{x1:"21",y1:"12",x2:"23",y2:"12"}),e("line",{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36"}),e("line",{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22"}))}function jn(){return e("svg",{class:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","aria-hidden":"true"},e("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"}))}function up(){return e("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","aria-hidden":"true"},e("circle",{cx:"12",cy:"5",r:"1.5",fill:"currentColor"}),e("circle",{cx:"12",cy:"12",r:"1.5",fill:"currentColor"}),e("circle",{cx:"12",cy:"19",r:"1.5",fill:"currentColor"}))}function pp(){return e("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","aria-hidden":"true"},e("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),e("line",{x1:"3",y1:"12",x2:"21",y2:"12"}),e("line",{x1:"3",y1:"18",x2:"21",y2:"18"}))}function Pi(){return e("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","aria-hidden":"true"},e("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e("line",{x1:"6",y1:"6",x2:"18",y2:"18"}))}function Un(){return e("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","aria-hidden":"true"},e("path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"}),e("path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"}))}function Ai(){let a=(window.location.hash||"#/").replace(/^#/,"")||"/",r=a.indexOf("?");return r>=0?a.slice(0,r):a}function fp({currentPath:t}){let[a,r]=N(!1),s=$a.value==="dark";return le(()=>{r(!1)},[t]),e("nav",{class:"sm:hidden fixed bottom-0 left-0 right-0 z-40","aria-label":"Primary navigation"},a&&e("div",{class:"fixed inset-0 z-40",style:"background: rgba(0,0,0,0.5);",onClick:()=>r(!1)},e("div",{class:"absolute bottom-14 left-0 right-0",style:"background: var(--bg-surface); border-top: 1px solid var(--border-subtle); border-top-left-radius: 12px; border-top-right-radius: 12px; box-shadow: 0 -4px 20px rgba(0,0,0,0.15); max-height: 60vh; overflow-y: auto;",onClick:n=>n.stopPropagation()},e("div",{class:"flex items-center justify-between",style:"padding: 12px 16px; border-bottom: 1px solid var(--border-subtle);"},e("span",{style:"font-size: 13px; font-weight: 600; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.05em;"},"More"),e("button",{onClick:()=>r(!1),"aria-label":"Close menu",style:"color: var(--text-tertiary); padding: 4px; cursor: pointer; background: none; border: none;"},e(Pi,null))),e("div",{style:"padding: 8px 0;"},ap.map(n=>{let o=t===n.path;return e("a",{key:n.path,href:`#${n.path}`,class:"flex items-center gap-3",style:`padding: 12px 20px; font-size: 14px; font-weight: 500; text-decoration: none; ${o?"color: var(--accent); background: var(--bg-surface-raised);":"color: var(--text-secondary);"}`},e(n.icon,null),n.label)}),e("a",{href:"#/guide",class:"flex items-center gap-3",style:`padding: 12px 20px; font-size: 14px; font-weight: 500; text-decoration: none; ${t==="/guide"?"color: var(--accent); background: var(--bg-surface-raised);":"color: var(--accent);"}`},e(Un,null),"How to Use ARIA"),e("div",{style:"padding: 12px 20px; border-top: 1px solid var(--border-subtle); margin-top: 4px;"},e("button",{onClick:ks,class:"flex items-center gap-2",style:"background: var(--bg-surface-raised); color: var(--text-secondary); border: 1px solid var(--border-subtle); border-radius: var(--radius); padding: 6px 12px; font-size: 13px; cursor: pointer;","aria-label":s?"Switch to light mode":"Switch to dark mode"},s?e(Bn,null):e(jn,null),e("span",null,s?"Light mode":"Dark mode")))))),e("div",{style:"background: var(--bg-surface); border-top: 1px solid var(--border-subtle); min-height: 56px; padding-bottom: env(safe-area-inset-bottom);",class:"flex justify-around items-center"},tp.map(n=>{let o=n.key==="more",i=(o?a:t===n.path)?"color: var(--accent); border-top: 2px solid var(--accent); margin-top: -2px;":"color: var(--text-tertiary); border-top: 2px solid transparent; margin-top: -2px;";return o?e("button",{key:"more",class:"flex flex-col items-center justify-center",style:`${i} min-width: 48px; min-height: 48px; background: none; border-left: none; border-right: none; border-bottom: none; cursor: pointer; font-size: 10px; font-weight: 500; gap: 2px;`,onClick:()=>r(!a),"aria-label":"More navigation options","aria-expanded":a},e(n.icon,null),e("span",null,n.label)):e("a",{key:n.path,href:`#${n.path}`,class:"flex flex-col items-center justify-center",style:`${i} min-width: 48px; min-height: 48px; text-decoration: none; font-size: 10px; font-weight: 500; gap: 2px;`,"aria-label":n.label},e(n.icon,null),e("span",null,n.label))})))}function vp({currentPath:t}){let[a,r]=N(!1),s=dr.value,n=$a.value==="dark";le(()=>{r(!1)},[t]);let o=Ss.filter(i=>!i.section);return e(W,null,a&&e("div",{class:"hidden sm:block lg:hidden fixed inset-0",style:"z-index: 29;",onClick:()=>r(!1)}),e("nav",{class:"hidden sm:flex lg:hidden fixed left-0 top-0 bottom-0 flex-col z-30",style:`width: ${a?"240px":"56px"}; background: var(--bg-surface); border-right: 1px solid var(--border-subtle); box-shadow: 2px 0 8px rgba(0,0,0,0.06); transition: width 0.2s ease; overflow: hidden;`,"aria-label":"Primary navigation"},e("button",{class:"flex items-center justify-center",style:`width: 56px; height: 56px; flex-shrink: 0; background: none; border: none; color: var(--text-secondary); cursor: pointer;${a?" background: var(--bg-surface-raised);":""}`,onClick:()=>r(!a),"aria-label":a?"Collapse navigation":"Expand navigation","aria-expanded":a},a?e(Pi,null):e(pp,null)),e("div",{class:"flex-1 overflow-y-auto",style:"padding: 4px 0;"},a?Ss.map((i,u)=>{if(i.section)return e("div",{key:i.section,style:`padding: 0 16px; padding-top: 14px; padding-bottom: 4px; font-size: 10px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; color: var(--text-tertiary); white-space: nowrap;${u>0?" border-top: 1px solid var(--border-subtle); margin-top: 6px;":""}`},i.section);let d=t===i.path;return e("a",{key:i.path,href:`#${i.path}`,class:"flex items-center gap-3",style:`padding: 8px 16px; font-size: 14px; font-weight: 500; text-decoration: none; white-space: nowrap; transition: background 0.15s ease; ${d?"color: var(--text-primary); background: var(--bg-surface-raised); border-left: 2px solid var(--accent); padding-left: 14px;":"color: var(--text-tertiary); border-left: 2px solid transparent; padding-left: 14px;"}`,"aria-label":i.label},e(i.icon,null),i.label)}):o.map(i=>{let u=t===i.path;return e("a",{key:i.path,href:`#${i.path}`,class:"flex items-center justify-center",style:`width: 56px; height: 44px; text-decoration: none; transition: background 0.15s ease; ${u?"color: var(--accent); border-left: 2px solid var(--accent);":"color: var(--text-tertiary); border-left: 2px solid transparent;"}`,title:i.label,"aria-label":i.label},e(i.icon,null))})),e("div",{style:"border-top: 1px solid var(--border-subtle); padding: 4px 0; flex-shrink: 0;"},e("a",{href:"#/guide",class:"flex items-center justify-center",style:`width: 56px; height: 44px; text-decoration: none; ${t==="/guide"?"color: var(--accent);":"color: var(--accent); opacity: 0.7;"}`,title:"How to Use ARIA","aria-label":"How to Use ARIA"},e(Un,null)),e("button",{onClick:ks,class:"flex items-center justify-center",style:"width: 56px; height: 44px; background: none; border: none; color: var(--text-secondary); cursor: pointer;",title:n?"Switch to light mode":"Switch to dark mode","aria-label":n?"Switch to light mode":"Switch to dark mode"},n?e(Bn,null):e(jn,null)),e("div",{class:"flex items-center justify-center",style:"width: 56px; height: 28px;",title:s?"Connected":"Disconnected","aria-label":s?"WebSocket connected":"WebSocket disconnected"},e("span",{style:`display: inline-block; width: 8px; height: 8px; border-radius: 50%; background: ${s?"var(--status-healthy)":"var(--status-error)"};`})))))}function mp({currentPath:t}){let a=dr.value,r=cr.value,s=$a.value==="dark";return e("nav",{class:"hidden lg:flex fixed left-0 top-0 bottom-0 w-60 flex-col z-30 t-terminal-bg",style:"background: var(--bg-surface); border-right: 1px solid var(--border-subtle); box-shadow: 2px 0 8px rgba(0,0,0,0.06);","aria-label":"Primary navigation"},e("div",{class:"px-5 py-5"},e(pr,{className:"w-28",color:"var(--accent)"}),e("p",{style:"font-size: 10px; color: var(--text-tertiary); margin-top: 6px; letter-spacing: 0.05em;"},"Adaptive Residence Intelligence")),e("div",{class:"flex-1 px-3 space-y-0.5 overflow-y-auto"},Ss.map((n,o)=>{if(n.section)return e("div",{key:n.section,style:`padding: 0 12px; padding-top: 16px; padding-bottom: 4px; font-size: 10px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; color: var(--text-tertiary);${o>0?" border-top: 1px solid var(--border-subtle); margin-top: 8px;":""}`},n.section);let l=t===n.path;return e("a",{key:n.path,href:`#${n.path}`,class:"flex items-center gap-3 text-sm font-medium",style:l?"background: var(--bg-surface-raised); color: var(--text-primary); border-left: 2px solid var(--accent); padding: 8px 12px; border-radius: var(--radius); transition: background 0.15s ease, color 0.15s ease;":"color: var(--text-tertiary); padding: 8px 12px; border-left: 2px solid transparent; border-radius: var(--radius); transition: background 0.15s ease, color 0.15s ease;",onMouseEnter:i=>{l||(i.currentTarget.style.background="var(--bg-surface-raised)"),i.currentTarget.style.color="var(--text-primary)"},onMouseLeave:i=>{l||(i.currentTarget.style.background="transparent",i.currentTarget.style.color="var(--text-tertiary)")},"aria-label":n.label},e(n.icon,null),n.label)})),e("div",{style:"padding: 12px; border-top: 1px solid var(--border-subtle);",class:"space-y-2"},e("a",{href:"#/guide",class:"flex items-center gap-3 text-sm font-medium",style:t==="/guide"?"background: var(--bg-surface-raised); color: var(--text-primary); border-left: 2px solid var(--accent); padding: 8px 12px; border-radius: var(--radius);":"color: var(--accent); padding: 8px 12px; border-left: 2px solid transparent; border-radius: var(--radius); transition: background 0.15s ease, color 0.15s ease;",onMouseEnter:n=>{t!=="/guide"&&(n.currentTarget.style.background="var(--bg-surface-raised)")},onMouseLeave:n=>{t!=="/guide"&&(n.currentTarget.style.background="transparent")},"aria-label":"How to Use ARIA"},e(Un,null),"How to Use ARIA"),e("div",{style:"padding: 0 12px; font-size: 10px; color: var(--text-tertiary); line-height: 1.6;"},e("p",{style:"font-weight: 600; color: var(--text-secondary);"},"ARIA v1.0.0"),e("p",{style:"margin-top: 2px;"},"Local ML + real-time monitoring for Home Assistant. No cloud required.")),e("button",{onClick:ks,style:"background: var(--bg-surface-raised); color: var(--text-secondary); border: 1px solid var(--border-subtle); border-radius: var(--radius); padding: 4px 8px; margin: 0 12px; display: flex; align-items: center; gap: 6px; font-size: 0.75rem; cursor: pointer; transition: border-color 0.2s ease;",title:s?"Switch to light mode":"Switch to dark mode","aria-label":s?"Switch to light mode":"Switch to dark mode",onMouseEnter:n=>{n.currentTarget.style.borderColor="var(--border-primary)"},onMouseLeave:n=>{n.currentTarget.style.borderColor="var(--border-subtle)"}},s?e(Bn,null):e(jn,null),e("span",null,s?"Light":"Dark")),e("div",{class:"flex items-center gap-2",style:"padding: 0 12px; font-size: 0.75rem; color: var(--text-tertiary);"},e("span",{style:`display: inline-block; width: 8px; height: 8px; border-radius: 50%; background: ${a?"var(--status-healthy)":"var(--status-error)"};`,"aria-label":a?"WebSocket connected":"WebSocket disconnected"}),e("span",{class:"truncate"},r||(a?"Connected":"Disconnected")))))}function Wn(){let[t,a]=N(Ai);return le(()=>{function r(){a(Ai())}return window.addEventListener("hashchange",r),()=>window.removeEventListener("hashchange",r)},[]),e(W,null,e(fp,{currentPath:t}),e(vp,{currentPath:t}),e(mp,{currentPath:t}))}function we({error:t,onRetry:a}){let r=t instanceof Error?t.message:String(t||"Unknown error");return e("div",{style:"background: var(--bg-surface); border: 1px solid var(--status-error); border-left-width: 3px; border-radius: var(--radius); padding: 16px;"},e("div",{class:"flex items-start gap-3"},e("svg",{class:"w-5 h-5 mt-0.5 shrink-0",style:"color: var(--status-error);",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},e("circle",{cx:"12",cy:"12",r:"10"}),e("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),e("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})),e("div",{class:"flex-1"},e("p",{class:"text-sm",style:"color: var(--status-error);"},r)),a&&e("button",{onClick:a,class:"text-sm font-medium transition-colors",style:"color: var(--status-error); background: var(--bg-surface-raised); border-radius: var(--radius); padding: 4px 12px;"},"Retry")))}function He(t){let a=Pa(t),r=a.value,s=oi(()=>ur(t),[t]);return le(()=>{let n=a.value;n.data===null&&!n.loading&&ur(t)},[t]),le(()=>{r.stale&&!r.loading&&ur(t)},[r.stale,r.loading,t]),{data:r.data,loading:r.loading,error:r.error,refetch:s}}function fe(t,a){return Oe(t,a)}function Se({type:t="full"}){return t==="stats"?e("div",{class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4"},[...Array(5)].map((a,r)=>e("div",{key:r,class:"t-card",style:"padding: 16px;"},e("div",{class:"h-8 w-16 animate-pulse mb-2",style:"background: var(--bg-inset); border-radius: var(--radius);"}),e("div",{class:"h-4 w-24 animate-pulse",style:"background: var(--bg-inset); border-radius: var(--radius);"})))):t==="table"?e("div",{class:"t-card",style:"overflow: hidden;"},e("div",{class:"flex gap-4 px-4 py-3",style:"border-bottom: 1px solid var(--border-subtle);"},[...Array(4)].map((a,r)=>e("div",{key:r,class:"h-4 animate-pulse flex-1",style:"background: var(--bg-inset); border-radius: var(--radius);"}))),[...Array(6)].map((a,r)=>e("div",{key:r,class:"flex gap-4 px-4 py-3",style:"border-bottom: 1px solid var(--border-subtle);"},[...Array(4)].map((s,n)=>e("div",{key:n,class:"h-4 animate-pulse flex-1",style:"background: var(--bg-surface-raised); border-radius: var(--radius);"}))))):t==="cards"?e("div",{class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},[...Array(6)].map((a,r)=>e("div",{key:r,class:"t-card",style:"padding: 16px;"},e("div",{class:"h-5 w-32 animate-pulse mb-3",style:"background: var(--bg-inset); border-radius: var(--radius);"}),e("div",{class:"h-4 w-full animate-pulse mb-2",style:"background: var(--bg-surface-raised); border-radius: var(--radius);"}),e("div",{class:"h-4 w-3/4 animate-pulse",style:"background: var(--bg-surface-raised); border-radius: var(--radius);"})))):e("div",{class:"space-y-6"},e("div",{class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4"},[...Array(5)].map((a,r)=>e("div",{key:r,class:"t-card",style:"padding: 16px;"},e("div",{class:"h-8 w-16 animate-pulse mb-2",style:"background: var(--bg-inset); border-radius: var(--radius);"}),e("div",{class:"h-4 w-24 animate-pulse",style:"background: var(--bg-inset); border-radius: var(--radius);"})))),e("div",{class:"t-card",style:"overflow: hidden;"},[...Array(4)].map((a,r)=>e("div",{key:r,class:"flex gap-4 px-4 py-3",style:"border-bottom: 1px solid var(--border-subtle);"},[...Array(4)].map((s,n)=>e("div",{key:n,class:"h-4 animate-pulse flex-1",style:"background: var(--bg-surface-raised); border-radius: var(--radius);"}))))))}var yp="uplot",gp="u-hz",xp="u-vt",bp="u-title",hp="u-wrap",_p="u-under",wp="u-over",kp="u-axis",Ra="u-off",Sp="u-select",Ap="u-cursor-x",Cp="u-cursor-y",Tp="u-cursor-pt",Mp="u-legend",Ep="u-live",Pp="u-inline",$p="u-series",Lp="u-marker",$i="u-label",Dp="u-value",Wr="width",Vr="height";var Li="bottom",fr="left",Vn="right",io="#000",Di=io+"0",Gn="mousemove",Ri="mousedown",qn="mouseup",Ii="mouseenter",Ni="mouseleave",Oi="dblclick",Rp="resize",Ip="scroll",Hi="change",Es="dppxchange",co="--",hr=typeof window<"u",Qn=hr?document:null,mr=hr?window:null,Np=hr?navigator:null,ve,As;function Xn(){let t=devicePixelRatio;ve!=t&&(ve=t,As&&to(Hi,As,Xn),As=matchMedia(`(min-resolution: ${ve-.001}dppx) and (max-resolution: ${ve+.001}dppx)`),Ia(Hi,As,Xn),mr.dispatchEvent(new CustomEvent(Es)))}function _t(t,a){if(a!=null){let r=t.classList;!r.contains(a)&&r.add(a)}}function eo(t,a){let r=t.classList;r.contains(a)&&r.remove(a)}function $e(t,a,r){t.style[a]=r+"px"}function zt(t,a,r,s){let n=Qn.createElement(t);return a!=null&&_t(n,a),r?.insertBefore(n,s),n}function Lt(t,a){return zt("div",t,a)}var zi=new WeakMap;function Zt(t,a,r,s,n){let o="translate("+a+"px,"+r+"px)",l=zi.get(t);o!=l&&(t.style.transform=o,zi.set(t,o),a<0||r<0||a>s||r>n?_t(t,Ra):eo(t,Ra))}var Fi=new WeakMap;function Bi(t,a,r){let s=a+r,n=Fi.get(t);s!=n&&(Fi.set(t,s),t.style.background=a,t.style.borderColor=r)}var ji=new WeakMap;function Ui(t,a,r,s){let n=a+""+r,o=ji.get(t);n!=o&&(ji.set(t,n),t.style.height=r+"px",t.style.width=a+"px",t.style.marginLeft=s?-a/2+"px":0,t.style.marginTop=s?-r/2+"px":0)}var uo={passive:!0},Op={...uo,capture:!0};function Ia(t,a,r,s){a.addEventListener(t,r,s?Op:uo)}function to(t,a,r,s){a.removeEventListener(t,r,uo)}hr&&Xn();function Ft(t,a,r,s){let n;r=r||0,s=s||a.length-1;let o=s<=2147483647;for(;s-r>1;)n=o?r+s>>1:wt((r+s)/2),a[n]<t?r=n:s=n;return t-a[r]<=a[s]-t?r:s}function gc(t){return(r,s,n)=>{let o=-1,l=-1;for(let i=s;i<=n;i++)if(t(r[i])){o=i;break}for(let i=n;i>=s;i--)if(t(r[i])){l=i;break}return[o,l]}}var xc=t=>t!=null,bc=t=>t!=null&&t>0,Ls=gc(xc),Hp=gc(bc);function zp(t,a,r,s=0,n=!1){let o=n?Hp:Ls,l=n?bc:xc;[a,r]=o(t,a,r);let i=t[a],u=t[a];if(a>-1)if(s==1)i=t[a],u=t[r];else if(s==-1)i=t[r],u=t[a];else for(let d=a;d<=r;d++){let y=t[d];l(y)&&(y<i?i=y:y>u&&(u=y))}return[i??Ae,u??-Ae]}function Ds(t,a,r,s){let n=Gi(t),o=Gi(a);t==a&&(n==-1?(t*=r,a/=r):(t/=r,a*=r));let l=r==10?ra:hc,i=n==1?wt:Dt,u=o==1?Dt:wt,d=i(l(Ye(t))),y=u(l(Ye(a))),f=yr(r,d),m=yr(r,y);return r==10&&(d<0&&(f=Ce(f,-d)),y<0&&(m=Ce(m,-y))),s||r==2?(t=f*n,a=m*o):(t=Sc(t,f),a=Rs(a,m)),[t,a]}function po(t,a,r,s){let n=Ds(t,a,r,s);return t==0&&(n[0]=0),a==0&&(n[1]=0),n}var fo=.1,Wi={mode:3,pad:fo},qr={pad:0,soft:null,mode:0},Fp={min:qr,max:qr};function Ps(t,a,r,s){return Is(r)?Vi(t,a,r):(qr.pad=r,qr.soft=s?0:null,qr.mode=s?3:0,Vi(t,a,Fp))}function ue(t,a){return t??a}function Bp(t,a,r){for(a=ue(a,0),r=ue(r,t.length-1);a<=r;){if(t[a]!=null)return!0;a++}return!1}function Vi(t,a,r){let s=r.min,n=r.max,o=ue(s.pad,0),l=ue(n.pad,0),i=ue(s.hard,-Ae),u=ue(n.hard,Ae),d=ue(s.soft,Ae),y=ue(n.soft,-Ae),f=ue(s.mode,0),m=ue(n.mode,0),b=a-t,h=ra(b),C=ut(Ye(t),Ye(a)),A=ra(C),M=Ye(A-h);(b<1e-24||M>10)&&(b=0,(t==0||a==0)&&(b=1e-24,f==2&&d!=Ae&&(o=0),m==2&&y!=-Ae&&(l=0)));let _=b||C||1e3,k=ra(_),S=yr(10,wt(k)),O=_*(b==0?t==0?.1:1:o),$=Ce(Sc(t-O,S/10),24),H=t>=d&&(f==1||f==3&&$<=d||f==2&&$>=d)?d:Ae,I=ut(i,$<H&&t>=H?H:Bt(H,$)),j=_*(b==0?a==0?.1:1:l),B=Ce(Rs(a+j,S/10),24),L=a<=y&&(m==1||m==3&&B>=y||m==2&&B<=y)?y:-Ae,q=Bt(u,B>L&&a<=L?L:ut(L,B));return I==q&&I==0&&(q=100),[I,q]}var jp=new Intl.NumberFormat(hr?Np.language:"en-US"),vo=t=>jp.format(t),kt=Math,Ms=kt.PI,Ye=kt.abs,wt=kt.floor,qe=kt.round,Dt=kt.ceil,Bt=kt.min,ut=kt.max,yr=kt.pow,Gi=kt.sign,ra=kt.log10,hc=kt.log2,Up=(t,a=1)=>kt.sinh(t)*a,Yn=(t,a=1)=>kt.asinh(t/a),Ae=1/0;function qi(t){return(ra((t^t>>31)-(t>>31))|0)+1}function ao(t,a,r){return Bt(ut(t,a),r)}function _c(t){return typeof t=="function"}function oe(t){return _c(t)?t:()=>t}var Wp=()=>{},wc=t=>t,kc=(t,a)=>a,Vp=t=>null,Yi=t=>!0,Ki=(t,a)=>t==a,Gp=/\.\d*?(?=9{6,}|0{6,})/gm,Na=t=>{if(Cc(t)||ma.has(t))return t;let a=`${t}`,r=a.match(Gp);if(r==null)return t;let s=r[0].length-1;if(a.indexOf("e-")!=-1){let[n,o]=a.split("e");return+`${Na(n)}e${o}`}return Ce(t,s)};function La(t,a){return Na(Ce(Na(t/a))*a)}function Rs(t,a){return Na(Dt(Na(t/a))*a)}function Sc(t,a){return Na(wt(Na(t/a))*a)}function Ce(t,a=0){if(Cc(t))return t;let r=10**a,s=t*r*(1+Number.EPSILON);return qe(s)/r}var ma=new Map;function Ac(t){return((""+t).split(".")[1]||"").length}function Kr(t,a,r,s){let n=[],o=s.map(Ac);for(let l=a;l<r;l++){let i=Ye(l),u=Ce(yr(t,l),i);for(let d=0;d<s.length;d++){let y=t==10?+`${s[d]}e${l}`:s[d]*u,f=(l>=0?0:i)+(l>=o[d]?0:o[d]),m=t==10?y:Ce(y,f);n.push(m),ma.set(m,f)}}return n}var Yr={},mo=[],gr=[null,null],va=Array.isArray,Cc=Number.isInteger,qp=t=>t===void 0;function Ji(t){return typeof t=="string"}function Is(t){let a=!1;if(t!=null){let r=t.constructor;a=r==null||r==Object}return a}function Yp(t){return t!=null&&typeof t=="object"}var Kp=Object.getPrototypeOf(Uint8Array),Tc="__proto__";function xr(t,a=Is){let r;if(va(t)){let s=t.find(n=>n!=null);if(va(s)||a(s)){r=Array(t.length);for(let n=0;n<t.length;n++)r[n]=xr(t[n],a)}else r=t.slice()}else if(t instanceof Kp)r=t.slice();else if(a(t)){r={};for(let s in t)s!=Tc&&(r[s]=xr(t[s],a))}else r=t;return r}function Ue(t){let a=arguments;for(let r=1;r<a.length;r++){let s=a[r];for(let n in s)n!=Tc&&(Is(t[n])?Ue(t[n],xr(s[n])):t[n]=xr(s[n]))}return t}var Jp=0,Zp=1,Qp=2;function Xp(t,a,r){for(let s=0,n,o=-1;s<a.length;s++){let l=a[s];if(l>o){for(n=l-1;n>=0&&t[n]==null;)t[n--]=null;for(n=l+1;n<r&&t[n]==null;)t[o=n++]=null}}}function ef(t,a){if(rf(t)){let l=t[0].slice();for(let i=1;i<t.length;i++)l.push(...t[i].slice(1));return sf(l[0])||(l=af(l)),l}let r=new Set;for(let l=0;l<t.length;l++){let u=t[l][0],d=u.length;for(let y=0;y<d;y++)r.add(u[y])}let s=[Array.from(r).sort((l,i)=>l-i)],n=s[0].length,o=new Map;for(let l=0;l<n;l++)o.set(s[0][l],l);for(let l=0;l<t.length;l++){let i=t[l],u=i[0];for(let d=1;d<i.length;d++){let y=i[d],f=Array(n).fill(void 0),m=a?a[l][d]:Zp,b=[];for(let h=0;h<y.length;h++){let C=y[h],A=o.get(u[h]);C===null?m!=Jp&&(f[A]=C,m==Qp&&b.push(A)):f[A]=C}Xp(f,b,n),s.push(f)}}return s}var tf=typeof queueMicrotask>"u"?t=>Promise.resolve().then(t):queueMicrotask;function af(t){let a=t[0],r=a.length,s=Array(r);for(let o=0;o<s.length;o++)s[o]=o;s.sort((o,l)=>a[o]-a[l]);let n=[];for(let o=0;o<t.length;o++){let l=t[o],i=Array(r);for(let u=0;u<r;u++)i[u]=l[s[u]];n.push(i)}return n}function rf(t){let a=t[0][0],r=a.length;for(let s=1;s<t.length;s++){let n=t[s][0];if(n.length!=r)return!1;if(n!=a){for(let o=0;o<r;o++)if(n[o]!=a[o])return!1}}return!0}function sf(t,a=100){let r=t.length;if(r<=1)return!0;let s=0,n=r-1;for(;s<=n&&t[s]==null;)s++;for(;n>=s&&t[n]==null;)n--;if(n<=s)return!0;let o=ut(1,wt((n-s+1)/a));for(let l=t[s],i=s+o;i<=n;i+=o){let u=t[i];if(u!=null){if(u<=l)return!1;l=u}}return!0}var Mc=["January","February","March","April","May","June","July","August","September","October","November","December"],Ec=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function Pc(t){return t.slice(0,3)}var nf=Ec.map(Pc),of=Mc.map(Pc),lf={MMMM:Mc,MMM:of,WWWW:Ec,WWW:nf};function Ur(t){return(t<10?"0":"")+t}function cf(t){return(t<10?"00":t<100?"0":"")+t}var df={YYYY:t=>t.getFullYear(),YY:t=>(t.getFullYear()+"").slice(2),MMMM:(t,a)=>a.MMMM[t.getMonth()],MMM:(t,a)=>a.MMM[t.getMonth()],MM:t=>Ur(t.getMonth()+1),M:t=>t.getMonth()+1,DD:t=>Ur(t.getDate()),D:t=>t.getDate(),WWWW:(t,a)=>a.WWWW[t.getDay()],WWW:(t,a)=>a.WWW[t.getDay()],HH:t=>Ur(t.getHours()),H:t=>t.getHours(),h:t=>{let a=t.getHours();return a==0?12:a>12?a-12:a},AA:t=>t.getHours()>=12?"PM":"AM",aa:t=>t.getHours()>=12?"pm":"am",a:t=>t.getHours()>=12?"p":"a",mm:t=>Ur(t.getMinutes()),m:t=>t.getMinutes(),ss:t=>Ur(t.getSeconds()),s:t=>t.getSeconds(),fff:t=>cf(t.getMilliseconds())};function yo(t,a){a=a||lf;let r=[],s=/\{([a-z]+)\}|[^{]+/gi,n;for(;n=s.exec(t);)r.push(n[0][0]=="{"?df[n[1]]:n[0]);return o=>{let l="";for(let i=0;i<r.length;i++)l+=typeof r[i]=="string"?r[i]:r[i](o,a);return l}}var uf=new Intl.DateTimeFormat().resolvedOptions().timeZone;function pf(t,a){let r;return a=="UTC"||a=="Etc/UTC"?r=new Date(+t+t.getTimezoneOffset()*6e4):a==uf?r=t:(r=new Date(t.toLocaleString("en-US",{timeZone:a})),r.setMilliseconds(t.getMilliseconds())),r}var $c=t=>t%1==0,$s=[1,2,2.5,5],ff=Kr(10,-32,0,$s),Lc=Kr(10,0,32,$s),vf=Lc.filter($c),Da=ff.concat(Lc),go=`
`,Dc="{YYYY}",Zi=go+Dc,Rc="{M}/{D}",Gr=go+Rc,Cs=Gr+"/{YY}",Ic="{aa}",mf="{h}:{mm}",vr=mf+Ic,Qi=go+vr,Xi=":{ss}",he=null;function Nc(t){let a=t*1e3,r=a*60,s=r*60,n=s*24,o=n*30,l=n*365,u=(t==1?Kr(10,0,3,$s).filter($c):Kr(10,-3,0,$s)).concat([a,a*5,a*10,a*15,a*30,r,r*5,r*10,r*15,r*30,s,s*2,s*3,s*4,s*6,s*8,s*12,n,n*2,n*3,n*4,n*5,n*6,n*7,n*8,n*9,n*10,n*15,o,o*2,o*3,o*4,o*6,l,l*2,l*5,l*10,l*25,l*50,l*100]),d=[[l,Dc,he,he,he,he,he,he,1],[n*28,"{MMM}",Zi,he,he,he,he,he,1],[n,Rc,Zi,he,he,he,he,he,1],[s,"{h}"+Ic,Cs,he,Gr,he,he,he,1],[r,vr,Cs,he,Gr,he,he,he,1],[a,Xi,Cs+" "+vr,he,Gr+" "+vr,he,Qi,he,1],[t,Xi+".{fff}",Cs+" "+vr,he,Gr+" "+vr,he,Qi,he,1]];function y(f){return(m,b,h,C,A,M)=>{let _=[],k=A>=l,S=A>=o&&A<l,O=f(h),$=Ce(O*t,3),H=Kn(O.getFullYear(),k?0:O.getMonth(),S||k?1:O.getDate()),I=Ce(H*t,3);if(S||k){let j=S?A/o:0,B=k?A/l:0,L=$==I?$:Ce(Kn(H.getFullYear()+B,H.getMonth()+j,1)*t,3),q=new Date(qe(L/t)),G=q.getFullYear(),Z=q.getMonth();for(let Y=0;L<=C;Y++){let E=Kn(G+B*Y,Z+j*Y,1),P=E-f(Ce(E*t,3));L=Ce((+E+P)*t,3),L<=C&&_.push(L)}}else{let j=A>=n?n:A,B=wt(h)-wt($),L=I+B+Rs($-I,j);_.push(L);let q=f(L),G=q.getHours()+q.getMinutes()/r+q.getSeconds()/s,Z=A/s,Y=m.axes[b]._space,E=M/Y;for(;L=Ce(L+A,t==1?0:3),!(L>C);)if(Z>1){let P=wt(Ce(G+Z,6))%24,se=f(L).getHours()-P;se>1&&(se=-1),L-=se*s,G=(G+Z)%24;let ye=_[_.length-1];Ce((L-ye)/A,3)*E>=.7&&_.push(L)}else _.push(L)}return _}}return[u,d,y]}var[yf,gf,xf]=Nc(1),[bf,hf,_f]=Nc(.001);Kr(2,-53,53,[1]);function ec(t,a){return t.map(r=>r.map((s,n)=>n==0||n==8||s==null?s:a(n==1||r[8]==0?s:r[1]+s)))}function tc(t,a){return(r,s,n,o,l)=>{let i=a.find(h=>l>=h[0])||a[a.length-1],u,d,y,f,m,b;return s.map(h=>{let C=t(h),A=C.getFullYear(),M=C.getMonth(),_=C.getDate(),k=C.getHours(),S=C.getMinutes(),O=C.getSeconds(),$=A!=u&&i[2]||M!=d&&i[3]||_!=y&&i[4]||k!=f&&i[5]||S!=m&&i[6]||O!=b&&i[7]||i[1];return u=A,d=M,y=_,f=k,m=S,b=O,$(C)})}}function wf(t,a){let r=yo(a);return(s,n,o,l,i)=>n.map(u=>r(t(u)))}function Kn(t,a,r){return new Date(t,a,r)}function ac(t,a){return a(t)}var kf="{YYYY}-{MM}-{DD} {h}:{mm}{aa}";function rc(t,a){return(r,s,n,o)=>o==null?co:a(t(s))}function Sf(t,a){let r=t.series[a];return r.width?r.stroke(t,a):r.points.width?r.points.stroke(t,a):null}function Af(t,a){return t.series[a].fill(t,a)}var Cf={show:!0,live:!0,isolate:!1,mount:Wp,markers:{show:!0,width:2,stroke:Sf,fill:Af,dash:"solid"},idx:null,idxs:null,values:[]};function Tf(t,a){let r=t.cursor.points,s=Lt(),n=r.size(t,a);$e(s,Wr,n),$e(s,Vr,n);let o=n/-2;$e(s,"marginLeft",o),$e(s,"marginTop",o);let l=r.width(t,a,n);return l&&$e(s,"borderWidth",l),s}function Mf(t,a){let r=t.series[a].points;return r._fill||r._stroke}function Ef(t,a){let r=t.series[a].points;return r._stroke||r._fill}function Pf(t,a){return t.series[a].points.size}var Jn=[0,0];function $f(t,a,r){return Jn[0]=a,Jn[1]=r,Jn}function Ts(t,a,r,s=!0){return n=>{n.button==0&&(!s||n.target==a)&&r(n)}}function Zn(t,a,r,s=!0){return n=>{(!s||n.target==a)&&r(n)}}var Lf={show:!0,x:!0,y:!0,lock:!1,move:$f,points:{one:!1,show:Tf,size:Pf,width:0,stroke:Ef,fill:Mf},bind:{mousedown:Ts,mouseup:Ts,click:Ts,dblclick:Ts,mousemove:Zn,mouseleave:Zn,mouseenter:Zn},drag:{setScale:!0,x:!0,y:!1,dist:0,uni:null,click:(t,a)=>{a.stopPropagation(),a.stopImmediatePropagation()},_x:!1,_y:!1},focus:{dist:(t,a,r,s,n)=>s-n,prox:-1,bias:0},hover:{skip:[void 0],prox:null,bias:0},left:-10,top:-10,idx:null,dataIdx:null,idxs:null,event:null},Oc={show:!0,stroke:"rgba(0,0,0,0.07)",width:2},xo=Ue({},Oc,{filter:kc}),Hc=Ue({},xo,{size:10}),zc=Ue({},Oc,{show:!1}),bo='12px system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"',Fc="bold "+bo,Bc=1.5,sc={show:!0,scale:"x",stroke:io,space:50,gap:5,alignTo:1,size:50,labelGap:0,labelSize:30,labelFont:Fc,side:2,grid:xo,ticks:Hc,border:zc,font:bo,lineGap:Bc,rotate:0},Df="Value",Rf="Time",nc={show:!0,scale:"x",auto:!1,sorted:1,min:Ae,max:-Ae,idxs:[]};function If(t,a,r,s,n){return a.map(o=>o==null?"":vo(o))}function Nf(t,a,r,s,n,o,l){let i=[],u=ma.get(n)||0;r=l?r:Ce(Rs(r,n),u);for(let d=r;d<=s;d=Ce(d+n,u))i.push(Object.is(d,-0)?0:d);return i}function ro(t,a,r,s,n,o,l){let i=[],u=t.scales[t.axes[a].scale].log,d=u==10?ra:hc,y=wt(d(r));n=yr(u,y),u==10&&(n=Da[Ft(n,Da)]);let f=r,m=n*u;u==10&&(m=Da[Ft(m,Da)]);do i.push(f),f=f+n,u==10&&!ma.has(f)&&(f=Ce(f,ma.get(n))),f>=m&&(n=f,m=n*u,u==10&&(m=Da[Ft(m,Da)]));while(f<=s);return i}function Of(t,a,r,s,n,o,l){let u=t.scales[t.axes[a].scale].asinh,d=s>u?ro(t,a,ut(u,r),s,n):[u],y=s>=0&&r<=0?[0]:[];return(r<-u?ro(t,a,ut(u,-s),-r,n):[u]).reverse().map(m=>-m).concat(y,d)}var jc=/./,Hf=/[12357]/,zf=/[125]/,oc=/1/,so=(t,a,r,s)=>t.map((n,o)=>a==4&&n==0||o%s==0&&r.test(n.toExponential()[n<0?1:0])?n:null);function Ff(t,a,r,s,n){let o=t.axes[r],l=o.scale,i=t.scales[l],u=t.valToPos,d=o._space,y=u(10,l),f=u(9,l)-y>=d?jc:u(7,l)-y>=d?Hf:u(5,l)-y>=d?zf:oc;if(f==oc){let m=Ye(u(1,l)-y);if(m<d)return so(a.slice().reverse(),i.distr,f,Dt(d/m)).reverse()}return so(a,i.distr,f,1)}function Bf(t,a,r,s,n){let o=t.axes[r],l=o.scale,i=o._space,u=t.valToPos,d=Ye(u(1,l)-u(2,l));return d<i?so(a.slice().reverse(),3,jc,Dt(i/d)).reverse():a}function jf(t,a,r,s){return s==null?co:a==null?"":vo(a)}var lc={show:!0,scale:"y",stroke:io,space:30,gap:5,alignTo:1,size:50,labelGap:0,labelSize:30,labelFont:Fc,side:3,grid:xo,ticks:Hc,border:zc,font:bo,lineGap:Bc,rotate:0};function Uf(t,a){let r=3+(t||1)*2;return Ce(r*a,3)}function Wf(t,a){let{scale:r,idxs:s}=t.series[0],n=t._data[0],o=t.valToPos(n[s[0]],r,!0),l=t.valToPos(n[s[1]],r,!0),i=Ye(l-o),u=t.series[a],d=i/(u.points.space*ve);return s[1]-s[0]<=d}var ic={scale:null,auto:!0,sorted:0,min:Ae,max:-Ae},Uc=(t,a,r,s,n)=>n,cc={show:!0,auto:!0,sorted:0,gaps:Uc,alpha:1,facets:[Ue({},ic,{scale:"x"}),Ue({},ic,{scale:"y"})]},dc={scale:"y",auto:!0,sorted:0,show:!0,spanGaps:!1,gaps:Uc,alpha:1,points:{show:Wf,filter:null},values:null,min:Ae,max:-Ae,idxs:[],path:null,clip:null};function Vf(t,a,r,s,n){return r/10}var Wc={time:!0,auto:!0,distr:1,log:10,asinh:1,min:null,max:null,dir:1,ori:0},Gf=Ue({},Wc,{time:!1,ori:1}),uc={};function Vc(t,a){let r=uc[t];return r||(r={key:t,plots:[],sub(s){r.plots.push(s)},unsub(s){r.plots=r.plots.filter(n=>n!=s)},pub(s,n,o,l,i,u,d){for(let y=0;y<r.plots.length;y++)r.plots[y]!=n&&r.plots[y].pub(s,n,o,l,i,u,d)}},t!=null&&(uc[t]=r)),r}var br=1,no=2;function Oa(t,a,r){let s=t.mode,n=t.series[a],o=s==2?t._data[a]:t._data,l=t.scales,i=t.bbox,u=o[0],d=s==2?o[1]:o[a],y=s==2?l[n.facets[0].scale]:l[t.series[0].scale],f=s==2?l[n.facets[1].scale]:l[n.scale],m=i.left,b=i.top,h=i.width,C=i.height,A=t.valToPosH,M=t.valToPosV;return y.ori==0?r(n,u,d,y,f,A,M,m,b,h,C,Os,_r,zs,qc,Kc):r(n,u,d,y,f,M,A,b,m,C,h,Hs,wr,wo,Yc,Jc)}function ho(t,a){let r=0,s=0,n=ue(t.bands,mo);for(let o=0;o<n.length;o++){let l=n[o];l.series[0]==a?r=l.dir:l.series[1]==a&&(l.dir==1?s|=1:s|=2)}return[r,s==1?-1:s==2?1:s==3?2:0]}function qf(t,a,r,s,n){let o=t.mode,l=t.series[a],i=o==2?l.facets[1].scale:l.scale,u=t.scales[i];return n==-1?u.min:n==1?u.max:u.distr==3?u.dir==1?u.min:u.max:0}function sa(t,a,r,s,n,o){return Oa(t,a,(l,i,u,d,y,f,m,b,h,C,A)=>{let M=l.pxRound,_=d.dir*(d.ori==0?1:-1),k=d.ori==0?_r:wr,S,O;_==1?(S=r,O=s):(S=s,O=r);let $=M(f(i[S],d,C,b)),H=M(m(u[S],y,A,h)),I=M(f(i[O],d,C,b)),j=M(m(o==1?y.max:y.min,y,A,h)),B=new Path2D(n);return k(B,I,j),k(B,$,j),k(B,$,H),B})}function Ns(t,a,r,s,n,o){let l=null;if(t.length>0){l=new Path2D;let i=a==0?zs:wo,u=r;for(let f=0;f<t.length;f++){let m=t[f];if(m[1]>m[0]){let b=m[0]-u;b>0&&i(l,u,s,b,s+o),u=m[1]}}let d=r+n-u,y=10;d>0&&i(l,u,s-y/2,d,s+o+y)}return l}function Yf(t,a,r){let s=t[t.length-1];s&&s[0]==a?s[1]=r:t.push([a,r])}function _o(t,a,r,s,n,o,l){let i=[],u=t.length;for(let d=n==1?r:s;d>=r&&d<=s;d+=n)if(a[d]===null){let f=d,m=d;if(n==1)for(;++d<=s&&a[d]===null;)m=d;else for(;--d>=r&&a[d]===null;)m=d;let b=o(t[f]),h=m==f?b:o(t[m]),C=f-n;b=l<=0&&C>=0&&C<u?o(t[C]):b;let M=m+n;h=l>=0&&M>=0&&M<u?o(t[M]):h,h>=b&&i.push([b,h])}return i}function pc(t){return t==0?wc:t==1?qe:a=>La(a,t)}function Gc(t){let a=t==0?Os:Hs,r=t==0?(n,o,l,i,u,d)=>{n.arcTo(o,l,i,u,d)}:(n,o,l,i,u,d)=>{n.arcTo(l,o,u,i,d)},s=t==0?(n,o,l,i,u)=>{n.rect(o,l,i,u)}:(n,o,l,i,u)=>{n.rect(l,o,u,i)};return(n,o,l,i,u,d=0,y=0)=>{d==0&&y==0?s(n,o,l,i,u):(d=Bt(d,i/2,u/2),y=Bt(y,i/2,u/2),a(n,o+d,l),r(n,o+i,l,o+i,l+u,d),r(n,o+i,l+u,o,l+u,y),r(n,o,l+u,o,l,y),r(n,o,l,o+i,l,d),n.closePath())}}var Os=(t,a,r)=>{t.moveTo(a,r)},Hs=(t,a,r)=>{t.moveTo(r,a)},_r=(t,a,r)=>{t.lineTo(a,r)},wr=(t,a,r)=>{t.lineTo(r,a)},zs=Gc(0),wo=Gc(1),qc=(t,a,r,s,n,o)=>{t.arc(a,r,s,n,o)},Yc=(t,a,r,s,n,o)=>{t.arc(r,a,s,n,o)},Kc=(t,a,r,s,n,o,l)=>{t.bezierCurveTo(a,r,s,n,o,l)},Jc=(t,a,r,s,n,o,l)=>{t.bezierCurveTo(r,a,n,s,l,o)};function Zc(t){return(a,r,s,n,o)=>Oa(a,r,(l,i,u,d,y,f,m,b,h,C,A)=>{let{pxRound:M,points:_}=l,k,S;d.ori==0?(k=Os,S=qc):(k=Hs,S=Yc);let O=Ce(_.width*ve,3),$=(_.size-_.width)/2*ve,H=Ce($*2,3),I=new Path2D,j=new Path2D,{left:B,top:L,width:q,height:G}=a.bbox;zs(j,B-H,L-H,q+H*2,G+H*2);let Z=Y=>{if(u[Y]!=null){let E=M(f(i[Y],d,C,b)),P=M(m(u[Y],y,A,h));k(I,E+$,P),S(I,E,P,$,0,Ms*2)}};if(o)o.forEach(Z);else for(let Y=s;Y<=n;Y++)Z(Y);return{stroke:O>0?I:null,fill:I,clip:j,flags:br|no}})}function Qc(t){return(a,r,s,n,o,l)=>{s!=n&&(o!=s&&l!=s&&t(a,r,s),o!=n&&l!=n&&t(a,r,n),t(a,r,l))}}var Kf=Qc(_r),Jf=Qc(wr);function Xc(t){let a=ue(t?.alignGaps,0);return(r,s,n,o)=>Oa(r,s,(l,i,u,d,y,f,m,b,h,C,A)=>{[n,o]=Ls(u,n,o);let M=l.pxRound,_=G=>M(f(G,d,C,b)),k=G=>M(m(G,y,A,h)),S,O;d.ori==0?(S=_r,O=Kf):(S=wr,O=Jf);let $=d.dir*(d.ori==0?1:-1),H={stroke:new Path2D,fill:null,clip:null,band:null,gaps:null,flags:br},I=H.stroke,j=!1;if(o-n>=C*4){let G=K=>r.posToVal(K,d.key,!0),Z=null,Y=null,E,P,re,_e=_(i[$==1?n:o]),se=_(i[n]),ye=_(i[o]),ae=G($==1?se+1:ye-1);for(let K=$==1?n:o;K>=n&&K<=o;K+=$){let We=i[K],Le=($==1?We<ae:We>ae)?_e:_(We),ge=u[K];Le==_e?ge!=null?(P=ge,Z==null?(S(I,Le,k(P)),E=Z=Y=P):P<Z?Z=P:P>Y&&(Y=P)):ge===null&&(j=!0):(Z!=null&&O(I,_e,k(Z),k(Y),k(E),k(P)),ge!=null?(P=ge,S(I,Le,k(P)),Z=Y=E=P):(Z=Y=null,ge===null&&(j=!0)),_e=Le,ae=G(_e+$))}Z!=null&&Z!=Y&&re!=_e&&O(I,_e,k(Z),k(Y),k(E),k(P))}else for(let G=$==1?n:o;G>=n&&G<=o;G+=$){let Z=u[G];Z===null?j=!0:Z!=null&&S(I,_(i[G]),k(Z))}let[L,q]=ho(r,s);if(l.fill!=null||L!=0){let G=H.fill=new Path2D(I),Z=l.fillTo(r,s,l.min,l.max,L),Y=k(Z),E=_(i[n]),P=_(i[o]);$==-1&&([P,E]=[E,P]),S(G,P,Y),S(G,E,Y)}if(!l.spanGaps){let G=[];j&&G.push(..._o(i,u,n,o,$,_,a)),H.gaps=G=l.gaps(r,s,n,o,G),H.clip=Ns(G,d.ori,b,h,C,A)}return q!=0&&(H.band=q==2?[sa(r,s,n,o,I,-1),sa(r,s,n,o,I,1)]:sa(r,s,n,o,I,q)),H})}function Zf(t){let a=ue(t.align,1),r=ue(t.ascDesc,!1),s=ue(t.alignGaps,0),n=ue(t.extend,!1);return(o,l,i,u)=>Oa(o,l,(d,y,f,m,b,h,C,A,M,_,k)=>{[i,u]=Ls(f,i,u);let S=d.pxRound,{left:O,width:$}=o.bbox,H=se=>S(h(se,m,_,A)),I=se=>S(C(se,b,k,M)),j=m.ori==0?_r:wr,B={stroke:new Path2D,fill:null,clip:null,band:null,gaps:null,flags:br},L=B.stroke,q=m.dir*(m.ori==0?1:-1),G=I(f[q==1?i:u]),Z=H(y[q==1?i:u]),Y=Z,E=Z;n&&a==-1&&(E=O,j(L,E,G)),j(L,Z,G);for(let se=q==1?i:u;se>=i&&se<=u;se+=q){let ye=f[se];if(ye==null)continue;let ae=H(y[se]),K=I(ye);a==1?j(L,ae,G):j(L,Y,K),j(L,ae,K),G=K,Y=ae}let P=Y;n&&a==1&&(P=O+$,j(L,P,G));let[re,_e]=ho(o,l);if(d.fill!=null||re!=0){let se=B.fill=new Path2D(L),ye=d.fillTo(o,l,d.min,d.max,re),ae=I(ye);j(se,P,ae),j(se,E,ae)}if(!d.spanGaps){let se=[];se.push(..._o(y,f,i,u,q,H,s));let ye=d.width*ve/2,ae=r||a==1?ye:-ye,K=r||a==-1?-ye:ye;se.forEach(We=>{We[0]+=ae,We[1]+=K}),B.gaps=se=d.gaps(o,l,i,u,se),B.clip=Ns(se,m.ori,A,M,_,k)}return _e!=0&&(B.band=_e==2?[sa(o,l,i,u,L,-1),sa(o,l,i,u,L,1)]:sa(o,l,i,u,L,_e)),B})}function fc(t,a,r,s,n,o,l=Ae){if(t.length>1){let i=null;for(let u=0,d=1/0;u<t.length;u++)if(a[u]!==void 0){if(i!=null){let y=Ye(t[u]-t[i]);y<d&&(d=y,l=Ye(r(t[u],s,n,o)-r(t[i],s,n,o)))}i=u}}return l}function Qf(t){t=t||Yr;let a=ue(t.size,[.6,Ae,1]),r=t.align||0,s=t.gap||0,n=t.radius;n=n==null?[0,0]:typeof n=="number"?[n,0]:n;let o=oe(n),l=1-a[0],i=ue(a[1],Ae),u=ue(a[2],1),d=ue(t.disp,Yr),y=ue(t.each,b=>{}),{fill:f,stroke:m}=d;return(b,h,C,A)=>Oa(b,h,(M,_,k,S,O,$,H,I,j,B,L)=>{let q=M.pxRound,G=r,Z=s*ve,Y=i*ve,E=u*ve,P,re;S.ori==0?[P,re]=o(b,h):[re,P]=o(b,h);let _e=S.dir*(S.ori==0?1:-1),se=S.ori==0?zs:wo,ye=S.ori==0?y:(U,Te,Ve,Wa,xa,Ut,ba)=>{y(U,Te,Ve,xa,Wa,ba,Ut)},ae=ue(b.bands,mo).find(U=>U.series[0]==h),K=ae!=null?ae.dir:0,We=M.fillTo(b,h,M.min,M.max,K),nt=q(H(We,O,L,j)),Le,ge,Rt,mt=B,Re=q(M.width*ve),jt=!1,Xt=null,At=null,na=null,Ba=null;f!=null&&(Re==0||m!=null)&&(jt=!0,Xt=f.values(b,h,C,A),At=new Map,new Set(Xt).forEach(U=>{U!=null&&At.set(U,new Path2D)}),Re>0&&(na=m.values(b,h,C,A),Ba=new Map,new Set(na).forEach(U=>{U!=null&&Ba.set(U,new Path2D)})));let{x0:ja,size:Ar}=d;if(ja!=null&&Ar!=null){G=1,_=ja.values(b,h,C,A),ja.unit==2&&(_=_.map(Ve=>b.posToVal(I+Ve*B,S.key,!0)));let U=Ar.values(b,h,C,A);Ar.unit==2?ge=U[0]*B:ge=$(U[0],S,B,I)-$(0,S,B,I),mt=fc(_,k,$,S,B,I,mt),Rt=mt-ge+Z}else mt=fc(_,k,$,S,B,I,mt),Rt=mt*l+Z,ge=mt-Rt;Rt<1&&(Rt=0),Re>=ge/2&&(Re=0),Rt<5&&(q=wc);let es=Rt>0,ya=mt-Rt-(es?Re:0);ge=q(ao(ya,E,Y)),Le=(G==0?ge/2:G==_e?0:ge)-G*_e*((G==0?Z/2:0)+(es?Re/2:0));let ot={stroke:null,fill:null,clip:null,band:null,gaps:null,flags:0},Ua=jt?null:new Path2D,ea=null;if(ae!=null)ea=b.data[ae.series[1]];else{let{y0:U,y1:Te}=d;U!=null&&Te!=null&&(k=Te.values(b,h,C,A),ea=U.values(b,h,C,A))}let ga=P*ge,te=re*ge;for(let U=_e==1?C:A;U>=C&&U<=A;U+=_e){let Te=k[U];if(Te==null)continue;if(ea!=null){let pt=ea[U]??0;if(Te-pt==0)continue;nt=H(pt,O,L,j)}let Ve=S.distr!=2||d!=null?_[U]:U,Wa=$(Ve,S,B,I),xa=H(ue(Te,We),O,L,j),Ut=q(Wa-Le),ba=q(ut(xa,nt)),yt=q(Bt(xa,nt)),Ct=ba-yt;if(Te!=null){let pt=Te<0?te:ga,It=Te<0?ga:te;jt?(Re>0&&na[U]!=null&&se(Ba.get(na[U]),Ut,yt+wt(Re/2),ge,ut(0,Ct-Re),pt,It),Xt[U]!=null&&se(At.get(Xt[U]),Ut,yt+wt(Re/2),ge,ut(0,Ct-Re),pt,It)):se(Ua,Ut,yt+wt(Re/2),ge,ut(0,Ct-Re),pt,It),ye(b,h,U,Ut-Re/2,yt,ge+Re,Ct)}}return Re>0?ot.stroke=jt?Ba:Ua:jt||(ot._fill=M.width==0?M._fill:M._stroke??M._fill,ot.width=0),ot.fill=jt?At:Ua,ot})}function Xf(t,a){let r=ue(a?.alignGaps,0);return(s,n,o,l)=>Oa(s,n,(i,u,d,y,f,m,b,h,C,A,M)=>{[o,l]=Ls(d,o,l);let _=i.pxRound,k=P=>_(m(P,y,A,h)),S=P=>_(b(P,f,M,C)),O,$,H;y.ori==0?(O=Os,H=_r,$=Kc):(O=Hs,H=wr,$=Jc);let I=y.dir*(y.ori==0?1:-1),j=k(u[I==1?o:l]),B=j,L=[],q=[];for(let P=I==1?o:l;P>=o&&P<=l;P+=I)if(d[P]!=null){let _e=u[P],se=k(_e);L.push(B=se),q.push(S(d[P]))}let G={stroke:t(L,q,O,H,$,_),fill:null,clip:null,band:null,gaps:null,flags:br},Z=G.stroke,[Y,E]=ho(s,n);if(i.fill!=null||Y!=0){let P=G.fill=new Path2D(Z),re=i.fillTo(s,n,i.min,i.max,Y),_e=S(re);H(P,B,_e),H(P,j,_e)}if(!i.spanGaps){let P=[];P.push(..._o(u,d,o,l,I,k,r)),G.gaps=P=i.gaps(s,n,o,l,P),G.clip=Ns(P,y.ori,h,C,A,M)}return E!=0&&(G.band=E==2?[sa(s,n,o,l,Z,-1),sa(s,n,o,l,Z,1)]:sa(s,n,o,l,Z,E)),G})}function ev(t){return Xf(tv,t)}function tv(t,a,r,s,n,o){let l=t.length;if(l<2)return null;let i=new Path2D;if(r(i,t[0],a[0]),l==2)s(i,t[1],a[1]);else{let u=Array(l),d=Array(l-1),y=Array(l-1),f=Array(l-1);for(let m=0;m<l-1;m++)y[m]=a[m+1]-a[m],f[m]=t[m+1]-t[m],d[m]=y[m]/f[m];u[0]=d[0];for(let m=1;m<l-1;m++)d[m]===0||d[m-1]===0||d[m-1]>0!=d[m]>0?u[m]=0:(u[m]=3*(f[m-1]+f[m])/((2*f[m]+f[m-1])/d[m-1]+(f[m]+2*f[m-1])/d[m]),isFinite(u[m])||(u[m]=0));u[l-1]=d[l-2];for(let m=0;m<l-1;m++)n(i,t[m]+f[m]/3,a[m]+u[m]*f[m]/3,t[m+1]-f[m]/3,a[m+1]-u[m+1]*f[m]/3,t[m+1],a[m+1])}return i}var oo=new Set;function vc(){for(let t of oo)t.syncRect(!0)}hr&&(Ia(Rp,mr,vc),Ia(Ip,mr,vc,!0),Ia(Es,mr,()=>{rt.pxRatio=ve}));var av=Xc(),rv=Zc();function mc(t,a,r,s){return(s?[t[0],t[1]].concat(t.slice(2)):[t[0]].concat(t.slice(1))).map((o,l)=>lo(o,l,a,r))}function sv(t,a){return t.map((r,s)=>s==0?{}:Ue({},a,r))}function lo(t,a,r,s){return Ue({},a==0?r:s,t)}function ed(t,a,r){return a==null?gr:[a,r]}var nv=ed;function ov(t,a,r){return a==null?gr:Ps(a,r,fo,!0)}function td(t,a,r,s){return a==null?gr:Ds(a,r,t.scales[s].log,!1)}var lv=td;function ad(t,a,r,s){return a==null?gr:po(a,r,t.scales[s].log,!1)}var iv=ad;function cv(t,a,r,s,n){let o=ut(qi(t),qi(a)),l=a-t,i=Ft(n/s*l,r);do{let u=r[i],d=s*u/l;if(d>=n&&o+(u<5?ma.get(u):0)<=17)return[u,d]}while(++i<r.length);return[0,0]}function yc(t){let a,r;return t=t.replace(/(\d+)px/,(s,n)=>(a=qe((r=+n)*ve))+"px"),[t,a,r]}function dv(t){t.show&&[t.font,t.labelFont].forEach(a=>{let r=Ce(a[2]*ve,1);a[0]=a[0].replace(/[0-9.]+px/,r+"px"),a[1]=r})}function rt(t,a,r){let s={mode:ue(t.mode,1)},n=s.mode;function o(c,p,v,g){let x=p.valToPct(c);return g+v*(p.dir==-1?1-x:x)}function l(c,p,v,g){let x=p.valToPct(c);return g+v*(p.dir==-1?x:1-x)}function i(c,p,v,g){return p.ori==0?o(c,p,v,g):l(c,p,v,g)}s.valToPosH=o,s.valToPosV=l;let u=!1;s.status=0;let d=s.root=Lt(yp);if(t.id!=null&&(d.id=t.id),_t(d,t.class),t.title){let c=Lt(bp,d);c.textContent=t.title}let y=zt("canvas"),f=s.ctx=y.getContext("2d"),m=Lt(hp,d);Ia("click",m,c=>{c.target===h&&(Me!=tr||De!=ar)&&at.click(s,c)},!0);let b=s.under=Lt(_p,m);m.appendChild(y);let h=s.over=Lt(wp,m);t=xr(t);let C=+ue(t.pxAlign,1),A=pc(C);(t.plugins||[]).forEach(c=>{c.opts&&(t=c.opts(s,t)||t)});let M=t.ms||.001,_=s.series=n==1?mc(t.series||[],nc,dc,!1):sv(t.series||[null],cc),k=s.axes=mc(t.axes||[],sc,lc,!0),S=s.scales={},O=s.bands=t.bands||[];O.forEach(c=>{c.fill=oe(c.fill||null),c.dir=ue(c.dir,-1)});let $=n==2?_[1].facets[0].scale:_[0].scale,H={axes:ou,series:tu},I=(t.drawOrder||["axes","series"]).map(c=>H[c]);function j(c){let p=c.distr==3?v=>ra(v>0?v:c.clamp(s,v,c.min,c.max,c.key)):c.distr==4?v=>Yn(v,c.asinh):c.distr==100?v=>c.fwd(v):v=>v;return v=>{let g=p(v),{_min:x,_max:w}=c,T=w-x;return(g-x)/T}}function B(c){let p=S[c];if(p==null){let v=(t.scales||Yr)[c]||Yr;if(v.from!=null){B(v.from);let g=Ue({},S[v.from],v,{key:c});g.valToPct=j(g),S[c]=g}else{p=S[c]=Ue({},c==$?Wc:Gf,v),p.key=c;let g=p.time,x=p.range,w=va(x);if((c!=$||n==2&&!g)&&(w&&(x[0]==null||x[1]==null)&&(x={min:x[0]==null?Wi:{mode:1,hard:x[0],soft:x[0]},max:x[1]==null?Wi:{mode:1,hard:x[1],soft:x[1]}},w=!1),!w&&Is(x))){let T=x;x=(D,R,z)=>R==null?gr:Ps(R,z,T)}p.range=oe(x||(g?nv:c==$?p.distr==3?lv:p.distr==4?iv:ed:p.distr==3?td:p.distr==4?ad:ov)),p.auto=oe(w?!1:p.auto),p.clamp=oe(p.clamp||Vf),p._min=p._max=null,p.valToPct=j(p)}}}B("x"),B("y"),n==1&&_.forEach(c=>{B(c.scale)}),k.forEach(c=>{B(c.scale)});for(let c in t.scales)B(c);let L=S[$],q=L.distr,G,Z;L.ori==0?(_t(d,gp),G=o,Z=l):(_t(d,xp),G=l,Z=o);let Y={};for(let c in S){let p=S[c];(p.min!=null||p.max!=null)&&(Y[c]={min:p.min,max:p.max},p.min=p.max=null)}let E=t.tzDate||(c=>new Date(qe(c/M))),P=t.fmtDate||yo,re=M==1?xf(E):_f(E),_e=tc(E,ec(M==1?gf:hf,P)),se=rc(E,ac(kf,P)),ye=[],ae=s.legend=Ue({},Cf,t.legend),K=s.cursor=Ue({},Lf,{drag:{y:n==2}},t.cursor),We=ae.show,nt=K.show,Le=ae.markers;ae.idxs=ye,Le.width=oe(Le.width),Le.dash=oe(Le.dash),Le.stroke=oe(Le.stroke),Le.fill=oe(Le.fill);let ge,Rt,mt,Re=[],jt=[],Xt,At=!1,na={};if(ae.live){let c=_[1]?_[1].values:null;At=c!=null,Xt=At?c(s,1,0):{_:0};for(let p in Xt)na[p]=co}if(We)if(ge=zt("table",Mp,d),mt=zt("tbody",null,ge),ae.mount(s,ge),At){Rt=zt("thead",null,ge,mt);let c=zt("tr",null,Rt);zt("th",null,c);for(var Ba in Xt)zt("th",$i,c).textContent=Ba}else _t(ge,Pp),ae.live&&_t(ge,Ep);let ja={show:!0},Ar={show:!1};function es(c,p){if(p==0&&(At||!ae.live||n==2))return gr;let v=[],g=zt("tr",$p,mt,mt.childNodes[p]);_t(g,c.class),c.show||_t(g,Ra);let x=zt("th",null,g);if(Le.show){let D=Lt(Lp,x);if(p>0){let R=Le.width(s,p);R&&(D.style.border=R+"px "+Le.dash(s,p)+" "+Le.stroke(s,p)),D.style.background=Le.fill(s,p)}}let w=Lt($i,x);c.label instanceof HTMLElement?w.appendChild(c.label):w.textContent=c.label,p>0&&(Le.show||(w.style.color=c.width>0?Le.stroke(s,p):Le.fill(s,p)),ot("click",x,D=>{if(K._lock)return;_a(D);let R=_.indexOf(c);if((D.ctrlKey||D.metaKey)!=ae.isolate){let z=_.some((F,V)=>V>0&&V!=R&&F.show);_.forEach((F,V)=>{V>0&&Vt(V,z?V==R?ja:Ar:ja,!0,Be.setSeries)})}else Vt(R,{show:!c.show},!0,Be.setSeries)},!1),Ga&&ot(Ii,x,D=>{K._lock||(_a(D),Vt(_.indexOf(c),sr,!0,Be.setSeries))},!1));for(var T in Xt){let D=zt("td",Dp,g);D.textContent="--",v.push(D)}return[g,v]}let ya=new Map;function ot(c,p,v,g=!0){let x=ya.get(p)||{},w=K.bind[c](s,p,v,g);w&&(Ia(c,p,x[c]=w),ya.set(p,x))}function Ua(c,p,v){let g=ya.get(p)||{};for(let x in g)(c==null||x==c)&&(to(x,p,g[x]),delete g[x]);c==null&&ya.delete(p)}let ea=0,ga=0,te=0,U=0,Te=0,Ve=0,Wa=Te,xa=Ve,Ut=te,ba=U,yt=0,Ct=0,pt=0,It=0;s.bbox={};let Ys=!1,ts=!1,Va=!1,ha=!1,as=!1,Tt=!1;function Ks(c,p,v){(v||c!=s.width||p!=s.height)&&rl(c,p),Za(!1),Va=!0,ts=!0,Qa()}function rl(c,p){s.width=ea=te=c,s.height=ga=U=p,Te=Ve=0,Yd(),Kd();let v=s.bbox;yt=v.left=La(Te*ve,.5),Ct=v.top=La(Ve*ve,.5),pt=v.width=La(te*ve,.5),It=v.height=La(U*ve,.5)}let Vd=3;function Gd(){let c=!1,p=0;for(;!c;){p++;let v=su(p),g=nu(p);c=p==Vd||v&&g,c||(rl(s.width,s.height),ts=!0)}}function qd({width:c,height:p}){Ks(c,p)}s.setSize=qd;function Yd(){let c=!1,p=!1,v=!1,g=!1;k.forEach((x,w)=>{if(x.show&&x._show){let{side:T,_size:D}=x,R=T%2,z=x.label!=null?x.labelSize:0,F=D+z;F>0&&(R?(te-=F,T==3?(Te+=F,g=!0):v=!0):(U-=F,T==0?(Ve+=F,c=!0):p=!0))}}),wa[0]=c,wa[1]=v,wa[2]=p,wa[3]=g,te-=oa[1]+oa[3],Te+=oa[3],U-=oa[2]+oa[0],Ve+=oa[0]}function Kd(){let c=Te+te,p=Ve+U,v=Te,g=Ve;function x(w,T){switch(w){case 1:return c+=T,c-T;case 2:return p+=T,p-T;case 3:return v-=T,v+T;case 0:return g-=T,g+T}}k.forEach((w,T)=>{if(w.show&&w._show){let D=w.side;w._pos=x(D,w._size),w.label!=null&&(w._lpos=x(D,w.labelSize))}})}if(K.dataIdx==null){let c=K.hover,p=c.skip=new Set(c.skip??[]);p.add(void 0);let v=c.prox=oe(c.prox),g=c.bias??=0;K.dataIdx=(x,w,T,D)=>{if(w==0)return T;let R=T,z=v(x,w,T,D)??Ae,F=z>=0&&z<Ae,V=L.ori==0?te:U,X=K.left,pe=a[0],ce=a[w];if(p.has(ce[T])){R=null;let ne=null,Q=null,J;if(g==0||g==-1)for(J=T;ne==null&&J-- >0;)p.has(ce[J])||(ne=J);if(g==0||g==1)for(J=T;Q==null&&J++<ce.length;)p.has(ce[J])||(Q=J);if(ne!=null||Q!=null)if(F){let Pe=ne==null?-1/0:G(pe[ne],L,V,0),Ie=Q==null?1/0:G(pe[Q],L,V,0),et=X-Pe,ke=Ie-X;et<=ke?et<=z&&(R=ne):ke<=z&&(R=Q)}else R=Q==null?ne:ne==null?Q:T-ne<=Q-T?ne:Q}else F&&Ye(X-G(pe[T],L,V,0))>z&&(R=null);return R}}let _a=c=>{K.event=c};K.idxs=ye,K._lock=!1;let st=K.points;st.show=oe(st.show),st.size=oe(st.size),st.stroke=oe(st.stroke),st.width=oe(st.width),st.fill=oe(st.fill);let Wt=s.focus=Ue({},t.focus||{alpha:.3},K.focus),Ga=Wt.prox>=0,qa=Ga&&st.one,Mt=[],Ya=[],Ka=[];function sl(c,p){let v=st.show(s,p);if(v instanceof HTMLElement)return _t(v,Tp),_t(v,c.class),Zt(v,-10,-10,te,U),h.insertBefore(v,Mt[p]),v}function nl(c,p){if(n==1||p>0){let v=n==1&&S[c.scale].time,g=c.value;c.value=v?Ji(g)?rc(E,ac(g,P)):g||se:g||jf,c.label=c.label||(v?Rf:Df)}if(qa||p>0){c.width=c.width==null?1:c.width,c.paths=c.paths||av||Vp,c.fillTo=oe(c.fillTo||qf),c.pxAlign=+ue(c.pxAlign,C),c.pxRound=pc(c.pxAlign),c.stroke=oe(c.stroke||null),c.fill=oe(c.fill||null),c._stroke=c._fill=c._paths=c._focus=null;let v=Uf(ut(1,c.width),1),g=c.points=Ue({},{size:v,width:ut(1,v*.2),stroke:c.stroke,space:v*2,paths:rv,_stroke:null,_fill:null},c.points);g.show=oe(g.show),g.filter=oe(g.filter),g.fill=oe(g.fill),g.stroke=oe(g.stroke),g.paths=oe(g.paths),g.pxAlign=c.pxAlign}if(We){let v=es(c,p);Re.splice(p,0,v[0]),jt.splice(p,0,v[1]),ae.values.push(null)}if(nt){ye.splice(p,0,null);let v=null;qa?p==0&&(v=sl(c,p)):p>0&&(v=sl(c,p)),Mt.splice(p,0,v),Ya.splice(p,0,0),Ka.splice(p,0,0)}Xe("addSeries",p)}function Jd(c,p){p=p??_.length,c=n==1?lo(c,p,nc,dc):lo(c,p,{},cc),_.splice(p,0,c),nl(_[p],p)}s.addSeries=Jd;function Zd(c){if(_.splice(c,1),We){ae.values.splice(c,1),jt.splice(c,1);let p=Re.splice(c,1)[0];Ua(null,p.firstChild),p.remove()}nt&&(ye.splice(c,1),Mt.splice(c,1)[0].remove(),Ya.splice(c,1),Ka.splice(c,1)),Xe("delSeries",c)}s.delSeries=Zd;let wa=[!1,!1,!1,!1];function Qd(c,p){if(c._show=c.show,c.show){let v=c.side%2,g=S[c.scale];g==null&&(c.scale=v?_[1].scale:$,g=S[c.scale]);let x=g.time;c.size=oe(c.size),c.space=oe(c.space),c.rotate=oe(c.rotate),va(c.incrs)&&c.incrs.forEach(T=>{!ma.has(T)&&ma.set(T,Ac(T))}),c.incrs=oe(c.incrs||(g.distr==2?vf:x?M==1?yf:bf:Da)),c.splits=oe(c.splits||(x&&g.distr==1?re:g.distr==3?ro:g.distr==4?Of:Nf)),c.stroke=oe(c.stroke),c.grid.stroke=oe(c.grid.stroke),c.ticks.stroke=oe(c.ticks.stroke),c.border.stroke=oe(c.border.stroke);let w=c.values;c.values=va(w)&&!va(w[0])?oe(w):x?va(w)?tc(E,ec(w,P)):Ji(w)?wf(E,w):w||_e:w||If,c.filter=oe(c.filter||(g.distr>=3&&g.log==10?Ff:g.distr==3&&g.log==2?Bf:kc)),c.font=yc(c.font),c.labelFont=yc(c.labelFont),c._size=c.size(s,null,p,0),c._space=c._rotate=c._incrs=c._found=c._splits=c._values=null,c._size>0&&(wa[p]=!0,c._el=Lt(kp,m))}}function Cr(c,p,v,g){let[x,w,T,D]=v,R=p%2,z=0;return R==0&&(D||w)&&(z=p==0&&!x||p==2&&!T?qe(sc.size/3):0),R==1&&(x||T)&&(z=p==1&&!w||p==3&&!D?qe(lc.size/2):0),z}let ol=s.padding=(t.padding||[Cr,Cr,Cr,Cr]).map(c=>oe(ue(c,Cr))),oa=s._padding=ol.map((c,p)=>c(s,p,wa,0)),tt,Ke=null,Je=null,rs=n==1?_[0].idxs:null,Nt=null,Tr=!1;function ll(c,p){if(a=c??[],s.data=s._data=a,n==2){tt=0;for(let v=1;v<_.length;v++)tt+=a[v][0].length}else{a.length==0&&(s.data=s._data=a=[[]]),Nt=a[0],tt=Nt.length;let v=a;if(q==2){v=a.slice();let g=v[0]=Array(tt);for(let x=0;x<tt;x++)g[x]=x}s._data=a=v}if(Za(!0),Xe("setData"),q==2&&(Va=!0),p!==!1){let v=L;v.auto(s,Tr)?Js():ia($,v.min,v.max),ha=ha||K.left>=0,Tt=!0,Qa()}}s.setData=ll;function Js(){Tr=!0;let c,p;n==1&&(tt>0?(Ke=rs[0]=0,Je=rs[1]=tt-1,c=a[0][Ke],p=a[0][Je],q==2?(c=Ke,p=Je):c==p&&(q==3?[c,p]=Ds(c,c,L.log,!1):q==4?[c,p]=po(c,c,L.log,!1):L.time?p=c+qe(86400/M):[c,p]=Ps(c,p,fo,!0))):(Ke=rs[0]=c=null,Je=rs[1]=p=null)),ia($,c,p)}let ss,Ja,Zs,Qs,Xs,en,tn,an,rn,ft;function il(c,p,v,g,x,w){c??=Di,v??=mo,g??="butt",x??=Di,w??="round",c!=ss&&(f.strokeStyle=ss=c),x!=Ja&&(f.fillStyle=Ja=x),p!=Zs&&(f.lineWidth=Zs=p),w!=Xs&&(f.lineJoin=Xs=w),g!=en&&(f.lineCap=en=g),v!=Qs&&f.setLineDash(Qs=v)}function cl(c,p,v,g){p!=Ja&&(f.fillStyle=Ja=p),c!=tn&&(f.font=tn=c),v!=an&&(f.textAlign=an=v),g!=rn&&(f.textBaseline=rn=g)}function sn(c,p,v,g,x=0){if(g.length>0&&c.auto(s,Tr)&&(p==null||p.min==null)){let w=ue(Ke,0),T=ue(Je,g.length-1),D=v.min==null?zp(g,w,T,x,c.distr==3):[v.min,v.max];c.min=Bt(c.min,v.min=D[0]),c.max=ut(c.max,v.max=D[1])}}let dl={min:null,max:null};function Xd(){for(let g in S){let x=S[g];Y[g]==null&&(x.min==null||Y[$]!=null&&x.auto(s,Tr))&&(Y[g]=dl)}for(let g in S){let x=S[g];Y[g]==null&&x.from!=null&&Y[x.from]!=null&&(Y[g]=dl)}Y[$]!=null&&Za(!0);let c={};for(let g in Y){let x=Y[g];if(x!=null){let w=c[g]=xr(S[g],Yp);if(x.min!=null)Ue(w,x);else if(g!=$||n==2)if(tt==0&&w.from==null){let T=w.range(s,null,null,g);w.min=T[0],w.max=T[1]}else w.min=Ae,w.max=-Ae}}if(tt>0){_.forEach((g,x)=>{if(n==1){let w=g.scale,T=Y[w];if(T==null)return;let D=c[w];if(x==0){let R=D.range(s,D.min,D.max,w);D.min=R[0],D.max=R[1],Ke=Ft(D.min,a[0]),Je=Ft(D.max,a[0]),Je-Ke>1&&(a[0][Ke]<D.min&&Ke++,a[0][Je]>D.max&&Je--),g.min=Nt[Ke],g.max=Nt[Je]}else g.show&&g.auto&&sn(D,T,g,a[x],g.sorted);g.idxs[0]=Ke,g.idxs[1]=Je}else if(x>0&&g.show&&g.auto){let[w,T]=g.facets,D=w.scale,R=T.scale,[z,F]=a[x],V=c[D],X=c[R];V!=null&&sn(V,Y[D],w,z,w.sorted),X!=null&&sn(X,Y[R],T,F,T.sorted),g.min=T.min,g.max=T.max}});for(let g in c){let x=c[g],w=Y[g];if(x.from==null&&(w==null||w.min==null)){let T=x.range(s,x.min==Ae?null:x.min,x.max==-Ae?null:x.max,g);x.min=T[0],x.max=T[1]}}}for(let g in c){let x=c[g];if(x.from!=null){let w=c[x.from];if(w.min==null)x.min=x.max=null;else{let T=x.range(s,w.min,w.max,g);x.min=T[0],x.max=T[1]}}}let p={},v=!1;for(let g in c){let x=c[g],w=S[g];if(w.min!=x.min||w.max!=x.max){w.min=x.min,w.max=x.max;let T=w.distr;w._min=T==3?ra(w.min):T==4?Yn(w.min,w.asinh):T==100?w.fwd(w.min):w.min,w._max=T==3?ra(w.max):T==4?Yn(w.max,w.asinh):T==100?w.fwd(w.max):w.max,p[g]=v=!0}}if(v){_.forEach((g,x)=>{n==2?x>0&&p.y&&(g._paths=null):p[g.scale]&&(g._paths=null)});for(let g in p)Va=!0,Xe("setScale",g);nt&&K.left>=0&&(ha=Tt=!0)}for(let g in Y)Y[g]=null}function eu(c){let p=ao(Ke-1,0,tt-1),v=ao(Je+1,0,tt-1);for(;c[p]==null&&p>0;)p--;for(;c[v]==null&&v<tt-1;)v++;return[p,v]}function tu(){if(tt>0){let c=_.some(p=>p._focus)&&ft!=Wt.alpha;c&&(f.globalAlpha=ft=Wt.alpha),_.forEach((p,v)=>{if(v>0&&p.show&&(ul(v,!1),ul(v,!0),p._paths==null)){let g=ft;ft!=p.alpha&&(f.globalAlpha=ft=p.alpha);let x=n==2?[0,a[v][0].length-1]:eu(a[v]);p._paths=p.paths(s,v,x[0],x[1]),ft!=g&&(f.globalAlpha=ft=g)}}),_.forEach((p,v)=>{if(v>0&&p.show){let g=ft;ft!=p.alpha&&(f.globalAlpha=ft=p.alpha),p._paths!=null&&pl(v,!1);{let x=p._paths!=null?p._paths.gaps:null,w=p.points.show(s,v,Ke,Je,x),T=p.points.filter(s,v,w,x);(w||T)&&(p.points._paths=p.points.paths(s,v,Ke,Je,T),pl(v,!0))}ft!=g&&(f.globalAlpha=ft=g),Xe("drawSeries",v)}}),c&&(f.globalAlpha=ft=1)}}function ul(c,p){let v=p?_[c].points:_[c];v._stroke=v.stroke(s,c),v._fill=v.fill(s,c)}function pl(c,p){let v=p?_[c].points:_[c],{stroke:g,fill:x,clip:w,flags:T,_stroke:D=v._stroke,_fill:R=v._fill,_width:z=v.width}=v._paths;z=Ce(z*ve,3);let F=null,V=z%2/2;p&&R==null&&(R=z>0?"#fff":D);let X=v.pxAlign==1&&V>0;if(X&&f.translate(V,V),!p){let pe=yt-z/2,ce=Ct-z/2,ne=pt+z,Q=It+z;F=new Path2D,F.rect(pe,ce,ne,Q)}p?nn(D,z,v.dash,v.cap,R,g,x,T,w):au(c,D,z,v.dash,v.cap,R,g,x,T,F,w),X&&f.translate(-V,-V)}function au(c,p,v,g,x,w,T,D,R,z,F){let V=!1;R!=0&&O.forEach((X,pe)=>{if(X.series[0]==c){let ce=_[X.series[1]],ne=a[X.series[1]],Q=(ce._paths||Yr).band;va(Q)&&(Q=X.dir==1?Q[0]:Q[1]);let J,Pe=null;ce.show&&Q&&Bp(ne,Ke,Je)?(Pe=X.fill(s,pe)||w,J=ce._paths.clip):Q=null,nn(p,v,g,x,Pe,T,D,R,z,F,J,Q),V=!0}}),V||nn(p,v,g,x,w,T,D,R,z,F)}let fl=br|no;function nn(c,p,v,g,x,w,T,D,R,z,F,V){il(c,p,v,g,x),(R||z||V)&&(f.save(),R&&f.clip(R),z&&f.clip(z)),V?(D&fl)==fl?(f.clip(V),F&&f.clip(F),os(x,T),ns(c,w,p)):D&no?(os(x,T),f.clip(V),ns(c,w,p)):D&br&&(f.save(),f.clip(V),F&&f.clip(F),os(x,T),f.restore(),ns(c,w,p)):(os(x,T),ns(c,w,p)),(R||z||V)&&f.restore()}function ns(c,p,v){v>0&&(p instanceof Map?p.forEach((g,x)=>{f.strokeStyle=ss=x,f.stroke(g)}):p!=null&&c&&f.stroke(p))}function os(c,p){p instanceof Map?p.forEach((v,g)=>{f.fillStyle=Ja=g,f.fill(v)}):p!=null&&c&&f.fill(p)}function ru(c,p,v,g){let x=k[c],w;if(g<=0)w=[0,0];else{let T=x._space=x.space(s,c,p,v,g),D=x._incrs=x.incrs(s,c,p,v,g,T);w=cv(p,v,D,g,T)}return x._found=w}function on(c,p,v,g,x,w,T,D,R,z){let F=T%2/2;C==1&&f.translate(F,F),il(D,T,R,z,D),f.beginPath();let V,X,pe,ce,ne=x+(g==0||g==3?-w:w);v==0?(X=x,ce=ne):(V=x,pe=ne);for(let Q=0;Q<c.length;Q++)p[Q]!=null&&(v==0?V=pe=c[Q]:X=ce=c[Q],f.moveTo(V,X),f.lineTo(pe,ce));f.stroke(),C==1&&f.translate(-F,-F)}function su(c){let p=!0;return k.forEach((v,g)=>{if(!v.show)return;let x=S[v.scale];if(x.min==null){v._show&&(p=!1,v._show=!1,Za(!1));return}else v._show||(p=!1,v._show=!0,Za(!1));let w=v.side,T=w%2,{min:D,max:R}=x,[z,F]=ru(g,D,R,T==0?te:U);if(F==0)return;let V=x.distr==2,X=v._splits=v.splits(s,g,D,R,z,F,V),pe=x.distr==2?X.map(J=>Nt[J]):X,ce=x.distr==2?Nt[X[1]]-Nt[X[0]]:z,ne=v._values=v.values(s,v.filter(s,pe,g,F,ce),g,F,ce);v._rotate=w==2?v.rotate(s,ne,g,F):0;let Q=v._size;v._size=Dt(v.size(s,ne,g,c)),Q!=null&&v._size!=Q&&(p=!1)}),p}function nu(c){let p=!0;return ol.forEach((v,g)=>{let x=v(s,g,wa,c);x!=oa[g]&&(p=!1),oa[g]=x}),p}function ou(){for(let c=0;c<k.length;c++){let p=k[c];if(!p.show||!p._show)continue;let v=p.side,g=v%2,x,w,T=p.stroke(s,c),D=v==0||v==3?-1:1,[R,z]=p._found;if(p.label!=null){let it=p.labelGap*D,bt=qe((p._lpos+it)*ve);cl(p.labelFont[0],T,"center",v==2?"top":Li),f.save(),g==1?(x=w=0,f.translate(bt,qe(Ct+It/2)),f.rotate((v==3?-Ms:Ms)/2)):(x=qe(yt+pt/2),w=bt);let Aa=_c(p.label)?p.label(s,c,R,z):p.label;f.fillText(Aa,x,w),f.restore()}if(z==0)continue;let F=S[p.scale],V=g==0?pt:It,X=g==0?yt:Ct,pe=p._splits,ce=F.distr==2?pe.map(it=>Nt[it]):pe,ne=F.distr==2?Nt[pe[1]]-Nt[pe[0]]:R,Q=p.ticks,J=p.border,Pe=Q.show?Q.size:0,Ie=qe(Pe*ve),et=qe((p.alignTo==2?p._size-Pe-p.gap:p.gap)*ve),ke=p._rotate*-Ms/180,Ne=A(p._pos*ve),gt=(Ie+et)*D,lt=Ne+gt;w=g==0?lt:0,x=g==1?lt:0;let Et=p.font[0],Ot=p.align==1?fr:p.align==2?Vn:ke>0?fr:ke<0?Vn:g==0?"center":v==3?Vn:fr,qt=ke||g==1?"middle":v==2?"top":Li;cl(Et,T,Ot,qt);let xt=p.font[1]*p.lineGap,Pt=pe.map(it=>A(i(it,F,V,X))),Ht=p._values;for(let it=0;it<Ht.length;it++){let bt=Ht[it];if(bt!=null){g==0?x=Pt[it]:w=Pt[it],bt=""+bt;let Aa=bt.indexOf(`
`)==-1?[bt]:bt.split(/\n/gm);for(let ct=0;ct<Aa.length;ct++){let Ll=Aa[ct];ke?(f.save(),f.translate(x,w+ct*xt),f.rotate(ke),f.fillText(Ll,0,0),f.restore()):f.fillText(Ll,x,w+ct*xt)}}}Q.show&&on(Pt,Q.filter(s,ce,c,z,ne),g,v,Ne,Ie,Ce(Q.width*ve,3),Q.stroke(s,c),Q.dash,Q.cap);let Yt=p.grid;Yt.show&&on(Pt,Yt.filter(s,ce,c,z,ne),g,g==0?2:1,g==0?Ct:yt,g==0?It:pt,Ce(Yt.width*ve,3),Yt.stroke(s,c),Yt.dash,Yt.cap),J.show&&on([Ne],[1],g==0?1:0,g==0?1:2,g==1?Ct:yt,g==1?It:pt,Ce(J.width*ve,3),J.stroke(s,c),J.dash,J.cap)}Xe("drawAxes")}function Za(c){_.forEach((p,v)=>{v>0&&(p._paths=null,c&&(n==1?(p.min=null,p.max=null):p.facets.forEach(g=>{g.min=null,g.max=null})))})}let ls=!1,ln=!1,Mr=[];function lu(){ln=!1;for(let c=0;c<Mr.length;c++)Xe(...Mr[c]);Mr.length=0}function Qa(){ls||(tf(vl),ls=!0)}function iu(c,p=!1){ls=!0,ln=p,c(s),vl(),p&&Mr.length>0&&queueMicrotask(lu)}s.batch=iu;function vl(){if(Ys&&(Xd(),Ys=!1),Va&&(Gd(),Va=!1),ts){if($e(b,fr,Te),$e(b,"top",Ve),$e(b,Wr,te),$e(b,Vr,U),$e(h,fr,Te),$e(h,"top",Ve),$e(h,Wr,te),$e(h,Vr,U),$e(m,Wr,ea),$e(m,Vr,ga),y.width=qe(ea*ve),y.height=qe(ga*ve),k.forEach(({_el:c,_show:p,_size:v,_pos:g,side:x})=>{if(c!=null)if(p){let w=x===3||x===0?v:0,T=x%2==1;$e(c,T?"left":"top",g-w),$e(c,T?"width":"height",v),$e(c,T?"top":"left",T?Ve:Te),$e(c,T?"height":"width",T?U:te),eo(c,Ra)}else _t(c,Ra)}),ss=Ja=Zs=Xs=en=tn=an=rn=Qs=null,ft=1,$r(!0),Te!=Wa||Ve!=xa||te!=Ut||U!=ba){Za(!1);let c=te/Ut,p=U/ba;if(nt&&!ha&&K.left>=0){K.left*=c,K.top*=p,Xa&&Zt(Xa,qe(K.left),0,te,U),er&&Zt(er,0,qe(K.top),te,U);for(let v=0;v<Mt.length;v++){let g=Mt[v];g!=null&&(Ya[v]*=c,Ka[v]*=p,Zt(g,Dt(Ya[v]),Dt(Ka[v]),te,U))}}if(Ee.show&&!as&&Ee.left>=0&&Ee.width>0){Ee.left*=c,Ee.width*=c,Ee.top*=p,Ee.height*=p;for(let v in vn)$e(rr,v,Ee[v])}Wa=Te,xa=Ve,Ut=te,ba=U}Xe("setSize"),ts=!1}ea>0&&ga>0&&(f.clearRect(0,0,y.width,y.height),Xe("drawClear"),I.forEach(c=>c()),Xe("draw")),Ee.show&&as&&(is(Ee),as=!1),nt&&ha&&(Sa(null,!0,!1),ha=!1),ae.show&&ae.live&&Tt&&(pn(),Tt=!1),u||(u=!0,s.status=1,Xe("ready")),Tr=!1,ls=!1}s.redraw=(c,p)=>{Va=p||!1,c!==!1?ia($,L.min,L.max):Qa()};function cn(c,p){let v=S[c];if(v.from==null){if(tt==0){let g=v.range(s,p.min,p.max,c);p.min=g[0],p.max=g[1]}if(p.min>p.max){let g=p.min;p.min=p.max,p.max=g}if(tt>1&&p.min!=null&&p.max!=null&&p.max-p.min<1e-16)return;c==$&&v.distr==2&&tt>0&&(p.min=Ft(p.min,a[0]),p.max=Ft(p.max,a[0]),p.min==p.max&&p.max++),Y[c]=p,Ys=!0,Qa()}}s.setScale=cn;let dn,un,Xa,er,ml,yl,tr,ar,gl,xl,Me,De,la=!1,at=K.drag,Ze=at.x,Qe=at.y;nt&&(K.x&&(dn=Lt(Ap,h)),K.y&&(un=Lt(Cp,h)),L.ori==0?(Xa=dn,er=un):(Xa=un,er=dn),Me=K.left,De=K.top);let Ee=s.select=Ue({show:!0,over:!0,left:0,width:0,top:0,height:0},t.select),rr=Ee.show?Lt(Sp,Ee.over?h:b):null;function is(c,p){if(Ee.show){for(let v in c)Ee[v]=c[v],v in vn&&$e(rr,v,c[v]);p!==!1&&Xe("setSelect")}}s.setSelect=is;function cu(c){if(_[c].show)We&&eo(Re[c],Ra);else if(We&&_t(Re[c],Ra),nt){let v=qa?Mt[0]:Mt[c];v!=null&&Zt(v,-10,-10,te,U)}}function ia(c,p,v){cn(c,{min:p,max:v})}function Vt(c,p,v,g){p.focus!=null&&vu(c),p.show!=null&&_.forEach((x,w)=>{w>0&&(c==w||c==null)&&(x.show=p.show,cu(w),n==2?(ia(x.facets[0].scale,null,null),ia(x.facets[1].scale,null,null)):ia(x.scale,null,null),Qa())}),v!==!1&&Xe("setSeries",c,p),g&&Lr("setSeries",s,c,p)}s.setSeries=Vt;function du(c,p){Ue(O[c],p)}function uu(c,p){c.fill=oe(c.fill||null),c.dir=ue(c.dir,-1),p=p??O.length,O.splice(p,0,c)}function pu(c){c==null?O.length=0:O.splice(c,1)}s.addBand=uu,s.setBand=du,s.delBand=pu;function fu(c,p){_[c].alpha=p,nt&&Mt[c]!=null&&(Mt[c].style.opacity=p),We&&Re[c]&&(Re[c].style.opacity=p)}let ta,ca,ka,sr={focus:!0};function vu(c){if(c!=ka){let p=c==null,v=Wt.alpha!=1;_.forEach((g,x)=>{if(n==1||x>0){let w=p||x==0||x==c;g._focus=p?null:w,v&&fu(x,w?1:Wt.alpha)}}),ka=c,v&&Qa()}}We&&Ga&&ot(Ni,ge,c=>{K._lock||(_a(c),ka!=null&&Vt(null,sr,!0,Be.setSeries))});function Gt(c,p,v){let g=S[p];v&&(c=c/ve-(g.ori==1?Ve:Te));let x=te;g.ori==1&&(x=U,c=x-c),g.dir==-1&&(c=x-c);let w=g._min,T=g._max,D=c/x,R=w+(T-w)*D,z=g.distr;return z==3?yr(10,R):z==4?Up(R,g.asinh):z==100?g.bwd(R):R}function mu(c,p){let v=Gt(c,$,p);return Ft(v,a[0],Ke,Je)}s.valToIdx=c=>Ft(c,a[0]),s.posToIdx=mu,s.posToVal=Gt,s.valToPos=(c,p,v)=>S[p].ori==0?o(c,S[p],v?pt:te,v?yt:0):l(c,S[p],v?It:U,v?Ct:0),s.setCursor=(c,p,v)=>{Me=c.left,De=c.top,Sa(null,p,v)};function bl(c,p){$e(rr,fr,Ee.left=c),$e(rr,Wr,Ee.width=p)}function hl(c,p){$e(rr,"top",Ee.top=c),$e(rr,Vr,Ee.height=p)}let Er=L.ori==0?bl:hl,Pr=L.ori==1?bl:hl;function yu(){if(We&&ae.live)for(let c=n==2?1:0;c<_.length;c++){if(c==0&&At)continue;let p=ae.values[c],v=0;for(let g in p)jt[c][v++].firstChild.nodeValue=p[g]}}function pn(c,p){if(c!=null&&(c.idxs?c.idxs.forEach((v,g)=>{ye[g]=v}):qp(c.idx)||ye.fill(c.idx),ae.idx=ye[0]),We&&ae.live){for(let v=0;v<_.length;v++)(v>0||n==1&&!At)&&gu(v,ye[v]);yu()}Tt=!1,p!==!1&&Xe("setLegend")}s.setLegend=pn;function gu(c,p){let v=_[c],g=c==0&&q==2?Nt:a[c],x;At?x=v.values(s,c,p)??na:(x=v.value(s,p==null?null:g[p],c,p),x=x==null?na:{_:x}),ae.values[c]=x}function Sa(c,p,v){gl=Me,xl=De,[Me,De]=K.move(s,Me,De),K.left=Me,K.top=De,nt&&(Xa&&Zt(Xa,qe(Me),0,te,U),er&&Zt(er,0,qe(De),te,U));let g,x=Ke>Je;ta=Ae,ca=null;let w=L.ori==0?te:U,T=L.ori==1?te:U;if(Me<0||tt==0||x){g=K.idx=null;for(let D=0;D<_.length;D++){let R=Mt[D];R!=null&&Zt(R,-10,-10,te,U)}Ga&&Vt(null,sr,!0,c==null&&Be.setSeries),ae.live&&(ye.fill(g),Tt=!0)}else{let D,R,z;n==1&&(D=L.ori==0?Me:De,R=Gt(D,$),g=K.idx=Ft(R,a[0],Ke,Je),z=G(a[0][g],L,w,0));let F=-10,V=-10,X=0,pe=0,ce=!0,ne="",Q="";for(let J=n==2?1:0;J<_.length;J++){let Pe=_[J],Ie=ye[J],et=Ie==null?null:n==1?a[J][Ie]:a[J][1][Ie],ke=K.dataIdx(s,J,g,R),Ne=ke==null?null:n==1?a[J][ke]:a[J][1][ke];if(Tt=Tt||Ne!=et||ke!=Ie,ye[J]=ke,J>0&&Pe.show){let gt=ke==null?-10:ke==g?z:G(n==1?a[0][ke]:a[J][0][ke],L,w,0),lt=Ne==null?-10:Z(Ne,n==1?S[Pe.scale]:S[Pe.facets[1].scale],T,0);if(Ga&&Ne!=null){let Et=L.ori==1?Me:De,Ot=Ye(Wt.dist(s,J,ke,lt,Et));if(Ot<ta){let qt=Wt.bias;if(qt!=0){let xt=Gt(Et,Pe.scale),Pt=Ne>=0?1:-1,Ht=xt>=0?1:-1;Ht==Pt&&(Ht==1?qt==1?Ne>=xt:Ne<=xt:qt==1?Ne<=xt:Ne>=xt)&&(ta=Ot,ca=J)}else ta=Ot,ca=J}}if(Tt||qa){let Et,Ot;L.ori==0?(Et=gt,Ot=lt):(Et=lt,Ot=gt);let qt,xt,Pt,Ht,Yt,it,bt=!0,Aa=st.bbox;if(Aa!=null){bt=!1;let ct=Aa(s,J);Pt=ct.left,Ht=ct.top,qt=ct.width,xt=ct.height}else Pt=Et,Ht=Ot,qt=xt=st.size(s,J);if(it=st.fill(s,J),Yt=st.stroke(s,J),qa)J==ca&&ta<=Wt.prox&&(F=Pt,V=Ht,X=qt,pe=xt,ce=bt,ne=it,Q=Yt);else{let ct=Mt[J];ct!=null&&(Ya[J]=Pt,Ka[J]=Ht,Ui(ct,qt,xt,bt),Bi(ct,it,Yt),Zt(ct,Dt(Pt),Dt(Ht),te,U))}}}}if(qa){let J=Wt.prox,Pe=ka==null?ta<=J:ta>J||ca!=ka;if(Tt||Pe){let Ie=Mt[0];Ie!=null&&(Ya[0]=F,Ka[0]=V,Ui(Ie,X,pe,ce),Bi(Ie,ne,Q),Zt(Ie,Dt(F),Dt(V),te,U))}}}if(Ee.show&&la)if(c!=null){let[D,R]=Be.scales,[z,F]=Be.match,[V,X]=c.cursor.sync.scales,pe=c.cursor.drag;if(Ze=pe._x,Qe=pe._y,Ze||Qe){let{left:ce,top:ne,width:Q,height:J}=c.select,Pe=c.scales[V].ori,Ie=c.posToVal,et,ke,Ne,gt,lt,Et=D!=null&&z(D,V),Ot=R!=null&&F(R,X);Et&&Ze?(Pe==0?(et=ce,ke=Q):(et=ne,ke=J),Ne=S[D],gt=G(Ie(et,V),Ne,w,0),lt=G(Ie(et+ke,V),Ne,w,0),Er(Bt(gt,lt),Ye(lt-gt))):Er(0,w),Ot&&Qe?(Pe==1?(et=ce,ke=Q):(et=ne,ke=J),Ne=S[R],gt=Z(Ie(et,X),Ne,T,0),lt=Z(Ie(et+ke,X),Ne,T,0),Pr(Bt(gt,lt),Ye(lt-gt))):Pr(0,T)}else mn()}else{let D=Ye(gl-ml),R=Ye(xl-yl);if(L.ori==1){let X=D;D=R,R=X}Ze=at.x&&D>=at.dist,Qe=at.y&&R>=at.dist;let z=at.uni;z!=null?Ze&&Qe&&(Ze=D>=z,Qe=R>=z,!Ze&&!Qe&&(R>D?Qe=!0:Ze=!0)):at.x&&at.y&&(Ze||Qe)&&(Ze=Qe=!0);let F,V;Ze&&(L.ori==0?(F=tr,V=Me):(F=ar,V=De),Er(Bt(F,V),Ye(V-F)),Qe||Pr(0,T)),Qe&&(L.ori==1?(F=tr,V=Me):(F=ar,V=De),Pr(Bt(F,V),Ye(V-F)),Ze||Er(0,w)),!Ze&&!Qe&&(Er(0,0),Pr(0,0))}if(at._x=Ze,at._y=Qe,c==null){if(v){if($l!=null){let[D,R]=Be.scales;Be.values[0]=D!=null?Gt(L.ori==0?Me:De,D):null,Be.values[1]=R!=null?Gt(L.ori==1?Me:De,R):null}Lr(Gn,s,Me,De,te,U,g)}if(Ga){let D=v&&Be.setSeries,R=Wt.prox;ka==null?ta<=R&&Vt(ca,sr,!0,D):ta>R?Vt(null,sr,!0,D):ca!=ka&&Vt(ca,sr,!0,D)}}Tt&&(ae.idx=g,pn()),p!==!1&&Xe("setCursor")}let da=null;Object.defineProperty(s,"rect",{get(){return da==null&&$r(!1),da}});function $r(c=!1){c?da=null:(da=h.getBoundingClientRect(),Xe("syncRect",da))}function _l(c,p,v,g,x,w,T){K._lock||la&&c!=null&&c.movementX==0&&c.movementY==0||(fn(c,p,v,g,x,w,T,!1,c!=null),c!=null?Sa(null,!0,!0):Sa(p,!0,!1))}function fn(c,p,v,g,x,w,T,D,R){if(da==null&&$r(!1),_a(c),c!=null)v=c.clientX-da.left,g=c.clientY-da.top;else{if(v<0||g<0){Me=-10,De=-10;return}let[z,F]=Be.scales,V=p.cursor.sync,[X,pe]=V.values,[ce,ne]=V.scales,[Q,J]=Be.match,Pe=p.axes[0].side%2==1,Ie=L.ori==0?te:U,et=L.ori==1?te:U,ke=Pe?w:x,Ne=Pe?x:w,gt=Pe?g:v,lt=Pe?v:g;if(ce!=null?v=Q(z,ce)?i(X,S[z],Ie,0):-10:v=Ie*(gt/ke),ne!=null?g=J(F,ne)?i(pe,S[F],et,0):-10:g=et*(lt/Ne),L.ori==1){let Et=v;v=g,g=Et}}R&&(p==null||p.cursor.event.type==Gn)&&((v<=1||v>=te-1)&&(v=La(v,te)),(g<=1||g>=U-1)&&(g=La(g,U))),D?(ml=v,yl=g,[tr,ar]=K.move(s,v,g)):(Me=v,De=g)}let vn={width:0,height:0,left:0,top:0};function mn(){is(vn,!1)}let wl,kl,Sl,Al;function Cl(c,p,v,g,x,w,T){la=!0,Ze=Qe=at._x=at._y=!1,fn(c,p,v,g,x,w,T,!0,!1),c!=null&&(ot(qn,Qn,Tl,!1),Lr(Ri,s,tr,ar,te,U,null));let{left:D,top:R,width:z,height:F}=Ee;wl=D,kl=R,Sl=z,Al=F}function Tl(c,p,v,g,x,w,T){la=at._x=at._y=!1,fn(c,p,v,g,x,w,T,!1,!0);let{left:D,top:R,width:z,height:F}=Ee,V=z>0||F>0,X=wl!=D||kl!=R||Sl!=z||Al!=F;if(V&&X&&is(Ee),at.setScale&&V&&X){let pe=D,ce=z,ne=R,Q=F;if(L.ori==1&&(pe=R,ce=F,ne=D,Q=z),Ze&&ia($,Gt(pe,$),Gt(pe+ce,$)),Qe)for(let J in S){let Pe=S[J];J!=$&&Pe.from==null&&Pe.min!=Ae&&ia(J,Gt(ne+Q,J),Gt(ne,J))}mn()}else K.lock&&(K._lock=!K._lock,Sa(p,!0,c!=null));c!=null&&(Ua(qn,Qn),Lr(qn,s,Me,De,te,U,null))}function xu(c,p,v,g,x,w,T){if(K._lock)return;_a(c);let D=la;if(la){let R=!0,z=!0,F=10,V,X;L.ori==0?(V=Ze,X=Qe):(V=Qe,X=Ze),V&&X&&(R=Me<=F||Me>=te-F,z=De<=F||De>=U-F),V&&R&&(Me=Me<tr?0:te),X&&z&&(De=De<ar?0:U),Sa(null,!0,!0),la=!1}Me=-10,De=-10,ye.fill(null),Sa(null,!0,!0),D&&(la=D)}function Ml(c,p,v,g,x,w,T){K._lock||(_a(c),Js(),mn(),c!=null&&Lr(Oi,s,Me,De,te,U,null))}function El(){k.forEach(dv),Ks(s.width,s.height,!0)}Ia(Es,mr,El);let nr={};nr.mousedown=Cl,nr.mousemove=_l,nr.mouseup=Tl,nr.dblclick=Ml,nr.setSeries=(c,p,v,g)=>{let x=Be.match[2];v=x(s,p,v),v!=-1&&Vt(v,g,!0,!1)},nt&&(ot(Ri,h,Cl),ot(Gn,h,_l),ot(Ii,h,c=>{_a(c),$r(!1)}),ot(Ni,h,xu),ot(Oi,h,Ml),oo.add(s),s.syncRect=$r);let cs=s.hooks=t.hooks||{};function Xe(c,p,v){ln?Mr.push([c,p,v]):c in cs&&cs[c].forEach(g=>{g.call(null,s,p,v)})}(t.plugins||[]).forEach(c=>{for(let p in c.hooks)cs[p]=(cs[p]||[]).concat(c.hooks[p])});let Pl=(c,p,v)=>v,Be=Ue({key:null,setSeries:!1,filters:{pub:Yi,sub:Yi},scales:[$,_[1]?_[1].scale:null],match:[Ki,Ki,Pl],values:[null,null]},K.sync);Be.match.length==2&&Be.match.push(Pl),K.sync=Be;let $l=Be.key,yn=Vc($l);function Lr(c,p,v,g,x,w,T){Be.filters.pub(c,p,v,g,x,w,T)&&yn.pub(c,p,v,g,x,w,T)}yn.sub(s);function bu(c,p,v,g,x,w,T){Be.filters.sub(c,p,v,g,x,w,T)&&nr[c](null,p,v,g,x,w,T)}s.pub=bu;function hu(){yn.unsub(s),oo.delete(s),ya.clear(),to(Es,mr,El),d.remove(),ge?.remove(),Xe("destroy")}s.destroy=hu;function gn(){Xe("init",t,a),ll(a||t.data,!1),Y[$]?cn($,Y[$]):Js(),as=Ee.show&&(Ee.width>0||Ee.height>0),ha=Tt=!0,Ks(t.width,t.height)}return _.forEach(nl),k.forEach(Qd),r?r instanceof HTMLElement?(r.appendChild(d),gn()):r(s,gn):gn(),s}rt.assign=Ue;rt.fmtNum=vo;rt.rangeNum=Ps;rt.rangeLog=Ds;rt.rangeAsinh=po;rt.orient=Oa;rt.pxRatio=ve;rt.join=ef;rt.fmtDate=yo,rt.tzDate=pf;rt.sync=Vc;{rt.addGap=Yf,rt.clipGaps=Ns;let t=rt.paths={points:Zc};t.linear=Xc,t.stepped=Zf,t.bars=Qf,t.spline=ev}function Ha({data:t,series:a,height:r,className:s,compact:n=!1}){r===void 0&&(r=n?32:120);let o=$t(null),l=$t(null);return le(()=>{if(!o.current||!t||t.length===0)return;let i=getComputedStyle(document.documentElement),u=i.getPropertyValue("--text-tertiary").trim(),d=i.getPropertyValue("--border-subtle").trim(),y=i.getPropertyValue("--font-mono").trim()||"monospace";function f(b){return b.startsWith("var(")?i.getPropertyValue(b.slice(4,-1)).trim():b}let m={width:o.current.clientWidth,height:r,cursor:n?{show:!1}:{show:!0,drag:{x:!1,y:!1}},legend:{show:!1},padding:n?[0,0,0,0]:void 0,axes:n?[{show:!1},{show:!1}]:[{stroke:u,grid:{stroke:d,width:1},font:`10px ${y}`,ticks:{stroke:d,width:1}},{stroke:u,grid:{stroke:d,width:1},font:`10px ${y}`,ticks:{stroke:d,width:1},size:50}],series:[{},...a.map(b=>{let h=f(b.color);return{label:b.label,stroke:h,width:b.width||2,fill:n?void 0:h+"15"}})]};return l.current&&l.current.destroy(),l.current=new rt(m,t,o.current),()=>{l.current&&(l.current.destroy(),l.current=null)}},[t,a,r,n]),le(()=>{if(!o.current)return;let i=new ResizeObserver(()=>{l.current&&o.current&&l.current.setSize({width:o.current.clientWidth,height:r})});return i.observe(o.current),()=>i.disconnect()},[r]),n?e("div",{ref:o,class:s||"",role:"img","aria-label":t&&t.length>1?`Sparkline: ${a.map(i=>i.label).join(", ")}`:"Sparkline loading"}):e("figure",null,e("div",{ref:o,class:s||"",role:"img","aria-label":t&&t.length>1?`Chart: ${a.map(i=>i.label).join(", ")}`:"Chart loading"}),t&&t.length>1&&e("figcaption",{class:"sr-only"},a.map(i=>i.label).join(", ")," \u2014 ",t[0].length," data points"))}function Fe({value:t,label:a,unit:r,delta:s,warning:n,loading:o,sparkData:l,sparkColor:i}){return e("div",{class:`t-frame ${o?"cursor-working":"cursor-active"}`,"data-label":a,style:n?"border-left: 3px solid var(--status-warning);":""},e("div",{class:"flex items-baseline gap-2",style:"justify-content: space-between;"},e("div",{class:"flex items-baseline gap-2"},e("span",{class:"data-mono",style:`font-size: var(--type-hero); font-weight: 600; color: ${n?"var(--status-warning)":"var(--accent)"}; line-height: 1;`},t??"\u2014"),r&&e("span",{class:"data-mono",style:"font-size: var(--type-headline); color: var(--text-tertiary);"},r)),l&&l.length>1&&l[0].length>1&&e("div",{style:"width: 80px; height: 32px; flex-shrink: 0;"},e(Ha,{data:l,series:[{label:a||"trend",color:i||"var(--accent)",width:1.5}],compact:!0}))),s&&e("div",{style:"font-size: var(--type-label); color: var(--text-secondary); margin-top: 8px; font-family: var(--font-mono);"},s))}var uv={A:["01110","11011","11111","11011","11011"],B:["11110","11011","11110","11011","11110"],C:["0111","1100","1100","1100","0111"],D:["11110","11011","11011","11011","11110"],E:["1111","1100","1110","1100","1111"],F:["1111","1100","1110","1100","1100"],G:["01110","11000","11011","11011","01110"],H:["11011","11011","11111","11011","11011"],I:["1","1","1","1","1"],J:["0111","0011","0011","1011","0110"],K:["11001","11010","11100","11010","11001"],L:["1100","1100","1100","1100","1111"],M:["10001","11011","10101","10001","10001"],N:["10001","11001","10101","10011","10001"],O:["01110","11011","11011","11011","01110"],P:["11110","11011","11110","11000","11000"],Q:["01110","11011","11011","11010","01101"],R:["11111","11011","11110","11010","11001"],S:["0111","1100","0110","0011","1110"],T:["11111","00100","00100","00100","00100"],U:["11011","11011","11011","11011","01110"],V:["10001","10001","01010","01010","00100"],W:["10001","10001","10101","10101","01010"],X:["10001","01010","00100","01010","10001"],Y:["10001","01010","00100","00100","00100"],Z:["11111","00010","00100","01000","11111"]},pv=["000","010","111","010","000"],Qt=10,za=2,kr=Qt-za,ko=1,rd=2,sd=3;function nd(t){let a=0,r=[];for(let s=0;s<t.length;s++){let n=t[s],o=uv[n];if(!o)continue;let l=o[0].length;for(let i=0;i<5;i++)for(let u=0;u<l;u++)o[i][u]==="1"&&r.push([a+u,i]);a+=l+rd}return{pixels:r,endX:a>0?a-rd:0}}function fv(t){let a=[];for(let r=0;r<5;r++)for(let s=0;s<3;s++)pv[r][s]==="1"&&a.push([t+s,r]);return{pixels:a,endX:t+3}}function ie({page:t,subtitle:a}){let r=Oe(()=>{let s=nd("ARIA"),n=s.endX+sd,o=fv(n),l=o.endX+sd,i=nd(t),u=i.pixels.map(([y,f])=>[y+l,f]),d=(l+i.endX)*Qt+Qt;return{ariaPixels:s.pixels,sepPixels:o.pixels,pagePixels:u,totalWidth:d}},[t]);return e("div",{style:"margin-bottom: 1.5rem"},e("svg",{viewBox:`0 0 ${r.totalWidth} ${5*Qt}`,style:"height: 2rem; max-width: 100%; width: auto; display: block;",role:"img","aria-label":`ARIA ${t}`},r.ariaPixels.map(([s,n],o)=>e("rect",{key:`a${o}`,x:s*Qt+za/2,y:n*Qt+za/2,width:kr,height:kr,rx:ko,fill:"var(--accent)"})),r.sepPixels.map(([s,n],o)=>e("rect",{key:`s${o}`,x:s*Qt+za/2,y:n*Qt+za/2,width:kr,height:kr,rx:ko,fill:"var(--text-tertiary)"})),r.pagePixels.map(([s,n],o)=>e("rect",{key:`p${o}`,x:s*Qt+za/2,y:n*Qt+za/2,width:kr,height:kr,rx:ko,fill:"var(--text-primary)"}))),a&&e("p",{style:"margin-top: 0.5rem; font-size: var(--type-label); color: var(--text-secondary)"},a))}var So=["collecting","baselines","ml-training","ml-active"],vv=["Collecting","Baselines","ML Training","ML Active"],od=["Gathering daily snapshots","Statistical baselines active","Training ML models","Full intelligence active"],mv={data:{label:"DATA PLANE",nodes:[{id:"discovery",label:"Discovery",metricKey:"entity_count"},{id:"activity_monitor",label:"Activity",metricKey:"event_rate"},{id:"data_quality",label:"Curation",metricKey:"included_count"},{id:"activity_labeler",label:"Labeler",metricKey:"current_activity"}]},learning:{label:"LEARNING PLANE",nodes:[{id:"intelligence",label:"Intel.",metricKey:"day_count"},{id:"ml_engine",label:"ML Engine",metricKey:"mean_r2"},{id:"pattern_recognition",label:"Patterns",metricKey:"sequence_count"},{id:"drift_monitor",label:"Drift",metricKey:"drift_count"}]},action:{label:"ACTION PLANE",nodes:[{id:"shadow_engine",label:"Shadow",metricKey:"accuracy"},{id:"orchestrator",label:"Orchestr.",metricKey:"pending_count"},{id:"pipeline_gates",label:"Gates",metricKey:"pipeline_stage"},{id:"feedback_health",label:"Feedback",metricKey:"feedback_fresh"}]}};function yv(t,a){let r=t?.[a];return r==="running"?"healthy":r==="failed"?"blocked":"waiting"}function gv(t,a){let r=t?.capabilities?.data||{},s=t?.pipeline?.data||{},n=t?.shadow_accuracy?.data||{},o=t?.activity_labels?.data||{},l=t?.feedback_health||{};switch(a.id){case"discovery":{let i=Object.values(r).filter(u=>u&&typeof u=="object"&&u.entities).reduce((u,d)=>u+(d.entities?.length||0),0);return i?`${i} entities`:"\u2014"}case"activity_monitor":return s?.events_per_minute?`${s.events_per_minute.toFixed(1)} ev/m`:"\u2014";case"data_quality":return s?.included_entities?`${s.included_entities} incl.`:"\u2014";case"activity_labeler":return o?.current_activity?.predicted||"\u2014";case"intelligence":return s?.intelligence_day?`Day ${s.intelligence_day}`:"\u2014";case"ml_engine":{let i=Object.values(r).filter(d=>d?.ml_accuracy);return i.length===0?"\u2014":`R\xB2: ${(i.reduce((d,y)=>d+(y.ml_accuracy.mean_r2||0),0)/i.length).toFixed(2)}`}case"pattern_recognition":return"\u2014";case"drift_monitor":return`${Object.values(r).filter(u=>u?.drift_flagged).length} flagged`;case"shadow_engine":return n?.overall_accuracy?`${(n.overall_accuracy*100).toFixed(0)}%`:"\u2014";case"orchestrator":return"\u2014";case"pipeline_gates":return s?.stage||"shadow";case"feedback_health":return`${(l?.capabilities_with_ml_feedback||0)+(l?.capabilities_with_shadow_feedback||0)} fresh`;default:return"\u2014"}}function xv({x:t,y:a,status:r,label:s,metric:n,glowing:o,animateMetric:l}){let i={healthy:"var(--status-healthy)",waiting:"var(--status-waiting)",blocked:"var(--status-error)",review:"var(--status-warning)"},u=i[r]||i.waiting;return e("g",{transform:`translate(${t}, ${a})`},e("rect",{width:"180",height:"55",rx:"4",fill:"var(--bg-surface)",stroke:o?"var(--accent)":"var(--border-primary)","stroke-width":o?"2":"1"}),o&&e("rect",{width:"180",height:"55",rx:"4",fill:"none",stroke:"var(--accent)","stroke-width":"1",opacity:"0.3"},e("animate",{attributeName:"opacity",values:"0.3;0.1;0.3",dur:"2s",repeatCount:"1"})),e("circle",{cx:"16",cy:"16",r:"5",fill:u,filter:"url(#led-glow)"},(r==="healthy"||o)&&e("animate",{attributeName:"opacity",values:"1;0.6;1",dur:o?"1s":"3s",repeatCount:"indefinite"})),e("text",{x:"28",y:"20",fill:"var(--text-primary)","font-size":"11","font-weight":"600","font-family":"var(--font-mono)"},s),e("text",{x:"16",y:"42",fill:"var(--text-tertiary)","font-size":"10","font-family":"var(--font-mono)",class:l?"t2-typewriter":""},n))}function bv({x:t,y:a,label:r}){return e("text",{x:t,y:a,"text-anchor":"middle",fill:"var(--text-tertiary)","font-size":"10","font-weight":"700","font-family":"var(--font-mono)","letter-spacing":"2"},r)}function Fs({x:t,y1:a,y2:r,label:s,stale:n,flashing:o}){return e("g",{class:o?" animate-data-refresh":""},e("line",{x1:t,y1:a,x2:t,y2:r,class:n?"":"bus-connector-line",stroke:n?"var(--status-error)":"var(--border-primary)","stroke-width":"1","stroke-dasharray":n?"2 4":void 0}),n&&e("g",{transform:`translate(${t-4}, ${(a+r)/2-6})`},e("circle",{cx:"4",cy:"4",r:"6",fill:"var(--status-error)",opacity:"0.2"}),e("text",{x:"4",y:"7","text-anchor":"middle",fill:"var(--status-error)","font-size":"9","font-weight":"bold","font-family":"var(--font-mono)"},"!")),s&&e("text",{x:t+4,y:(a+r)/2,fill:n?"var(--status-error)":"var(--text-tertiary)","font-size":"8","font-family":"var(--font-mono)"},s))}var ld={capabilities:{section:"data",index:0},entities:{section:"data",index:0},activity_summary:{section:"data",index:1},entity_curation:{section:"data",index:2},activity_labels:{section:"data",index:3},ml_accuracy:{section:"learning",index:1},shadow_accuracy:{section:"learning",index:1}},hv=2880*60*1e3;function Ao(t){if(!t)return!0;let a=typeof t=="string"?new Date(t).getTime():t;return isNaN(a)?!0:Date.now()-a>hv}function _v(t){if(!t)return 1.5;let r=[t.capabilities_with_ml_feedback,t.capabilities_with_shadow_feedback,t.total_feedback_entries,t.feedback_sources_active,t.capabilities_with_drift_feedback].filter(s=>s&&s>0).length;return r>=5?3:r>=3?2.5:r>=1?2:1.5}function wv({moduleStatuses:t,cacheData:a,feedbackHealth:r}){let s=[50,260,470,680],n=["entities","events","rules","labels"],o=["","accuracy","",""],[l,i]=N({}),u=$t({});le(()=>{let $=Object.keys(ld),H={};$.forEach(j=>{let B=Pa(j);H[j]=B.value.lastFetched||0});let I=setInterval(()=>{$.forEach(j=>{let L=Pa(j).value.lastFetched||0;if(L>H[j]&&H[j]>0){let q=ld[j],G=`${q.section}-${q.index}`;i(Z=>({...Z,[G]:!0})),clearTimeout(u.current[G]),u.current[G]=setTimeout(()=>{i(Z=>({...Z,[G]:!1}))},300)}H[j]=L})},200);return()=>{clearInterval(I),Object.values(u.current).forEach(clearTimeout)}},[]);let d=$t(null),[y,f]=N(!1),[m,b]=N(!1),h=$t(null),C=a?.activity_labels?.data?.current_activity?.predicted||null;le(()=>(d.current!==null&&C!==d.current&&C!==null&&(f(!0),b(!0),clearTimeout(h.current),h.current=setTimeout(()=>{f(!1),b(!1)},2e3)),d.current=C,()=>clearTimeout(h.current)),[C]);let A=r||{},M=[!1,Ao(A.last_ml_feedback_at),!1,!1],_=[Ao(A.last_shadow_feedback_at),!1,!1,Ao(A.last_feedback_at)],k=_v(r);function S($,H){let I=mv[$];return e("g",{transform:`translate(0, ${H})`},e(bv,{x:450,y:15,label:I.label}),I.nodes.map((j,B)=>{let L=j.id==="activity_labeler";return e(xv,{key:j.id,x:s[B],y:25,status:yv(t,j.id),label:j.label,metric:gv(a,j),glowing:L&&y,animateMetric:L&&m})}))}let O="M350,230 L350,272 L140,272 L140,122 L870,122 L870,175";return e("section",{class:"t-terminal-bg rounded-lg p-4 overflow-x-auto"},e("svg",{viewBox:"0 0 900 530",class:"w-full",style:"min-width: 700px; max-width: 100%;"},e("defs",null,e("pattern",{id:"bus-flow",width:"20",height:"4",patternUnits:"userSpaceOnUse"},e("rect",{width:"10",height:"4",fill:"var(--accent)",opacity:"0.5"},e("animate",{attributeName:"x",from:"-20",to:"20",dur:"1.5s",repeatCount:"indefinite"}))),e("pattern",{id:"feedback-flow",width:"20",height:"4",patternUnits:"userSpaceOnUse"},e("rect",{width:"10",height:"4",fill:"var(--status-healthy)",opacity:"0.5"},e("animate",{attributeName:"x",from:"20",to:"-20",dur:"2s",repeatCount:"indefinite"}))),e("filter",{id:"led-glow"},e("feGaussianBlur",{stdDeviation:"2",result:"blur"}),e("feMerge",null,e("feMergeNode",{in:"blur"}),e("feMergeNode",{in:"SourceGraphic"}))),e("filter",{id:"tracer-glow"},e("feGaussianBlur",{stdDeviation:"4",result:"blur"}),e("feMerge",null,e("feMergeNode",{in:"blur"}),e("feMergeNode",{in:"SourceGraphic"})))),S("data",0),s.map(($,H)=>e(Fs,{key:`dc${H}`,x:$+90,y1:80,y2:110,label:n[H],flashing:l[`data-${H}`]})),e("g",{transform:"translate(0, 110)"},e("rect",{x:"30",y:"0",width:"840",height:"24",rx:"4",fill:"url(#bus-flow)"}),e("rect",{x:"30",y:"0",width:"840",height:"24",rx:"4",fill:"none",stroke:"var(--accent)","stroke-width":k,opacity:"0.4",style:"transition: stroke-width 0.5s ease;"}),e("text",{x:"450",y:"16","text-anchor":"middle",fill:"var(--accent)","font-size":"9","font-family":"var(--font-mono)"},"CAPABILITIES BUS  [entities] [activity] [curation] [labels] [usefulness]"),e("circle",{r:"3",fill:"var(--accent)"},e("animateMotion",{dur:"3s",repeatCount:"indefinite",path:"M30,12 L870,12"}))),s.map(($,H)=>e(Fs,{key:`cl${H}`,x:$+90,y1:134,y2:160})),S("learning",150),s.map(($,H)=>e(Fs,{key:`lf${H}`,x:$+90,y1:230,y2:260,label:o[H],stale:M[H],flashing:l[`learning-${H}`]})),e("g",{transform:"translate(0, 260)"},e("rect",{x:"30",y:"0",width:"840",height:"24",rx:"4",fill:"url(#feedback-flow)"}),e("rect",{x:"30",y:"0",width:"840",height:"24",rx:"4",fill:"none",stroke:"var(--status-healthy)","stroke-width":k,opacity:"0.4",style:"transition: stroke-width 0.5s ease;"}),e("text",{x:"450",y:"16","text-anchor":"middle",fill:"var(--status-healthy)","font-size":"9","font-family":"var(--font-mono)"},"FEEDBACK BUS  [accuracy] [hit_rate] [suggestions] [drift] [corrections]"),e("circle",{r:"3",fill:"var(--status-healthy)"},e("animateMotion",{dur:"4s",repeatCount:"indefinite",path:"M870,12 L30,12"}))),s.map(($,H)=>e(Fs,{key:`fa${H}`,x:$+90,y1:284,y2:310,stale:_[H]})),S("action",300),e("g",{transform:"translate(310, 390)"},e("rect",{x:"0",y:"0",width:"280",height:"35",rx:"4",fill:"var(--bg-inset)",stroke:"var(--accent)","stroke-width":"2"}),e("text",{x:"140",y:"22","text-anchor":"middle",fill:"var(--accent)","font-size":"12","font-weight":"bold","font-family":"var(--font-mono)"},"YOU:  Label \xB7 Curate \xB7 Review \xB7 Advance")),e("circle",{r:"4",fill:"var(--status-healthy)",opacity:"0.9",filter:"url(#tracer-glow)"},e("animateMotion",{dur:"10s",repeatCount:"indefinite",path:O}),e("animate",{attributeName:"r",values:"4;6;4",dur:"10s",repeatCount:"indefinite"})),e("circle",{r:"7",fill:"var(--status-healthy)",opacity:"0.25",filter:"url(#tracer-glow)"},e("animateMotion",{dur:"10s",repeatCount:"indefinite",path:O,begin:"0.5s"}),e("animate",{attributeName:"r",values:"7;10;7",dur:"10s",repeatCount:"indefinite",begin:"0.5s"}))))}function kv({maturity:t,shadowStage:a}){let r=t&&t.phase||"collecting",s=So.indexOf(r);return e("section",{class:"t-frame","data-label":"system maturity"},e("div",{class:"flex items-center gap-1 mb-2"},So.map((n,o)=>{let l="var(--bg-inset)";return o<s?l="var(--status-healthy)":o===s&&(l="var(--accent)"),e("div",{key:n,class:"h-2 flex-1",style:`border-radius: var(--radius); background: ${l};`})})),e("div",{class:"flex justify-between text-xs"},So.map((n,o)=>{let l="var(--text-tertiary)",i="normal";return o<s?l="var(--status-healthy)":o===s&&(l="var(--accent)",i="500"),e("span",{key:n,style:`color: ${l}; font-weight: ${i};`},vv[o])})),e("p",{class:"text-xs mt-2",style:"color: var(--text-tertiary)"},s>=0&&s<od.length?od[s]:"",a?` \u2014 Pipeline: ${a}`:""))}function Sv({activity:t,intraday:a}){let r=t&&t.data&&t.data.data||null,s=r&&r.websocket||null,n=r&&r.activity_rate||null,o=n?n.current:null,l=r&&r.occupancy||null,i=Array.isArray(a)&&a.length>0?a[a.length-1]:null,u=i?i.lights_on??null:null,d=i?i.power_watts??null:null;return e("section",{class:"t-frame","data-label":"live metrics"},e("div",{class:"flex flex-wrap items-center gap-x-5 gap-y-2 text-sm"},e("div",{class:"flex items-center gap-1.5"},e("span",{style:"color: var(--text-tertiary)"},"Occupancy"),e("span",{class:"font-medium",style:"color: var(--text-primary)"},l&&l.anyone_home?"Home":l?"Away":"\u2014")),e("div",{class:"flex items-center gap-1.5"},e("span",{style:"color: var(--text-tertiary)"},"Events"),e("span",{class:"data-mono font-medium",style:"color: var(--text-primary)"},o!=null?`${o}/min`:"\u2014")),e("div",{class:"flex items-center gap-1.5"},e("span",{style:"color: var(--text-tertiary)"},"Lights"),e("span",{class:"data-mono font-medium",style:"color: var(--text-primary)"},u!=null?`${u} on`:"\u2014")),e("div",{class:"flex items-center gap-1.5"},e("span",{style:"color: var(--text-tertiary)"},"Power"),e("span",{class:"data-mono font-medium",style:"color: var(--text-primary)"},d!=null?`${Math.round(d)} W`:"\u2014")),e("div",{class:"flex items-center gap-1.5"},e("span",{class:"w-2 h-2 rounded-full",style:`background: ${s&&s.connected?"var(--status-healthy)":"var(--status-error)"};`}),e("span",{style:"color: var(--text-tertiary)"},"WebSocket"),e("span",{class:"font-medium",style:"color: var(--text-primary)"},s&&s.connected?"Connected":s===null?"\u2014":"Disconnected"))))}function Co(){let t=He("intelligence"),a=He("activity_summary"),r=He("entities"),[s,n]=N(null),[o,l]=N(null),[i,u]=N(null),[d,y]=N(null),[f,m]=N(null),[b,h]=N(null);le(()=>{Promise.all([de("/health").catch(()=>null),de("/api/shadow/accuracy").catch(()=>null),de("/api/pipeline").catch(()=>null),de("/api/curation/summary").catch(()=>null),de("/api/capabilities/feedback/health").catch(()=>null),de("/api/activity/current").catch(()=>null)]).then(([O,$,H,I,j,B])=>{n(O),l($),u(H),y(I),m(j)}).catch(O=>h(O.message||String(O)))},[]);let C=t.loading||a.loading||r.loading,A=t.error||a.error||r.error,M=fe(()=>!t.data||!t.data.data?null:t.data.data.data_maturity||null,[t.data]),_=fe(()=>!t.data||!t.data.data?null:t.data.data.intraday_trend||null,[t.data]),k=fe(()=>i&&i.current_stage||null,[i]),S=fe(()=>({capabilities:r.data,pipeline:{data:i},shadow_accuracy:{data:o},activity_labels:a.data,feedback_health:f}),[r.data,i,o,a.data,f]);return C&&!t.data?e("div",{class:"space-y-6"},e("div",{class:"t-frame","data-label":"aria"},e(pr,{className:"w-24 mb-1",color:"var(--text-primary)"}),e("p",{class:"text-sm",style:"color: var(--text-tertiary); font-family: var(--font-mono);"},"Live system overview \u2014 data flow, module health, and your next steps.")),e(Se,{type:"full"})):A?e("div",{class:"space-y-6"},e("div",{class:"t-frame","data-label":"aria"},e(pr,{className:"w-24 mb-1",color:"var(--text-primary)"}),e("p",{class:"text-sm",style:"color: var(--text-tertiary); font-family: var(--font-mono);"},"Live system overview \u2014 data flow, module health, and your next steps.")),e(we,{error:A,onRetry:()=>{t.refetch(),a.refetch(),r.refetch()}})):b?e("div",{class:"space-y-6"},e(ie,{page:"HOME",subtitle:"Live system overview \u2014 data flow, module health, and your next steps."}),e(we,{error:b})):e("div",{class:"space-y-6 animate-page-enter"},e(ie,{page:"HOME",subtitle:"Live system overview \u2014 data flow, module health, and your next steps."}),e(Fe,{value:i?i.current_stage:"starting",label:"pipeline stage",delta:M?`Day ${M.days_of_data} \xB7 ${M.phase}`:null}),e(kv,{maturity:M,shadowStage:k}),e(Sv,{activity:a,intraday:_}),e(wv,{moduleStatuses:s?.modules||{},cacheData:S,feedbackHealth:f}))}function To({items:t}){return!t||t.length===0?null:e("div",{class:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3"},t.map((a,r)=>e("div",{key:r,class:"t-frame",style:`padding: 12px 16px;${a.warning?" border-left: 3px solid var(--status-warning);":""}`},e("div",{class:"data-mono",style:`font-size: var(--type-data); font-weight: 600; color: ${a.warning?"var(--status-warning)":"var(--accent)"};`},a.value),e("div",{class:"t-bracket",style:"margin-top: 4px;"},a.label),a.subtitle&&e("div",{class:"text-xs",style:"color: var(--text-tertiary); margin-top: 2px;"},a.subtitle))))}function Mo(t,a,r=200){let[s,n]=N(""),[o,l]=N(""),i=$t(null);le(()=>(i.current!=null&&clearTimeout(i.current),i.current=setTimeout(()=>{l(s)},r),()=>{i.current!=null&&clearTimeout(i.current)}),[s,r]);let u=Oe(()=>{if(!t||!Array.isArray(t))return[];if(!o||!a||a.length===0)return t;let d=o.toLowerCase();return t.filter(y=>a.some(f=>{let m=y[f];return m==null?!1:String(m).toLowerCase().includes(d)}))},[t,o,a]);return{searchTerm:s,setSearchTerm:n,filteredData:u}}function Eo(t,a=50){let[r,s]=N(0),n=t?t.length:0;le(()=>{s(0)},[n]);let o=Math.max(1,Math.ceil(n/a)),l=Oe(()=>{if(!t||t.length===0)return[];let f=r*a;return t.slice(f,f+a)},[t,r,a]),i=n===0?0:r*a+1,u=Math.min((r+1)*a,n);function d(){s(f=>Math.min(f+1,o-1))}function y(){s(f=>Math.max(f-1,0))}return{page:r,pageData:l,nextPage:d,prevPage:y,totalPages:o,total:n,startIndex:i,endIndex:u}}function Bs({columns:t,data:a,searchFields:r=[],pageSize:s=50,searchPlaceholder:n="Search...",filterContent:o}){let l=a||[],{searchTerm:i,setSearchTerm:u,filteredData:d}=Mo(l,r),[y,f]=N({key:null,direction:"asc"});function m(I){f(j=>j.key===I?{key:I,direction:j.direction==="asc"?"desc":"asc"}:{key:I,direction:"asc"})}let b=Oe(()=>y.key?[...d].sort((I,j)=>{let B=I[y.key],L=j[y.key];if(B==null&&L==null)return 0;if(B==null)return 1;if(L==null)return-1;let q;return typeof B=="number"&&typeof L=="number"?q=B-L:q=String(B).localeCompare(String(L),void 0,{numeric:!0,sensitivity:"base"}),y.direction==="asc"?q:-q}):d,[d,y.key,y.direction]),{pageData:h,nextPage:C,prevPage:A,totalPages:M,total:_,startIndex:k,endIndex:S,page:O}=Eo(b,s),$=O>0,H=O<M-1;return e("div",{class:"t-card",style:"overflow: hidden;"},e("div",{class:"px-4 py-3",style:"border-bottom: 1px solid var(--border-subtle);"},e("div",{class:"flex flex-col sm:flex-row sm:items-center gap-3"},e("div",{class:"relative flex-1 max-w-sm"},e("input",{type:"text",value:i,onInput:I=>u(I.target.value),placeholder:n,class:"t-input w-full px-3 py-1.5 text-sm"}),i&&e("span",{class:"absolute right-2 top-1/2 -translate-y-1/2 text-xs",style:"color: var(--text-tertiary);"},d.length," / ",l.length))),o&&e("div",{class:"mt-3"},o)),e("div",{class:"overflow-x-auto"},e("table",{class:"w-full"},e("thead",null,e("tr",{style:"background: var(--bg-surface-raised);"},t.map(I=>e("th",{key:I.key,class:`px-4 py-2 text-left ${I.sortable?"cursor-pointer select-none":""} ${I.className||""}`,style:"color: var(--text-tertiary); font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.05em; font-weight: 500;",onClick:I.sortable?()=>m(I.key):void 0},e("span",{class:"inline-flex items-center gap-1"},I.label,I.sortable&&e(Av,{active:y.key===I.key,direction:y.direction})))))),e("tbody",null,h.length===0?e("tr",null,e("td",{colSpan:t.length,class:"px-4 py-12 text-center text-sm",style:"color: var(--text-tertiary);"},l.length===0?"No data available":"No results match your filters")):h.map((I,j)=>e("tr",{key:I.id||I.entity_id||j,style:"border-bottom: 1px solid var(--border-subtle);"},t.map(B=>e("td",{key:B.key,class:`px-4 py-2 text-sm ${B.className||""}`,style:"color: var(--text-secondary);"},B.render?B.render(I[B.key],I):I[B.key]!=null?I[B.key]:"\u2014"))))))),_>0&&e("div",{class:"px-4 py-3 flex items-center justify-between",style:"border-top: 1px solid var(--border-subtle);"},e("span",{class:"text-sm",style:"color: var(--text-tertiary);"},"Showing ",k,"\\u2013",S," of ",_),e("div",{class:"flex gap-2"},e("button",{onClick:A,disabled:!$,class:"px-3 py-1 text-sm disabled:opacity-50 disabled:cursor-not-allowed",style:"color: var(--text-secondary); background: var(--bg-surface-raised); border: 1px solid var(--border-primary); border-radius: var(--radius);"},"Previous"),e("button",{onClick:C,disabled:!H,class:"px-3 py-1 text-sm disabled:opacity-50 disabled:cursor-not-allowed",style:"color: var(--text-secondary); background: var(--bg-surface-raised); border: 1px solid var(--border-primary); border-radius: var(--radius);"},"Next"))))}function Av({active:t,direction:a}){return t?a==="asc"?e("svg",{class:"w-3 h-3",style:"color: var(--text-primary);",viewBox:"0 0 12 12",fill:"currentColor"},e("path",{d:"M6 2l3 4H3z"})):e("svg",{class:"w-3 h-3",style:"color: var(--text-primary);",viewBox:"0 0 12 12",fill:"currentColor"},e("path",{d:"M6 10l-3-4h6z"})):e("svg",{class:"w-3 h-3",style:"color: var(--text-tertiary);",viewBox:"0 0 12 12",fill:"currentColor"},e("path",{d:"M6 2l3 4H3z"}),e("path",{d:"M6 10l-3-4h6z"}))}function Po({data:t,total:a}){if(!t||t.length===0)return null;let r=t[0]?.count||1;return e("div",{class:"space-y-2"},t.map(s=>{let n=a>0?(s.count/a*100).toFixed(1):0,o=r>0?s.count/r*100:0;return e("div",{key:s.domain,class:"flex items-center gap-2"},e("span",{class:"w-28 text-sm text-right truncate",style:"color: var(--text-secondary);",title:s.domain},s.domain),e("div",{class:"flex-1 h-6 overflow-hidden",style:"background: var(--bg-inset); border-radius: var(--radius);"},e("div",{class:"h-full transition-all",style:`background: var(--accent); border-radius: var(--radius); width: ${o}%;`})),e("span",{class:"w-20 text-sm data-mono",style:"color: var(--text-tertiary);"},s.count," (",n,"%)"))}))}function Jr({state:t}){let a=(t||"").toLowerCase(),r;return a==="on"||a==="home"?r="t-status-healthy":a==="unavailable"||a==="unknown"?r="t-status-error":t!=null&&t!==""&&!isNaN(Number(t))?r="t-status-healthy":r="t-status-waiting",e("span",{class:`t-status ${r}`},e("span",{style:"display: inline-block; width: 5px; height: 5px; border-radius: 50%; background: currentColor;"}),t)}var js={};function $o(t,a){if(t.area_id)return t.area_id;if(t.device_id){let r=a[t.device_id];if(r&&r.area_id)return r.area_id}return null}function Lo(){let t=He("entities"),a=He("devices"),r=He("areas"),s=He("capabilities"),[n,o]=N(""),[l,i]=N(""),[u,d]=N(""),y=t.loading||a.loading||r.loading||s.loading,f=t.error||a.error||r.error||s.error,m=t.data?.data||js,b=a.data?.data||js,h=r.data?.data||js,C=s.data?.data||js,A=fe(()=>Object.entries(m).map(([E,P])=>({entity_id:E,...P})),[m]),M=fe(()=>{let E=A.filter(se=>se.state==="unavailable"),P=E.length,re=Date.now(),_e=E.filter(se=>{if(!se.last_changed)return!1;let ye=new Date(se.last_changed).getTime();return re-ye>1440*60*1e3}).length;return{total:P,longUnavailable:_e}},[A]),_=M.total,k=fe(()=>t.data?[{label:"Entities",value:A.length.toLocaleString()},{label:"Devices",value:Object.keys(b).length.toLocaleString()},{label:"Areas",value:Object.keys(h).length.toLocaleString()},{label:"Capabilities",value:Object.keys(C).length.toLocaleString()},{label:"Unavailable",value:_,subtitle:M.longUnavailable>0?`${M.longUnavailable} > 24h`:void 0,warning:_>100}]:null,[t.data,A,b,h,C,_,M]),S=fe(()=>{let E={};for(let P of A){let re=P.domain||P.entity_id?.split(".")[0]||"unknown";E[re]=(E[re]||0)+1}return Object.entries(E).map(([P,re])=>({domain:P,count:re})).sort((P,re)=>re.count-P.count)},[A]),O=fe(()=>{let E={};for(let P of A){let re=$o(P,b);re&&(E[re]=(E[re]||0)+1)}return Object.entries(h).map(([P,re])=>({area_id:P,name:re.name||P,count:E[P]||0})).sort((P,re)=>re.count-P.count)},[A,h,b]),$=fe(()=>[...new Set(A.map(P=>P.domain||P.entity_id?.split(".")[0]))].sort(),[A]),H=fe(()=>[...new Set(A.map(P=>P.state).filter(Boolean))].sort(),[A]),I=fe(()=>Object.entries(h).map(([E,P])=>({id:E,name:P.name||E})).sort((E,P)=>E.name.localeCompare(P.name)),[h]),j=Oe(()=>{let E=A;return n&&(E=E.filter(P=>(P.domain||P.entity_id?.split(".")[0])===n)),l&&(E=E.filter(P=>P.state===l)),u&&(E=E.filter(P=>$o(P,b)===u)),E},[A,n,l,u,b]),B=[{key:"friendly_name",label:"Entity",sortable:!0,render:(E,P)=>e("div",null,e("div",{class:"font-semibold",style:"color: var(--text-primary)"},P.friendly_name||P.entity_id),e("div",{class:"text-xs data-mono",style:"color: var(--text-tertiary)"},P.entity_id))},{key:"state",label:"State",sortable:!0,render:(E,P)=>e("span",{class:"inline-flex items-center gap-1"},e(Jr,{state:E}),P.unit_of_measurement&&e("span",{class:"text-xs",style:"color: var(--text-tertiary)"},P.unit_of_measurement))},{key:"domain",label:"Domain",sortable:!0,render:(E,P)=>{let re=E||P.entity_id?.split(".")[0]||"\u2014";return e("span",{class:"inline-block px-2 py-0.5 text-xs font-medium",style:"background: var(--bg-inset); color: var(--text-primary); border-radius: var(--radius);"},re)}},{key:"device_class",label:"Class",sortable:!0,render:E=>E||"\u2014"},{key:"area_id",label:"Area",sortable:!0,render:(E,P)=>{let re=$o(P,b);if(!re)return"\u2014";let _e=h[re];return _e?_e.name:re}},{key:"device_id",label:"Device",sortable:!0,render:E=>{if(!E)return"\u2014";let P=b[E];return P?P.name:E}}],L=fe(()=>Object.entries(b).map(([E,P])=>({device_id:E,...P,area_name:P.area_id&&h[P.area_id]?h[P.area_id].name:P.area_id||"\u2014"})),[b,h]),q=[{key:"name",label:"Name",sortable:!0,render:(E,P)=>e("div",null,e("div",{class:"font-semibold",style:"color: var(--text-primary)"},E||P.device_id),e("div",{class:"text-xs data-mono",style:"color: var(--text-tertiary)"},P.device_id))},{key:"manufacturer",label:"Manufacturer",sortable:!0,render:E=>E||"\u2014"},{key:"model",label:"Model",sortable:!0,render:E=>E||"\u2014"},{key:"area_name",label:"Area",sortable:!0,render:E=>E||"\u2014"}],G=e("div",{class:"flex flex-wrap gap-3"},e("select",{value:n,onChange:E=>o(E.target.value),class:"t-input px-2 py-1.5 text-sm"},e("option",{value:""},"All domains"),$.map(E=>e("option",{key:E,value:E},E))),e("select",{value:l,onChange:E=>i(E.target.value),class:"t-input px-2 py-1.5 text-sm"},e("option",{value:""},"All states"),e("option",{value:"on"},"on"),e("option",{value:"off"},"off"),e("option",{value:"unavailable"},"unavailable"),H.filter(E=>E!=="on"&&E!=="off"&&E!=="unavailable").map(E=>e("option",{key:E,value:E},E))),e("select",{value:u,onChange:E=>d(E.target.value),class:"t-input px-2 py-1.5 text-sm"},e("option",{value:""},"All areas"),I.map(E=>e("option",{key:E.id,value:E.id},E.name))),(n||l||u)&&e("button",{onClick:()=>{o(""),i(""),d("")},class:"px-2 py-1.5 text-sm",style:"color: var(--accent);"},"Clear filters")),Z="Everything the hub found by scanning your Home Assistant instance. Rescans automatically every 24 hours.";if(y&&!t.data)return e("div",{class:"space-y-6"},e("div",null,e("h1",{class:"text-2xl font-bold",style:"color: var(--text-primary)"},"Discovery"),e("p",{class:"text-sm",style:"color: var(--text-tertiary)"},Z)),e(Se,{type:"full"}));if(f)return e("div",{class:"space-y-6"},e("div",null,e("h1",{class:"text-2xl font-bold",style:"color: var(--text-primary)"},"Discovery"),e("p",{class:"text-sm",style:"color: var(--text-tertiary)"},Z)),e(we,{error:f,onRetry:()=>{t.refetch(),a.refetch(),r.refetch(),s.refetch()}}));let Y=Object.keys(h).length;return e("div",{class:"space-y-6 animate-page-enter"},e(ie,{page:"DISCOVERY",subtitle:"Every entity, device, and area in your home."}),e(Fe,{value:A.length.toLocaleString(),label:"entities discovered",delta:`across ${Y} area${Y!==1?"s":""}`,loading:y}),k?e(To,{items:k}):e(Se,{type:"stats"}),e("section",null,e("div",{class:"t-section-header mb-4",style:"padding-bottom: 6px;"},e("h2",{class:"text-lg font-semibold",style:"color: var(--text-primary)"},"Domain Breakdown"),e("p",{class:"text-sm",style:"color: var(--text-tertiary)"},"How your entities are distributed across HA domains. Larger bars = more entities in that domain.")),e("div",{class:"t-frame","data-label":"domains",style:"padding: 1rem;"},e(Po,{data:S,total:A.length}))),O.length>0&&e("section",null,e("div",{class:"t-section-header mb-4",style:"padding-bottom: 6px;"},e("h2",{class:"text-lg font-semibold",style:"color: var(--text-primary)"},"Areas"),e("p",{class:"text-sm",style:"color: var(--text-tertiary)"},"Physical locations defined in Home Assistant, with entity counts per area.")),e("div",{class:"grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-4 gap-4"},O.map(E=>e("div",{key:E.area_id,class:"t-frame","data-label":E.name,style:"padding: 1rem;"},e("div",{class:"font-semibold text-sm truncate",style:"color: var(--text-primary)",title:E.name},E.name),e("div",{class:"text-sm mt-1",style:"color: var(--text-tertiary)"},E.count," entities"))))),e("section",null,e("div",{class:"t-section-header mb-4",style:"padding-bottom: 6px;"},e("h2",{class:"text-lg font-semibold",style:"color: var(--text-primary)"},"Entities"),e("p",{class:"text-sm",style:"color: var(--text-tertiary)"},"Every entity registered in HA \u2014 sensors, switches, lights, and more. Filter by domain, state, or area.")),e(Bs,{columns:B,data:j,searchFields:["entity_id","friendly_name","domain","device_class"],pageSize:50,searchPlaceholder:"Search entities...",filterContent:G})),e("section",null,e("div",{class:"t-section-header mb-4",style:"padding-bottom: 6px;"},e("h2",{class:"text-lg font-semibold",style:"color: var(--text-primary)"},"Devices"),e("p",{class:"text-sm",style:"color: var(--text-tertiary)"},"Physical devices registered in HA. Each device groups multiple entities (e.g., a thermostat has temperature, humidity, and mode entities).")),e(Bs,{columns:q,data:L,searchFields:["name","device_id","manufacturer","model"],pageSize:50,searchPlaceholder:"Search devices..."})))}function vt({title:t,subtitle:a,summary:r,defaultOpen:s=!0,loading:n=!1,children:o}){let[l,i]=N(s),u="cursor-idle";n?u="cursor-working":l&&(u="cursor-active");function d(){n||i(!l)}return e("section",null,e("button",{type:"button",onClick:d,class:`${u} w-full text-left flex items-center justify-between`,style:"padding: 8px 0; cursor: pointer; background: none; border: none; border-bottom: 1px solid var(--border-subtle);","aria-expanded":l,"aria-label":`${l?"Collapse":"Expand"} ${t}`},e("div",{class:"flex-1 min-w-0"},e("h2",{style:"font-size: var(--type-headline); color: var(--text-primary); font-family: var(--font-mono); font-weight: 700;"},t),a&&!l&&r&&e("span",{class:"t-bracket",style:"margin-left: 8px;"},r),a&&l&&e("p",{style:"font-size: var(--type-label); color: var(--text-tertiary); margin-top: 2px;"},a))),l&&e("div",{class:"animate-page-enter",style:"padding-top: 12px;"},o))}function Zr({value:t,label:a,sublabel:r}){let s=Math.max(0,Math.min(100,t||0)),n=s>=70?"var(--status-healthy)":s>=40?"var(--status-warning)":"var(--status-error)";return e("div",{class:"space-y-1"},e("div",{class:"flex items-center justify-between"},e("span",{style:"font-size: var(--type-label); color: var(--text-secondary); font-family: var(--font-mono);"},a),e("span",{style:"font-size: var(--type-label); font-family: var(--font-mono);"},r&&e("span",{style:"color: var(--text-tertiary); margin-right: 6px;"},r),e("span",{style:`color: ${n};`},Math.round(s),"%"))),e("div",{style:"height: 6px; border-radius: 3px; background: var(--bg-inset); overflow: hidden;"},e("div",{style:`height: 100%; width: ${s}%; background: ${n}; border-radius: 3px; transition: width 0.3s ease;`})))}function id(t){if(!t)return"\u2014";try{return new Date(t).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}catch{return t}}function Do({name:t,capability:a,onAction:r}){let[s,n]=N(!1),[o,l]=N(null),i=a.usefulness_components||{},u=a.entities||[],d=a.temporal_pattern||{},y=a.status||"promoted",f=[{key:"predictability",label:"Predictability"},{key:"stability",label:"Stability"},{key:"coverage",label:"Coverage"},{key:"activity",label:"Activity"},{key:"cohesion",label:"Cohesion"}],m=[{key:"description",label:"Description"},{key:"source",label:"Source"},{key:"layer",label:"Layer"},{key:"naming_method",label:"Naming"},{key:"first_seen",label:"First seen",format:id},{key:"promoted_at",label:"Promoted",format:id}];async function b(A){l(A);try{await fa(`/api/capabilities/${t}/${A}`),r&&r()}catch(M){console.error(`Failed to ${A} capability:`,M)}finally{l(null)}}let h=s?u:u.slice(0,5),C=u.length>5;return e("div",{class:"space-y-4",style:"padding-top: 12px; border-top: 1px solid var(--border-subtle);"},Object.keys(i).length>0&&e("div",{class:"space-y-2"},e("span",{style:"font-size: var(--type-label); color: var(--text-tertiary); font-family: var(--font-mono); text-transform: uppercase;"},"Usefulness breakdown"),f.map(({key:A,label:M})=>i[A]!=null?e(Zr,{key:A,value:i[A],label:M}):null)),e("div",{class:"space-y-1"},m.map(({key:A,label:M,format:_})=>{let k=a[A];if(k==null)return null;let S=_?_(k):String(k);return e("div",{key:A,class:"flex justify-between",style:"font-size: var(--type-label); font-family: var(--font-mono);"},e("span",{style:"color: var(--text-tertiary);"},M),e("span",{style:"color: var(--text-secondary);"},S))})),(d.peak_hours||d.weekday_bias)&&e("div",{class:"space-y-1"},e("span",{style:"font-size: var(--type-label); color: var(--text-tertiary); font-family: var(--font-mono); text-transform: uppercase;"},"Temporal pattern"),d.peak_hours&&e("div",{class:"flex justify-between",style:"font-size: var(--type-label); font-family: var(--font-mono);"},e("span",{style:"color: var(--text-tertiary);"},"Peak hours"),e("span",{style:"color: var(--text-secondary);"},Array.isArray(d.peak_hours)?d.peak_hours.join(", "):String(d.peak_hours))),d.weekday_bias&&e("div",{class:"flex justify-between",style:"font-size: var(--type-label); font-family: var(--font-mono);"},e("span",{style:"color: var(--text-tertiary);"},"Weekday bias"),e("span",{style:"color: var(--text-secondary);"},String(d.weekday_bias)))),u.length>0&&e("div",null,e("span",{style:"font-size: var(--type-label); color: var(--text-tertiary); font-family: var(--font-mono); text-transform: uppercase;"},"Entities (",u.length,")"),e("ul",{class:"space-y-0.5",style:"margin-top: 4px;"},h.map(A=>e("li",{key:A,class:"truncate data-mono",style:"font-size: var(--type-label); color: var(--text-tertiary);"},A))),C&&e("button",{onClick:()=>n(!s),class:"cursor-pointer",style:"font-size: var(--type-label); color: var(--accent); background: none; border: none; padding: 0; margin-top: 4px; font-family: var(--font-mono);"},s?"Show less":`Show all ${u.length}`)),e("div",{class:"flex gap-2",style:"padding-top: 8px;"},y!=="promoted"&&e("button",{onClick:()=>b("promote"),disabled:o!==null,class:"cursor-pointer",style:`font-size: var(--type-label); font-family: var(--font-mono); padding: 4px 12px; border: 1px solid var(--status-healthy); color: var(--status-healthy); background: var(--status-healthy-glow); border-radius: 4px; opacity: ${o?"0.5":"1"};`},o==="promote"?"Promoting...":"Promote"),y!=="archived"&&e("button",{onClick:()=>b("archive"),disabled:o!==null,class:"cursor-pointer",style:`font-size: var(--type-label); font-family: var(--font-mono); padding: 4px 12px; border: 1px solid var(--text-tertiary); color: var(--text-tertiary); background: none; border-radius: 4px; opacity: ${o?"0.5":"1"};`},o==="archive"?"Archiving...":"Archive")))}function cd(t){let a=(t||"").replace(/_/g," ");return a.charAt(0).toUpperCase()+a.slice(1)}var Cv={power_monitoring:{why:"Power usage follows daily patterns \u2014 morning coffee, evening TV, overnight baseline. ARIA learns your typical wattage curves and flags unusual spikes or drops.",on:"ARIA will predict your expected power draw and alert when it deviates.",off:"Power predictions disabled. ARIA will still track power but won't flag anomalies."},lighting:{why:"Lights follow routines \u2014 on at sunset, off at bedtime. ARIA learns which lights are typically on at what time of day.",on:"ARIA will predict which lights should be on and notice unexpected changes.",off:"Light predictions disabled. ARIA will still count lights but won't predict patterns."},occupancy:{why:"Presence follows your schedule \u2014 leave for work, come home in the evening. ARIA learns your typical comings and goings.",on:"ARIA will predict when you're likely home and notice unexpected absences or arrivals.",off:"Occupancy predictions disabled. ARIA will still track presence but won't predict it."},climate:{why:"Thermostats follow schedules and seasons. ARIA learns your comfort patterns and heating/cooling cycles.",on:"ARIA will predict temperature trends and notice when climate behavior changes.",off:"Climate predictions disabled. ARIA will still monitor temperature data."},battery_devices:{why:"Batteries drain predictably \u2014 sensors last weeks, tablets last hours. ARIA learns each device's discharge curve.",on:"ARIA will predict when batteries need charging and flag unusual drain.",off:"Battery predictions disabled. Levels are still tracked."},motion:{why:"Motion sensors are inherently reactive \u2014 they fire when someone walks by. Individual triggers are hard to predict, but daily patterns (busy mornings, quiet nights) can be learned.",on:"ARIA will learn your typical motion patterns and flag unusual quiet or busy periods.",off:"Motion predictions off. This is the default because individual motion events are noisy."},doors_windows:{why:"Door and window sensors track openings. Some follow routines (garage door at 8am), others are random (bathroom door). Predictions work best when you have consistent habits.",on:"ARIA will learn your door/window patterns and notice unusual activity.",off:"Door/window predictions off. This is the default because contact events vary widely."},locks:{why:"Smart locks often follow routines \u2014 lock at bedtime, unlock in the morning. If your lock usage is consistent, predictions can spot when something breaks the pattern.",on:"ARIA will learn your locking patterns and notice when they change.",off:"Lock predictions off. This is the default because lock events are security-sensitive."},media:{why:"Media playback depends on mood, not schedule. But if you have routines (morning news, bedtime podcast), ARIA can learn those patterns.",on:"ARIA will learn your media habits and predict typical playback times.",off:"Media predictions off. This is the default because playback is usually on-demand."},vacuum:{why:"Robot vacuums usually run on their own schedule, set in the robot's app. ARIA can learn when cleaning typically happens.",on:"ARIA will learn your vacuum schedule and notice missed or extra runs.",off:"Vacuum predictions off. Most vacuums have their own scheduling."}},Tv={why:"ARIA can attempt to learn patterns for this capability based on your historical data.",on:"Predictions enabled \u2014 ARIA will look for patterns.",off:"Predictions disabled \u2014 ARIA will still track data but won't predict."};function Mv({name:t,canPredict:a,onToggle:r}){let[s,n]=N(!1),[o,l]=N(!1),i=Cv[t]||Tv;async function u(){n(!0);try{await r(t,!a)}finally{n(!1)}}return e("div",{class:"space-y-2"},e("div",{class:"flex items-center justify-between"},e("div",{class:"flex items-center gap-2"},e("span",{class:"text-sm font-medium",style:"color: var(--text-secondary)"},"Predictions"),e("button",{onClick:()=>l(!o),class:"text-xs cursor-pointer",style:"color: var(--accent); background: none; border: none; padding: 0;",title:"Why?"},o?"hide":"why?")),e("button",{onClick:u,disabled:s,class:"relative inline-flex items-center h-6 w-11 rounded-full cursor-pointer transition-colors",style:`background: ${a?"var(--accent)":"var(--bg-inset)"}; border: 2px solid ${a?"var(--accent)":"var(--border-subtle)"}; opacity: ${s?"0.5":"1"};`,title:a?"Click to disable predictions":"Click to enable predictions"},e("span",{class:"inline-block h-4 w-4 rounded-full transition-transform",style:`background: ${a?"var(--bg-base)":"var(--text-tertiary)"}; transform: translateX(${a?"20px":"2px"});`}))),e("p",{class:"text-xs",style:`color: ${a?"var(--status-healthy)":"var(--text-tertiary)"}`},a?i.on:i.off),o&&e("div",{class:"t-callout p-2 text-xs",style:"color: var(--text-secondary); line-height: 1.5;"},i.why))}function Ro({name:t,capability:a,onTogglePredict:r,onAction:s}){let[n,o]=N(!1),l=a.entities||[],i=a.entity_count||l.length,u=a.can_predict??!1,d=a.usefulness??null,y=a.source||null,f=a.layer||null,m=a.status||"promoted",b=a.stability_streak??null;return e("div",{class:"t-frame","data-label":cd(t),style:"padding: 1rem; cursor: pointer;",onClick:()=>o(!n)},e("div",{class:"flex items-center justify-between mb-2",style:"flex-wrap: wrap; gap: 4px;"},e("h3",{class:"text-base font-bold",style:"color: var(--text-primary); margin: 0;"},cd(t)),e("div",{class:"flex items-center gap-1",style:"flex-wrap: wrap;"},e("span",{class:"inline-block px-2 py-0.5 rounded-full text-xs font-medium",style:"background: var(--accent-glow); color: var(--accent); white-space: nowrap;"},i," ",i===1?"entity":"entities"),y&&e("span",{class:"inline-block px-2 py-0.5 rounded-full text-xs font-medium",style:`white-space: nowrap; ${y==="organic"?"background: var(--status-healthy-glow); color: var(--status-healthy);":"background: var(--bg-surface-raised); color: var(--text-tertiary);"}`},y),f&&e("span",{class:"inline-block px-2 py-0.5 rounded-full text-xs font-medium",style:`white-space: nowrap; ${f==="behavioral"?"background: color-mix(in srgb, var(--accent-purple) 15%, transparent); color: var(--accent-purple);":"background: var(--bg-surface-raised); color: var(--text-secondary);"}`},f))),d!=null&&e("div",{style:"margin-bottom: 8px;"},e(Zr,{value:d,label:"Usefulness"})),m==="candidate"&&b!=null&&e("div",{style:"font-size: var(--type-label); color: var(--text-tertiary); font-family: var(--font-mono); margin-bottom: 8px;"},"Stability streak: ",e("span",{style:`color: ${b>=7?"var(--status-healthy)":"var(--text-secondary)"};`},b,"d")),m==="promoted"&&e("div",{class:"mb-2 pb-2",style:"border-bottom: 1px solid var(--border-subtle);",onClick:h=>h.stopPropagation()},e(Mv,{name:t,canPredict:u,onToggle:r})),n&&e("div",{onClick:h=>h.stopPropagation()},e(Do,{name:t,capability:a,onAction:s})))}function Ev({data:t}){if(!t)return null;let a=t.discovery_metadata||t.metadata||{},r=a.last_organic_run||a.last_run||null,s=a.autonomy_mode||null,n=a.naming_backend||null;return!r&&!s&&!n?null:e("div",{class:"t-frame","data-label":"Discovery",style:"padding: 0.75rem;"},e("div",{class:"flex items-center gap-4",style:"flex-wrap: wrap; font-size: var(--type-label); font-family: var(--font-mono);"},r&&e("span",{style:"color: var(--text-secondary);"},"Last run: ",e("span",{style:"color: var(--text-primary);"},Pv(r))),s&&e("span",{style:"color: var(--text-secondary);"},"Mode: ",e("span",{style:"color: var(--accent);"},s)),n&&e("span",{style:"color: var(--text-secondary);"},"Naming: ",e("span",{style:"color: var(--text-primary);"},n))))}function Pv(t){if(!t)return"\u2014";try{let a=new Date(t),s=new Date-a,n=Math.floor(s/6e4);if(n<1)return"just now";if(n<60)return`${n}m ago`;let o=Math.floor(n/60);return o<24?`${o}h ago`:a.toLocaleDateString(void 0,{month:"short",day:"numeric"})}catch{return t}}function dd(t){switch(t){case"stable":return"var(--status-healthy)";case"experimental":return"var(--status-warning)";case"planned":return"var(--text-tertiary)";default:return"var(--text-secondary)"}}function ud(t){switch(t){case"stable":return"var(--status-healthy-glow)";case"experimental":return"var(--status-warning-glow)";case"planned":return"var(--bg-surface-raised)";default:return"var(--bg-surface-raised)"}}function pd(t){switch(t){case"hub":return"var(--accent)";case"engine":return"var(--accent-purple)";case"dashboard":return"var(--status-warning)";default:return"var(--text-secondary)"}}function $v(){let[t,a]=N(null),[r,s]=N(!0),[n,o]=N(null);if(le(()=>{de("/api/capabilities/registry").then(d=>{a(d),s(!1)}).catch(d=>{o(d.message),s(!1)})},[]),r)return e(vt,{title:"System Registry",subtitle:"Code-declared capability inventory for regression tracking.",summary:"Loading...",defaultOpen:!1},e(Se,{type:"table"}));if(n)return e(vt,{title:"System Registry",subtitle:"Code-declared capability inventory for regression tracking.",summary:"Error",defaultOpen:!1},e("div",{class:"t-callout p-3 text-sm",style:"color: var(--status-error);"},n));if(!t)return null;let l=t.capabilities||[],i=t.by_layer||{},u=t.by_status||{};return e(vt,{title:"System Registry",subtitle:"Code-declared capability inventory for regression tracking.",summary:`${t.total} capabilities`,defaultOpen:!1},e("div",{class:"flex flex-wrap gap-2 mb-4"},Object.entries(i).map(([d,y])=>e("span",{key:d,class:"inline-block px-2 py-1 rounded text-xs font-medium",style:`color: ${pd(d)}; background: var(--bg-surface-raised); font-family: var(--font-mono);`},d,": ",y)),e("span",{style:"color: var(--border-subtle);"},"|"),Object.entries(u).map(([d,y])=>e("span",{key:d,class:"inline-block px-2 py-1 rounded text-xs font-medium",style:`color: ${dd(d)}; background: ${ud(d)};`},d,": ",y))),e("div",{style:"overflow-x: auto;"},e("table",{style:"width: 100%; border-collapse: collapse; font-size: var(--type-body);"},e("thead",null,e("tr",{style:"border-bottom: 1px solid var(--border-subtle);"},e("th",{style:"text-align: left; padding: 8px 12px; color: var(--text-tertiary); font-weight: 600; font-size: var(--type-label);"},"ID"),e("th",{style:"text-align: left; padding: 8px 12px; color: var(--text-tertiary); font-weight: 600; font-size: var(--type-label);"},"Name"),e("th",{style:"text-align: left; padding: 8px 12px; color: var(--text-tertiary); font-weight: 600; font-size: var(--type-label);"},"Layer"),e("th",{style:"text-align: left; padding: 8px 12px; color: var(--text-tertiary); font-weight: 600; font-size: var(--type-label);"},"Status"),e("th",{style:"text-align: right; padding: 8px 12px; color: var(--text-tertiary); font-weight: 600; font-size: var(--type-label);"},"Tests"),e("th",{style:"text-align: right; padding: 8px 12px; color: var(--text-tertiary); font-weight: 600; font-size: var(--type-label);"},"Config"),e("th",{style:"text-align: left; padding: 8px 12px; color: var(--text-tertiary); font-weight: 600; font-size: var(--type-label);"},"Deps"))),e("tbody",null,l.map(d=>e("tr",{key:d.id,style:"border-bottom: 1px solid var(--border-subtle);"},e("td",{style:"padding: 8px 12px; font-family: var(--font-mono); color: var(--text-primary);"},d.id),e("td",{style:"padding: 8px 12px; color: var(--text-secondary);"},d.name),e("td",{style:"padding: 8px 12px;"},e("span",{class:"inline-block px-1.5 py-0.5 rounded text-xs",style:`color: ${pd(d.layer)}; background: var(--bg-surface-raised);`},d.layer)),e("td",{style:"padding: 8px 12px;"},e("span",{class:"inline-block px-1.5 py-0.5 rounded text-xs",style:`color: ${dd(d.status)}; background: ${ud(d.status)};`},d.status)),e("td",{style:"padding: 8px 12px; text-align: right; font-family: var(--font-mono); color: var(--text-secondary);"},(d.test_paths||[]).length),e("td",{style:"padding: 8px 12px; text-align: right; font-family: var(--font-mono); color: var(--text-secondary);"},(d.config_keys||[]).length),e("td",{style:"padding: 8px 12px; font-family: var(--font-mono); font-size: var(--type-label); color: var(--text-tertiary);"},(d.depends_on||[]).length>0?d.depends_on.join(", "):"\u2014")))))))}function Io(){let{data:t,loading:a,error:r,refetch:s}=He("capabilities"),n=fe(()=>{if(!t||!t.data)return[];let m=t.data;return Object.entries(m).map(([b,h])=>({name:b,...h}))},[t]),o=fe(()=>n.filter(m=>m.status==="promoted"||!m.status),[n]),l=fe(()=>n.filter(m=>m.status==="candidate"),[n]),i=fe(()=>n.filter(m=>m.status==="archived"),[n]),u=fe(()=>n.reduce((m,b)=>m+(b.entity_count||(b.entities||[]).length),0),[n]);async function d(m,b){try{await fa(`/api/capabilities/${m}/can-predict`,{can_predict:b}),s()}catch(h){console.error("Failed to toggle can_predict:",h)}}function y(){s()}let f=`${o.length} promoted \xB7 ${l.length} candidate${l.length!==1?"s":""} \xB7 ${u} entities`;return a&&!t?e("div",{class:"space-y-6"},e(ie,{page:"CAPABILITIES",subtitle:"Detected home capabilities and features."}),e(Se,{type:"cards"})):r?e("div",{class:"space-y-6"},e(ie,{page:"CAPABILITIES",subtitle:"Detected home capabilities and features."}),e(we,{error:r,onRetry:s})):e("div",{class:"space-y-6 animate-page-enter"},e(ie,{page:"CAPABILITIES",subtitle:"Detected home capabilities and features."}),e(Fe,{value:n.length,label:"capabilities",delta:f,loading:a}),e(Ev,{data:t}),e("div",{class:"t-callout p-3 text-sm",style:"color: var(--text-secondary); line-height: 1.5;"},"ARIA automatically detects what your home can do by scanning your entities. Each capability can be toggled for ",e("strong",{style:"color: var(--text-primary)"},"predictions")," \u2014 when enabled, ARIA learns the patterns for that capability and flags when something changes. Organic discovery finds new groupings automatically; candidates are promoted once they prove stable."),n.length===0?e("div",{class:"t-callout",style:"padding: 0.75rem;"},e("span",{class:"text-sm",style:"color: var(--text-secondary)"},"No capabilities detected yet. Capabilities are identified during discovery by matching entity domains and device classes. They appear after the first successful discovery scan.")):e("div",{class:"space-y-6"},o.length>0&&e(vt,{title:"Promoted",subtitle:"Active capabilities tracked by ARIA.",summary:`${o.length} capabilities`,defaultOpen:!0,loading:a},e("div",{class:"grid grid-cols-1 lg:grid-cols-2 gap-4 stagger-children"},o.map(m=>e(Ro,{key:m.name,name:m.name,capability:m,onTogglePredict:d,onAction:y})))),l.length>0&&e(vt,{title:"Candidates",subtitle:"Organically discovered capabilities awaiting promotion.",summary:`${l.length} candidates`,defaultOpen:!0,loading:a},e("div",{class:"grid grid-cols-1 lg:grid-cols-2 gap-4 stagger-children"},l.map(m=>e(Ro,{key:m.name,name:m.name,capability:m,onTogglePredict:d,onAction:y})))),i.length>0&&e(vt,{title:"Archived",subtitle:"Capabilities removed from active tracking.",summary:`${i.length} archived`,defaultOpen:!1,loading:a},e("div",{class:"grid grid-cols-1 lg:grid-cols-2 gap-4 stagger-children"},i.map(m=>e(Ro,{key:m.name,name:m.name,capability:m,onTogglePredict:d,onAction:y}))))),e($v,null))}function fd(t){return t>=70?"color: var(--status-healthy)":t>=40?"color: var(--status-warning)":"color: var(--status-error)"}function Us(t){return t>=.7?"background: var(--status-healthy-glow); color: var(--status-healthy);":t>=.4?"background: var(--status-warning-glow); color: var(--status-warning);":"background: var(--status-error-glow); color: var(--status-error);"}var Ws=20,Vs=100,vd=20,md=10,yd=360*60*1e3,gd=3600*1e3;var No=["collecting","baselines","ml-training","ml-active"],xd=["Collecting","Baselines","ML Training","ML Active"];function Lv({prediction:t}){let[a,r]=N(!1),s=t.confidence??0,n=Math.round(s*100);return e("div",{class:"t-frame","data-label":t.entity_id||t.metric||"prediction",style:"padding: 1rem;"},e("div",{class:"flex items-center justify-between mb-3"},e("h3",{class:"text-sm font-bold truncate mr-2 data-mono",style:"color: var(--text-primary)"},t.entity_id),e("span",{class:"inline-block px-2 py-0.5 rounded-full text-xs font-medium whitespace-nowrap",style:Us(s)},n,"%")),e("div",{class:"flex items-center gap-2 mb-3"},e("span",{class:"text-xs",style:"color: var(--text-tertiary)"},"Predicted:"),e(Jr,{state:String(t.predicted_value??"")}),t.current_value!=null&&e("span",{class:"text-xs ml-2",style:"color: var(--text-tertiary)"},"current: ",t.current_value)),e("div",{class:"mb-3"},e("div",{class:"flex items-center justify-between text-xs mb-1",style:"color: var(--text-tertiary)"},e("span",null,"Confidence"),e("span",null,n,"%")),e("div",{class:"h-2 rounded-full",style:"background: var(--bg-inset)"},e("div",{class:"h-2 rounded-full transition-all",style:`background: var(--accent); width: ${n}%`}))),e("div",{class:"text-xs space-y-0.5",style:"color: var(--text-tertiary)"},t.model&&e("div",null,"Model: ",e("span",{style:"color: var(--text-secondary)"},t.model)),t.prediction_time&&e("div",null,"Time: ",e("span",{style:"color: var(--text-secondary)"},new Date(t.prediction_time).toLocaleString()))),t.features&&e("div",{class:"mt-3"},e("button",{onClick:()=>r(!a),class:"text-sm cursor-pointer",style:"color: var(--accent)"},a?"Hide details":"Show details"),a&&e("pre",{class:"mt-2 p-3 text-xs overflow-x-auto",style:"background: var(--bg-inset); color: var(--text-primary); border-radius: var(--radius); font-family: var(--font-mono)"},JSON.stringify(t.features,null,2))))}function Oo(){let{data:t,loading:a,error:r,refetch:s}=He("ml_predictions"),{metadata:n,predictions:o}=fe(()=>{if(!t||!t.data)return{metadata:null,predictions:[]};let i=t.data;return{metadata:i.metadata||null,predictions:i.predictions||[]}},[t]),l="ML model predictions for individual entity states. Each card shows what the model expects and how confident it is.";return a&&!t?e("div",{class:"space-y-6"},e("div",null,e("h1",{class:"text-2xl font-bold",style:"color: var(--text-primary)"},"Predictions"),e("p",{class:"text-sm",style:"color: var(--text-tertiary)"},l)),e(Se,{type:"cards"})):r?e("div",{class:"space-y-6"},e("div",null,e("h1",{class:"text-2xl font-bold",style:"color: var(--text-primary)"},"Predictions"),e("p",{class:"text-sm",style:"color: var(--text-tertiary)"},l)),e(we,{error:r,onRetry:s})):e("div",{class:"space-y-6 animate-page-enter"},e(ie,{page:"PREDICTIONS",subtitle:"ML model outputs with confidence scores."}),e(Fe,{value:o.length,label:"predictions",delta:o.length>0?`${o.filter(i=>(i.confidence??0)>=.7).length} high confidence`:null,loading:a}),n&&e("div",{class:"flex flex-wrap gap-3 text-sm",style:"color: var(--text-tertiary)"},n.model_version&&e("span",{style:"background: var(--bg-surface-raised); border-radius: var(--radius); padding: 0.25rem 0.5rem;"},"v",n.model_version),n.features_used!=null&&e("span",{style:"background: var(--bg-surface-raised); border-radius: var(--radius); padding: 0.25rem 0.5rem;"},n.features_used," features"),n.generated_at&&e("span",{style:"background: var(--bg-surface-raised); border-radius: var(--radius); padding: 0.25rem 0.5rem;"},"Generated: ",new Date(n.generated_at).toLocaleString())),o.length===0?e("div",{class:"t-callout",style:"padding: 0.75rem;"},e("span",{class:"text-sm",style:"color: var(--text-secondary)"},"No entity-level predictions yet. The ML engine trains models after 14+ days of data, then predicts individual entity states. Until then, aggregate predictions are available on the Intelligence page.")):e("div",{class:"grid grid-cols-1 lg:grid-cols-2 gap-4 stagger-children"},o.map((i,u)=>e(Lv,{key:i.entity_id||u,prediction:i}))))}function Dv(t){switch((t||"").toLowerCase()){case"temporal":return"background: var(--accent-glow); color: var(--accent);";case"correlation":return"background: var(--accent-purple-glow); color: var(--accent-purple);";case"sequence":return"background: var(--status-warning-glow); color: var(--status-warning);";case"anomaly":return"background: var(--status-error-glow); color: var(--status-error);";default:return"background: var(--bg-surface-raised); color: var(--text-secondary);"}}function Rv({pattern:t}){let[a,r]=N(!1),s=t.confidence??0,n=Math.round(s*100),o=t.entities||[];return e("div",{class:"t-frame","data-label":t.name||"pattern",style:"padding: 1.25rem;"},e("div",{class:"flex items-center justify-between mb-2"},e("h3",{class:"text-base font-bold",style:"color: var(--text-primary)"},t.name||"Unnamed pattern"),t.type&&e("span",{class:"inline-block px-2 py-0.5 rounded-full text-xs font-medium",style:Dv(t.type)},t.type)),t.description&&e("p",{class:"text-sm mb-3",style:"color: var(--text-secondary)"},t.description),e("div",{class:"grid grid-cols-2 gap-x-6 gap-y-2 text-sm mb-3"},t.frequency&&e("div",null,e("span",{style:"color: var(--text-tertiary)"},"Frequency"),e("div",{class:"font-medium",style:"color: var(--text-secondary)"},t.frequency)),o.length>0&&e("div",null,e("span",{style:"color: var(--text-tertiary)"},"Entities"),e("div",{class:"font-medium",style:"color: var(--text-secondary)"},o.length)),e("div",null,e("span",{style:"color: var(--text-tertiary)"},"Confidence"),e("div",{class:"font-medium",style:"color: var(--text-secondary)"},n,"%")),t.time_window&&e("div",null,e("span",{style:"color: var(--text-tertiary)"},"Time window"),e("div",{class:"font-medium",style:"color: var(--text-secondary)"},t.time_window)),t.support!=null&&e("div",null,e("span",{style:"color: var(--text-tertiary)"},"Support"),e("div",{class:"font-medium",style:"color: var(--text-secondary)"},Math.round(t.support*100),"%"))),o.length>0&&e("div",{class:"flex flex-wrap gap-1 mb-3"},o.map(l=>e("span",{key:l,class:"inline-block px-1.5 py-0.5 text-xs data-mono",style:"background: var(--bg-surface-raised); border-radius: var(--radius); color: var(--text-secondary)"},l))),t.raw_data&&e("div",null,e("button",{onClick:()=>r(!a),class:"text-sm cursor-pointer",style:"color: var(--accent)"},a?"Hide raw data":"Show raw data"),a&&e("pre",{class:"mt-2 p-3 text-xs overflow-x-auto",style:"background: var(--bg-inset); color: var(--text-primary); border-radius: var(--radius); font-family: var(--font-mono)"},JSON.stringify(t.raw_data,null,2))))}function Ho(){let{data:t,loading:a,error:r,refetch:s}=He("patterns"),{metadata:n,patterns:o}=fe(()=>{if(!t||!t.data)return{metadata:null,patterns:[]};let i=t.data;return{metadata:i.metadata||null,patterns:i.patterns||[]}},[t]),l="Recurring behaviors the system has found \u2014 things that happen at the same time, in the same sequence, or that correlate with each other.";return a&&!t?e("div",{class:"space-y-6"},e("div",null,e("h1",{class:"text-2xl font-bold",style:"color: var(--text-primary)"},"Patterns"),e("p",{class:"text-sm",style:"color: var(--text-tertiary)"},l)),e(Se,{type:"cards"})):r?e("div",{class:"space-y-6"},e("div",null,e("h1",{class:"text-2xl font-bold",style:"color: var(--text-primary)"},"Patterns"),e("p",{class:"text-sm",style:"color: var(--text-tertiary)"},l)),e(we,{error:r,onRetry:s})):e("div",{class:"space-y-6 animate-page-enter"},e(ie,{page:"PATTERNS",subtitle:"Recurring event sequences from your logbook."}),e(Fe,{value:o.length,label:"patterns detected",loading:a}),n&&e("div",{class:"flex flex-wrap gap-3 text-sm",style:"color: var(--text-tertiary)"},n.time_range&&e("span",{style:"background: var(--bg-surface-raised); border-radius: var(--radius); padding: 0.25rem 0.5rem;"},"Range: ",n.time_range),n.pattern_count!=null&&e("span",{style:"background: var(--bg-surface-raised); border-radius: var(--radius); padding: 0.25rem 0.5rem;"},n.pattern_count," patterns"),n.analyzed_at&&e("span",{style:"background: var(--bg-surface-raised); border-radius: var(--radius); padding: 0.25rem 0.5rem;"},"Analyzed: ",new Date(n.analyzed_at).toLocaleString())),o.length===0?e("div",{class:"t-callout",style:"padding: 0.75rem;"},e("span",{class:"text-sm",style:"color: var(--text-secondary)"},"No patterns detected yet. The pattern recognition module analyzes HA logbook sequences to find temporal, correlation, and sequence patterns. It needs several days of logbook data with meaningful device events to identify reliable patterns.")):e("div",{class:"space-y-4 stagger-children"},o.map((i,u)=>e(Rv,{key:i.name||u,pattern:i}))))}function Iv(t){switch((t||"").toLowerCase()){case"approved":return"background: var(--status-healthy-glow); color: var(--status-healthy);";case"rejected":return"background: var(--status-error-glow); color: var(--status-error);";default:return"background: var(--status-warning-glow); color: var(--status-warning);"}}function zo({obj:t}){return t?typeof t=="string"?e("span",{class:"text-sm",style:"color: var(--text-secondary)"},t):e("dl",{class:"text-xs space-y-0.5",style:"color: var(--text-secondary)"},Object.entries(t).map(([a,r])=>e("div",{key:a,class:"flex gap-2"},e("dt",{class:"min-w-[80px]",style:"color: var(--text-tertiary)"},a,":"),e("dd",{class:"break-all",style:"color: var(--text-secondary)"},typeof r=="object"?JSON.stringify(r):String(r))))):null}function Nv({suggestion:t,onStatusChange:a,updating:r}){let s=t.confidence??0,n=Math.round(s*100),o=(t.status||"pending").toLowerCase(),l=o==="approved"?"border-left: 4px solid var(--status-healthy);":o==="rejected"?"border-left: 4px solid var(--status-error); opacity: 0.6;":"";return e("div",{class:"t-frame","data-label":t.name||t.trigger||"suggestion",style:`padding: 1.25rem; ${l}`},e("div",{class:"flex items-center justify-between mb-2"},e("h3",{class:"text-base font-bold",style:"color: var(--text-primary)"},t.name||"Unnamed automation"),e("span",{class:"inline-block px-2 py-0.5 rounded-full text-xs font-medium",style:Iv(o)},o)),t.description&&e("p",{class:"text-sm mb-3",style:"color: var(--text-secondary)"},t.description),e("div",{class:"mb-4"},e("div",{class:"flex items-center justify-between text-xs mb-1",style:"color: var(--text-tertiary)"},e("span",null,"Confidence"),e("span",null,n,"%")),e("div",{class:"h-2 rounded-full",style:"background: var(--bg-inset)"},e("div",{class:"h-2 rounded-full transition-all",style:`background: var(--accent); width: ${n}%`}))),t.trigger&&e("div",{class:"mb-3"},e("h4",{class:"text-xs font-semibold uppercase tracking-wide mb-1",style:"color: var(--text-tertiary)"},"Trigger"),e(zo,{obj:t.trigger})),t.conditions&&t.conditions.length>0&&e("div",{class:"mb-3"},e("h4",{class:"text-xs font-semibold uppercase tracking-wide mb-1",style:"color: var(--text-tertiary)"},"Conditions"),e("div",{class:"space-y-1"},t.conditions.map((i,u)=>e(zo,{key:u,obj:i})))),t.actions&&t.actions.length>0&&e("div",{class:"mb-3"},e("h4",{class:"text-xs font-semibold uppercase tracking-wide mb-1",style:"color: var(--text-tertiary)"},"Actions"),e("div",{class:"space-y-1"},t.actions.map((i,u)=>e(zo,{key:u,obj:i})))),t.yaml&&e("details",{class:"mb-3"},e("summary",{class:"text-sm cursor-pointer",style:"color: var(--accent)"},"Show YAML"),e("pre",{class:"mt-2 p-3 text-xs overflow-x-auto",style:"background: var(--bg-inset); color: var(--text-primary); border-radius: var(--radius); font-family: var(--font-mono)"},t.yaml)),o==="pending"&&e("div",{class:"flex gap-2 mt-4"},e("button",{onClick:()=>a(t.id,"approved"),disabled:r,class:"t-btn px-4 py-1.5 text-sm font-medium disabled:opacity-50 transition-colors",style:"background: var(--status-healthy); color: var(--text-inverse); border: none;"},"Approve"),e("button",{onClick:()=>a(t.id,"rejected"),disabled:r,class:"t-btn px-4 py-1.5 text-sm font-medium disabled:opacity-50 transition-colors",style:"background: var(--status-error); color: var(--text-inverse); border: none;"},"Reject")))}function Fo(){let{data:t,loading:a,error:r,refetch:s}=He("automation_suggestions"),[n,o]=N(!1),[l,i]=N(null),[u,d]=N({}),{metadata:y,suggestions:f}=fe(()=>{if(!t||!t.data)return{metadata:null,suggestions:[]};let C=t.data;return{metadata:C.metadata||null,suggestions:C.suggestions||[]}},[t]),m=fe(()=>f.map(C=>u[C.id]?{...C,status:u[C.id]}:C),[f,u]);async function b(C,A){o(!0),i(null),d(M=>({...M,[C]:A}));try{let M=f.map(S=>S.id===C?{...S,status:A}:S),_={...t.data||{},suggestions:M},k=await fetch(`${pa}/api/cache/automation_suggestions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({data:_})});if(!k.ok)throw new Error(`HTTP ${k.status}: ${k.statusText}`);d(S=>{let O={...S};return delete O[C],O}),s()}catch(M){d(_=>{let k={..._};return delete k[C],k}),i(M.message||String(M))}finally{o(!1)}}let h="Automation ideas generated from discovered patterns. Review, approve, or reject \u2014 approved automations can be exported to HA.";return a&&!t?e("div",{class:"space-y-6"},e("div",null,e("h1",{class:"text-2xl font-bold",style:"color: var(--text-primary)"},"Automations"),e("p",{class:"text-sm",style:"color: var(--text-tertiary)"},h)),e(Se,{type:"cards"})):r?e("div",{class:"space-y-6"},e("div",null,e("h1",{class:"text-2xl font-bold",style:"color: var(--text-primary)"},"Automations"),e("p",{class:"text-sm",style:"color: var(--text-tertiary)"},h)),e(we,{error:r,onRetry:s})):e("div",{class:"space-y-6 animate-page-enter"},e(ie,{page:"AUTOMATIONS",subtitle:"LLM-suggested Home Assistant automation YAML."}),e(Fe,{value:m.length,label:"automation suggestions",loading:a}),y&&e("div",{class:"flex flex-wrap gap-3 text-sm",style:"color: var(--text-tertiary)"},y.total_suggestions!=null&&e("span",{style:"background: var(--bg-surface-raised); border-radius: var(--radius); padding: 0.25rem 0.5rem;"},y.total_suggestions," suggestions"),y.model&&e("span",{style:"background: var(--bg-surface-raised); border-radius: var(--radius); padding: 0.25rem 0.5rem;"},"Model: ",y.model),y.generated_at&&e("span",{style:"background: var(--bg-surface-raised); border-radius: var(--radius); padding: 0.25rem 0.5rem;"},"Generated: ",new Date(y.generated_at).toLocaleString())),l&&e(we,{error:l,onRetry:()=>i(null)}),m.length===0?e("div",{class:"t-callout",style:"padding: 0.75rem;"},e("span",{class:"text-sm",style:"color: var(--text-secondary)"},"No automation suggestions yet. The orchestrator generates suggestions when it finds patterns with high enough confidence and matching capabilities. This requires the pattern recognition and discovery modules to have populated data first.")):e("div",{class:"grid grid-cols-1 lg:grid-cols-2 gap-4 stagger-children"},m.map((C,A)=>e(Nv,{key:C.id||A,suggestion:C,onStatusChange:b,updating:n}))))}function bd(t){return t==="high"?"background: var(--status-healthy-glow); color: var(--status-healthy);":t==="medium"?"background: var(--status-warning-glow); color: var(--status-warning);":"background: var(--status-error-glow); color: var(--status-error);"}function St(t){if(!t)return"\u2014";let a=Date.now()-new Date(t).getTime(),r=Math.floor(a/6e4);if(r<1)return"just now";if(r<60)return`${r}m ago`;let s=Math.floor(r/60);return s<24?`${s}h ago`:`${Math.floor(s/24)}d ago`}function Bo(t){if(!t)return"";let a=Date.now()-new Date(t).getTime(),r=Math.floor(a/6e4);if(r<60)return`${r}m`;let s=Math.floor(r/60),n=r%60;return n>0?`${s}h ${n}m`:`${s}h`}function ee({title:t,subtitle:a,summary:r,defaultOpen:s=!0,loading:n,children:o}){return e(vt,{title:t,subtitle:a,summary:r,defaultOpen:s,loading:n},o)}function me({children:t}){return e("div",{class:"t-callout p-3 text-sm"},t)}var Fa={light:"Lights",switch:"Switches",binary_sensor:"Sensors",lock:"Locks",media_player:"Media",cover:"Covers",climate:"Climate",vacuum:"Vacuum",person:"People",device_tracker:"Trackers",fan:"Fans",sensor:"Power"},hd={arrive:"\u25B6",depart:"\u25C0",person:"\u25CF",unlock:"\u25CB",lock:"\u25CF",motion:"\u25B8",clear:"\xB7",door:"\u25A0",window:"\u25A1",light_on:"\u25CF",light_off:"\xB7",switch:"\u25C6",sensor:"\u25B8",media:"\u25B6",climate:"\u223F",cover:"\u25A1",default:"\xB7"};function _d(t){let a=t.friendly_name||t.entity||"?",r=t.domain||"",s=t.device_class||"",n=t.to||"",o=t.from||"";return r==="person"||r==="device_tracker"?n==="home"?{text:`${a} arrived home`,icon:"arrive"}:o==="home"?{text:`${a} left`,icon:"depart"}:{text:`${a}: ${n}`,icon:"person"}:r==="lock"?n==="unlocked"?{text:`${a} unlocked`,icon:"unlock"}:n==="locked"?{text:`${a} locked`,icon:"lock"}:{text:`${a}: ${n}`,icon:"lock"}:r==="binary_sensor"?s==="motion"?n==="on"?{text:`Motion in ${a}`,icon:"motion"}:{text:`${a} cleared`,icon:"clear"}:s==="door"?n==="on"?{text:`${a} opened`,icon:"door"}:{text:`${a} closed`,icon:"door"}:s==="window"?n==="on"?{text:`${a} opened`,icon:"window"}:{text:`${a} closed`,icon:"window"}:s==="occupancy"?n==="on"?{text:`${a} occupied`,icon:"motion"}:{text:`${a} clear`,icon:"clear"}:n==="on"?{text:`${a} active`,icon:"sensor"}:{text:`${a} inactive`,icon:"clear"}:r==="light"?n==="on"?{text:`${a} on`,icon:"light_on"}:{text:`${a} off`,icon:"light_off"}:r==="switch"?n==="on"?{text:`${a} on`,icon:"switch"}:{text:`${a} off`,icon:"switch"}:r==="media_player"?n==="playing"?{text:`${a} playing`,icon:"media"}:n==="paused"?{text:`${a} paused`,icon:"media"}:n==="idle"||n==="off"?{text:`${a} stopped`,icon:"media"}:{text:`${a}: ${n}`,icon:"media"}:r==="climate"?{text:`${a} set to ${n}`,icon:"climate"}:r==="cover"?n==="open"?{text:`${a} opened`,icon:"cover"}:n==="closed"?{text:`${a} closed`,icon:"cover"}:{text:`${a}: ${n}`,icon:"cover"}:{text:`${a}: ${o} \u2192 ${n}`,icon:"default"}}function wd({maturity:t,shadowStage:a,shadowAccuracy:r}){if(!t)return null;let s=No.indexOf(t.phase),n=Math.max((s+1)/No.length*100,10),o=s<2?'The system needs enough data to tell the difference between "normal Tuesday" and "something unusual." More days = better predictions.':"The system has enough data to predict your home's behavior and flag anomalies.";return e(ee,{title:"Learning Progress",summary:t.phase},e("div",{class:"t-frame p-4 space-y-4","data-label":"learning"},e("div",null,e("div",{class:"flex justify-between text-xs mb-1",style:"color: var(--text-tertiary)"},xd.map((l,i)=>{let u=i<s?"color: var(--status-healthy)":i===s?"color: var(--accent); font-weight: 700":"";return e("span",{key:l,style:u},l)})),e("div",{class:"h-3 rounded-full",style:"background: var(--bg-inset)"},e("div",{class:"h-3 rounded-full transition-all",style:`background: var(--accent); width: ${n}%`}))),e("p",{class:"text-sm",style:"color: var(--text-secondary)"},t.description),e("p",{class:"text-xs italic",style:"color: var(--text-tertiary)"},o),e("div",{class:"flex flex-wrap gap-3 text-sm"},e("span",{class:"rounded px-2 py-1",style:"background: var(--bg-surface-raised)"},t.days_of_data," day",t.days_of_data!==1?"s":""," of data"),e("span",{class:"rounded px-2 py-1",style:"background: var(--bg-surface-raised)"},t.intraday_count," intraday snapshot",t.intraday_count!==1?"s":""),t.first_date&&e("span",{class:"rounded px-2 py-1",style:"background: var(--bg-surface-raised)"},"Since ",t.first_date)),t.next_milestone&&t.phase!=="ml-active"&&e("p",{class:"text-xs",style:"color: var(--text-tertiary)"},"Next: ",t.next_milestone),a&&e("div",{class:"flex items-center gap-2 text-xs pt-1",style:"color: var(--text-tertiary); border-top: 1px solid var(--border-subtle)"},e("span",{class:"font-medium rounded-full px-2 py-0.5 capitalize",style:"background: var(--accent-glow); color: var(--accent)"},a),e("span",null,"Shadow engine",r!=null?` \u2014 ${Math.round(r*100)}% accuracy`:""))))}function Sd({intraday:t,baselines:a}){if(!t||t.length===0)return null;let r=t[t.length-1],s=new Date().toLocaleDateString("en-US",{weekday:"long"}),n=a&&a[s];function o(u,d){if(d==null||!n||!n[u])return null;let y=n[u].mean;if(y==null)return null;let f=d-y,m=y>0?Math.round(f/y*100):0;return Math.abs(m)<10?{text:"typical",style:"color: var(--text-tertiary)"}:m>0?{text:`+${m}% vs ${s}`,style:"color: var(--status-warning)"}:{text:`${m}% vs ${s}`,style:"color: var(--accent)"}}let l=[{label:"Power (W)",value:r.power_watts!=null?r.power_watts:"\u2014",note:o("power_watts",r.power_watts)},{label:"Lights On",value:r.lights_on!=null?r.lights_on:"\u2014",note:o("lights_on",r.lights_on)},{label:"Devices Home",value:r.devices_home!=null?r.devices_home:"\u2014"},{label:"Unavailable",value:r.unavailable!=null?r.unavailable:"\u2014",warning:(r.unavailable||0)>100,note:(r.unavailable||0)>100?{text:"High \u2014 check devices",style:"color: var(--status-warning)"}:null}],i=n?`Latest snapshot compared to your typical ${s}. Updated every 4 hours (more often when home is active).`:"Latest snapshot of your home. Comparisons to baseline will appear after 7 days of data.";return e(ee,{title:"Home Right Now",subtitle:i,summary:l.length+" metrics"},e("div",{class:"grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-4 gap-4"},l.map((u,d)=>e("div",{key:d,class:"t-frame p-4","data-label":u.label,style:u.warning?"border: 2px solid var(--status-warning)":""},e("div",{class:"text-2xl font-bold",style:u.warning?"color: var(--status-warning)":"color: var(--accent)"},u.value),e("div",{class:"text-sm mt-1",style:"color: var(--text-tertiary)"},u.label),u.note&&e("div",{class:"text-xs mt-1",style:u.note.style},u.note.text)))))}var Ad={light:"var(--accent-warm)",switch:"var(--accent)",binary_sensor:"var(--accent-purple)",person:"var(--status-healthy)",device_tracker:"var(--status-healthy)"};function Ov({events:t}){if(!t||t.length===0)return null;let a=new Date,r=new Date(a-gd),s=t.map(d=>{let[y,f]=(d.time||"").split(":").map(Number),m=new Date;return m.setHours(y,f,0,0),m>a&&m.setDate(m.getDate()-1),{...d,_date:m}}).filter(d=>d._date>=r&&d._date<=a);if(s.length===0)return null;let n={};s.forEach(d=>{let y=d.domain||"unknown";n[y]||(n[y]=[]),n[y].push(d)});let o=Object.keys(n);if(o.length===0)return null;let l=a-r,i=r.toTimeString().slice(0,5),u=a.toTimeString().slice(0,5);return e("div",{class:"t-frame p-4","data-label":"swim lanes"},e("p",{class:"text-xs mb-2",style:"color: var(--text-tertiary)"},"What happened in the last hour, organized by device type. Each dot is one state change. Hover a dot to see which device changed."),e("div",{style:"display: grid; grid-template-columns: 60px 1fr; gap: 0;"},o.map(d=>e("div",{key:d,style:"display: contents;"},e("div",{style:"height: 20px; margin-bottom: 2px; display: flex; align-items: center; font-size: 10px; color: var(--text-tertiary); white-space: nowrap; overflow: hidden; text-overflow: ellipsis;"},Fa[d]||d),e("div",{style:"height: 20px; margin-bottom: 2px; position: relative; background: var(--bg-inset); border-radius: 2px;"},n[d].map((y,f)=>{let m=(y._date-r)/l*100,b=Ad[d]||"var(--text-tertiary)";return e("div",{key:f,title:`${y.friendly_name||y.entity} \u2014 ${y.state} at ${y.time}`,style:{position:"absolute",left:`${m}%`,top:"6px",width:"8px",height:"8px",borderRadius:"50%",backgroundColor:b,transform:"translateX(-4px)"}})}),e("div",{style:"position: absolute; right: 0; top: 0; bottom: 0; border-right: 2px dashed var(--text-tertiary); opacity: 0.5;"})))),e("div",{style:"height: 14px;"}),e("div",{style:"height: 14px; position: relative; display: flex; justify-content: space-between; font-size: 10px; color: var(--text-tertiary);"},e("span",null,i),e("span",null,"now"))),e("div",{class:"flex flex-wrap items-center gap-3 mt-2 pt-2",style:"border-top: 1px solid var(--border-subtle); font-size: 10px; color: var(--text-tertiary);"},o.map(d=>e("div",{key:d,class:"flex items-center gap-1"},e("span",{style:`display: inline-block; width: 8px; height: 8px; border-radius: 50%; background: ${Ad[d]||"var(--text-tertiary)"};`}),e("span",null,Fa[d]||d))),e("div",{class:"flex items-center gap-1"},e("span",{style:"display: inline-block; width: 1px; height: 10px; border-left: 2px dashed var(--text-tertiary); opacity: 0.5;"}),e("span",null,"Now"))))}function Hv({windows:t}){if(!t||t.length===0)return null;let a=new Date,r=new Date(a-yd).toISOString(),s=t.filter(u=>u.window_start>=r);if(s.length===0)return null;let n=Math.max(...s.map(u=>u.event_count),1),o=s.reduce((u,d)=>u+d.event_count,0),l=s.filter(u=>u.occupancy).length,i=s.length>0?Math.round(l/s.length*100):0;return e("div",{class:"space-y-2"},e("div",{class:"flex justify-between items-baseline"},e("div",{class:"text-xs font-medium",style:"color: var(--text-secondary)"},"Activity Timeline (6h)"),e("div",{class:"text-xs",style:"color: var(--text-tertiary)"},o," events, home ",i,"% of the time")),e("div",{class:"flex items-end gap-0.5 h-16"},s.map((u,d)=>{let y=Math.max(u.event_count/n*100,4),f=u.occupancy?"var(--accent-purple)":"var(--text-tertiary)",m=u.window_start.slice(11,16);return e("div",{key:d,class:"flex-1 rounded-t transition-all",style:{height:`${y}%`,backgroundColor:f,minWidth:"3px"},title:`${m} \u2014 ${u.event_count} events${u.occupancy?"":" (away)"}`})})),e("div",{class:"flex justify-between",style:"font-size: 10px; color: var(--text-tertiary)"},e("span",null,s[0]?.window_start?.slice(11,16)),e("div",{class:"flex items-center gap-2"},e("span",{class:"inline-block w-2 h-2 rounded-sm",style:{backgroundColor:"var(--accent-purple)"}})," home",e("span",{class:"inline-block w-2 h-2 rounded-sm",style:"background: var(--text-tertiary)"})," away"),s.length>1&&e("span",null,s[s.length-1]?.window_start?.slice(11,16))))}function zv({ws:t}){if(!t)return null;let a=t.connected;return e("div",{class:"flex items-center gap-2 text-xs"},e("span",{class:"inline-block w-2.5 h-2.5 rounded-full",style:`background: ${a?"var(--status-healthy)":"var(--status-error)"}`}),e("span",{style:`color: ${a?"var(--status-healthy)":"var(--status-error)"}`},a?"Connected":"Disconnected"),t.disconnect_count>0&&e("span",{style:"color: var(--text-tertiary)"},"(",t.disconnect_count," reconnect",t.disconnect_count!==1?"s":"",")"),t.total_disconnect_s>0&&e("span",{style:"color: var(--text-tertiary)"},Math.round(t.total_disconnect_s),"s downtime"))}function Cd({activity:t}){if(!t)return e(ee,{title:"Activity Monitor",subtitle:"Waiting for WebSocket to connect to Home Assistant..."},e(me,null,"Activity monitoring is starting up. State changes will appear here once the WebSocket connection is established."));let a=t.activity_summary,r=t.activity_log;if(!a&&!r)return e(ee,{title:"Activity Monitor",subtitle:"Waiting for first events..."},e(me,null,"Activity monitoring is starting up. State changes will appear here once the WebSocket connection is established."));let s=a?.occupancy||{},n=a?.activity_rate||{},o=a?.snapshot_status||{},l=a?.domains_active_1h||{},i=a?.recent_activity||[],u=r?.windows||[],d=a?.websocket||{},y=a?.event_predictions||{},f=a?.patterns||[],m=a?.occupancy_prediction||{},b=a?.anomalies||[],h=[];if(s.anyone_home){let _=Bo(s.since),k=(s.people||[]).join(" & ")||"Someone";h.push(_?`${k} home for ${_}`:`${k} home`)}else h.push("Nobody home");n.trend==="increasing"?h.push("activity picking up"):n.trend==="decreasing"&&h.push("quieting down");let C=r?.events_today;C!=null&&h.push(`${C} events today`);let A=h.join(" \xB7 "),M="";return o.today_count>0?M=`${o.today_count} adaptive snapshot${o.today_count!==1?"s":""} captured today \u2014 the system saw enough activity to grab extra data points.`:s.anyone_home?M="Watching for sustained activity to trigger an adaptive snapshot. Cooldown and event thresholds are configurable in Settings.":M="Adaptive snapshots only trigger when someone is home.",e(ee,{title:"Activity Monitor",subtitle:A,summary:s.anyone_home?"Home":"Away"},e("div",{class:"space-y-4"},e("div",{class:"flex items-center justify-between"},e(zv,{ws:d}),y.predicted_next_domain&&e("div",{class:"text-xs",style:"color: var(--text-tertiary)"},"Next likely: ",e("span",{class:"font-medium",style:"color: var(--text-secondary)"},Fa[y.predicted_next_domain]||y.predicted_next_domain)," ","(",Math.round(y.probability*100),"%)")),b.length>0&&b.map((_,k)=>e(me,{key:k},_.message)),e("div",{class:"grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-4 gap-4"},e("div",{class:"t-frame p-4",style:`border-left: 4px solid ${s.anyone_home?"var(--status-healthy)":"var(--border-subtle)"}`},e("div",{class:"text-2xl font-bold",style:`color: ${s.anyone_home?"var(--status-healthy)":"var(--text-tertiary)"}`},s.anyone_home?"Home":"Away"),e("div",{class:"text-sm mt-1",style:"color: var(--text-tertiary)"},"Occupancy"),s.anyone_home&&s.since&&e("div",{class:"text-xs mt-1",style:"color: var(--text-tertiary)"},"for ",Bo(s.since)),!s.anyone_home&&m.predicted_arrival&&m.status==="predicted"&&e("div",{class:"text-xs mt-1",style:"color: var(--accent)"},"ETA ~",m.predicted_arrival,e("span",{style:"color: var(--text-tertiary)"}," (",m.confidence,", ",m.based_on," samples)")),!s.anyone_home&&m.status==="past_predicted"&&e("div",{class:"text-xs mt-1",style:"color: var(--text-tertiary)"},"Typical arrival (",m.predicted_arrival,") passed")),e("div",{class:"t-frame p-4"},e("div",{class:"text-2xl font-bold",style:"color: var(--accent)"},n.current!=null?n.current:"\u2014"),e("div",{class:"text-sm mt-1",style:"color: var(--text-tertiary)"},"Events (15m window)"),n.avg_1h>0&&e("div",{class:"text-xs mt-1",style:`color: ${n.trend==="increasing"?"var(--status-warning)":n.trend==="decreasing"?"var(--accent)":"var(--text-tertiary)"}`},n.trend==="increasing"?"Above":n.trend==="decreasing"?"Below":"Near"," avg (",n.avg_1h,"/window)")),e("div",{class:"t-frame p-4"},e("div",{class:"text-2xl font-bold",style:"color: var(--accent)"},C??"\u2014"),e("div",{class:"text-sm mt-1",style:"color: var(--text-tertiary)"},"Events Today")),e("div",{class:"t-frame p-4"},e("div",{class:"text-2xl font-bold",style:"color: var(--accent)"},o.today_count!=null?`${o.today_count}/${o.daily_cap}`:"\u2014"),e("div",{class:"text-sm mt-1",style:"color: var(--text-tertiary)"},"Adaptive Snapshots"),o.cooldown_remaining_s>0&&e("div",{class:"text-xs mt-1",style:"color: var(--text-tertiary)"},"Next eligible in ",Math.ceil(o.cooldown_remaining_s/60),"m"))),e("div",{class:"text-xs italic px-1",style:"color: var(--text-tertiary)"},M),e("div",{class:"grid grid-cols-1 sm:grid-cols-1 lg:grid-cols-3 gap-4"},e("div",{class:"lg:col-span-2 t-frame p-4","data-label":"recent"},e("div",{class:"text-xs font-bold uppercase mb-2",style:"color: var(--text-tertiary)"},"What Just Happened"),e(Ov,{events:i}),i.length===0?e("p",{class:"text-sm",style:"color: var(--text-tertiary)"},"Waiting for state changes..."):e("div",{class:"sr-only space-y-0.5 max-h-64 overflow-y-auto"},i.map((_,k)=>{let S=_d(_),O=hd[S.icon]||"\xB7",$=["lock","person","device_tracker"].includes(_.domain)||_.domain==="binary_sensor"&&["door","window"].includes(_.device_class),H=`${_.entity||_.friendly_name}-${_.time}-${k}`;return e("div",{key:H,class:"flex items-center gap-2 py-1 px-1 rounded",style:$?"background: var(--status-warning-glow)":""},e("span",{class:"w-5 text-center text-sm flex-shrink-0"},O),e("span",{class:`flex-1 text-sm ${$?"font-medium":""}`,style:`color: ${$?"var(--text-primary)":"var(--text-secondary)"}`},S.text),e("span",{class:"text-xs flex-shrink-0",style:"color: var(--text-tertiary)"},_.time))}))),e("div",{class:"t-frame p-4","data-label":"domains"},e("div",{class:"text-xs font-bold uppercase mb-2",style:"color: var(--text-tertiary)"},"Active Domains (1h)"),Object.keys(l).length===0?e("p",{class:"text-sm",style:"color: var(--text-tertiary)"},"No activity yet."):e("div",{class:"space-y-2"},(()=>{let _=Math.max(...Object.values(l),1);return Object.entries(l).map(([k,S])=>{let O=Fa[k]||k,$=S/_*100;return e("div",{key:k,class:"space-y-0.5"},e("div",{class:"flex justify-between text-xs"},e("span",{style:"color: var(--text-secondary)"},O),e("span",{style:"color: var(--text-tertiary)"},S)),e("div",{class:"h-1.5 rounded-full",style:"background: var(--bg-inset)"},e("div",{class:"h-1.5 rounded-full",style:`background: var(--accent-dim); width: ${$}%`})))})})()))),f.length>0&&e("div",{class:"t-frame p-4","data-label":"patterns"},e("div",{class:"text-xs font-bold uppercase mb-2",style:"color: var(--text-tertiary)"},"Detected Patterns (24h)"),e("p",{class:"text-xs mb-2",style:"color: var(--text-tertiary)"},"Recurring event sequences that suggest routines or automations."),e("div",{class:"space-y-1.5"},f.map((_,k)=>e("div",{key:k,class:"flex items-center gap-2 text-sm"},e("div",{class:"flex items-center gap-1"},_.sequence.map((S,O)=>e("span",{key:O},e("span",{class:"rounded px-1.5 py-0.5 text-xs font-medium",style:"background: var(--accent-glow); color: var(--accent)"},Fa[S]||S),O<_.sequence.length-1&&e("span",{class:"mx-0.5",style:"color: var(--text-tertiary)"},"\u2192")))),e("span",{class:"text-xs ml-auto flex-shrink-0",style:"color: var(--text-tertiary)"},_.count,"x",_.last_seen?`, last ${_.last_seen.slice(11,16)||_.last_seen}`:""))))),e("div",{class:"t-frame p-4","data-label":"timeline"},e(Hv,{windows:u}),u.length===0&&e("p",{class:"text-sm",style:"color: var(--text-tertiary)"},"Timeline will appear after the first 15-minute window.")),o.log_today&&o.log_today.length>0&&e("details",{class:"t-frame"},e("summary",{class:"px-4 py-3 cursor-pointer text-sm font-medium",style:"color: var(--text-secondary)"},"Snapshot Log \\u2014 ",o.log_today.length," adaptive snapshot",o.log_today.length!==1?"s":""," today"),e("div",{class:"overflow-x-auto"},e("table",{class:"w-full text-sm"},e("thead",null,e("tr",{class:"text-left text-xs",style:"border-bottom: 1px solid var(--border-subtle); color: var(--text-tertiary)"},e("th",{class:"px-4 py-1"},"#"),e("th",{class:"px-4 py-1"},"Time"),e("th",{class:"px-4 py-1"},"Events"),e("th",{class:"px-4 py-1"},"People"),e("th",{class:"px-4 py-1"},"What Triggered It"))),e("tbody",null,o.log_today.map((_,k)=>e("tr",{key:k,style:"border-bottom: 1px solid var(--border-subtle)"},e("td",{class:"px-4 py-1.5",style:"color: var(--text-tertiary)"},_.number),e("td",{class:"px-4 py-1.5",style:"color: var(--text-secondary)"},_.timestamp?.slice(11,16)),e("td",{class:"px-4 py-1.5"},_.buffered_events," buffered"),e("td",{class:"px-4 py-1.5",style:"color: var(--text-secondary)"},(_.people||[]).join(", ")||"\u2014"),e("td",{class:"px-4 py-1.5"},e("div",{class:"flex flex-wrap gap-1"},Object.entries(_.domains||{}).slice(0,4).map(([S,O])=>e("span",{key:S,class:"rounded px-1.5 py-0.5 text-xs",style:"background: var(--bg-surface-raised)"},Fa[S]||S,": ",O))))))))))))}function Qr(t,a,r){let s=t.map(o=>{if(a==="date")return Math.floor(new Date(o.date).getTime()/1e3);{let l=new Date;return Math.floor(new Date(l.getFullYear(),l.getMonth(),l.getDate(),o.hour).getTime()/1e3)}}),n=t.map(o=>o[r]??null);return[s,n]}function Xr({label:t,data:a,color:r,height:s=80}){return e("div",null,e("div",{class:"text-xs font-bold uppercase",style:{color:"var(--text-tertiary)"}},t),e(Ha,{data:a,series:[{label:t,color:r}],height:s}))}function Td({trendData:t,intradayTrend:a}){let r=t&&t.length>0,s=a&&a.length>0;if(!r&&!s)return e(ee,{title:"Trends Over Time",subtitle:"Spot when something changed \u2014 a new device, a routine shift, or a problem building."},e(me,null,"No trend data yet. Daily snapshots are collected each night at 11:30 PM."));let n=null;if(r&&t.length>=2){let o=t[t.length-1],l=t[t.length-2],i=[];if(o.power_watts!=null&&l.power_watts!=null){let u=o.power_watts-l.power_watts;Math.abs(u)>50&&i.push(`Power ${u>0?"up":"down"} ${Math.abs(Math.round(u))}W vs yesterday`)}if(o.unavailable!=null&&l.unavailable!=null){let u=o.unavailable-l.unavailable;u>10&&i.push(`${u} more entities unavailable than yesterday \u2014 check your network`)}i.length>0&&(n=i.join(". ")+".")}return e(ee,{title:"Trends Over Time",subtitle:"Spot when something changed \u2014 a new device, a routine shift, or a problem building."},n&&e(me,null,n),e("p",{class:"text-xs",style:{color:"var(--text-secondary)",marginBottom:"0.75rem"}},"Each chart tracks one measurement over time. Power is your home's total electricity usage. Lights is how many are on. Unavailable means devices that stopped reporting \u2014 a spike usually means a network issue."),e("div",{class:"t-frame","data-label":"trends"},r&&e("div",{class:"space-y-2"},e("div",{class:"text-xs font-bold uppercase",style:{color:"var(--text-tertiary)"}},"Daily (30d)"),e(Xr,{label:"Power (W)",data:Qr(t,"date","power_watts"),color:"var(--accent)"}),e(Xr,{label:"Lights On",data:Qr(t,"date","lights_on"),color:"var(--accent-warm)"}),e(Xr,{label:"Unavailable",data:Qr(t,"date","unavailable"),color:"var(--status-error)"})),s&&e("div",{class:"space-y-2"},e("div",{class:"text-xs font-bold uppercase",style:{color:"var(--text-tertiary)"}},"Today (Intraday)"),e(Xr,{label:"Power (W)",data:Qr(a,"hour","power_watts"),color:"var(--accent-dim)"}),e(Xr,{label:"Unavailable",data:Qr(a,"hour","unavailable"),color:"var(--status-error)"}))))}function Md({predictions:t,intradayTrend:a}){if(!t||!t.target_date)return e(ee,{title:"Predictions vs Actuals",subtitle:"Once active, large deltas here mean something unusual is happening \\u2014 worth investigating."},e(me,null,'Predictions need at least 7 days of data. The system is still learning what "normal" looks like for each day of the week.'));let r=a&&a.length>0?a[a.length-1]:{},s=["power_watts","lights_on","devices_home","unavailable","useful_events"],n=null;return s.forEach(o=>{let l=t[o]||{},i=r[o];if(i!=null&&l.predicted!=null&&l.predicted>0){let u=Math.abs((i-l.predicted)/l.predicted*100);u>30&&(!n||u>n.pct)&&(n={metric:o.replace(/_/g," "),pct:Math.round(u),actual:i,predicted:l.predicted})}}),e(ee,{title:"Predictions vs Actuals",subtitle:"Large deltas mean something unusual is happening. Small deltas mean the system understands your patterns.",summary:t.target_date},n&&e(me,null,n.metric," is ",n.pct,"% off prediction (",n.actual," actual vs ",n.predicted," predicted). Worth a look?"),e("div",{class:"t-frame overflow-x-auto","data-label":"predictions"},e("table",{class:"w-full text-sm"},e("thead",null,e("tr",{class:"text-left text-xs uppercase",style:"border-bottom: 1px solid var(--border-subtle); color: var(--text-tertiary)"},e("th",{class:"px-4 py-2"},"Metric"),e("th",{class:"px-4 py-2"},"Predicted"),e("th",{class:"px-4 py-2"},"Actual"),e("th",{class:"px-4 py-2"},"Delta"),e("th",{class:"px-4 py-2"},"Confidence"))),e("tbody",null,s.map(o=>{let l=t[o]||{},i=r[o],u=i!=null&&l.predicted!=null?Math.round((i-l.predicted)*10)/10:null,d=u!=null&&l.predicted>0&&Math.abs(u/l.predicted)>.3;return e("tr",{key:o,style:`border-bottom: 1px solid var(--border-subtle)${d?"; background: var(--status-warning-glow)":""}`},e("td",{class:"px-4 py-2 font-medium",style:"color: var(--text-secondary)"},o.replace(/_/g," ")),e("td",{class:"px-4 py-2"},l.predicted!=null?l.predicted:"\u2014"),e("td",{class:"px-4 py-2"},i??"\u2014"),e("td",{class:"px-4 py-2"},u!=null?(u>=0?"+":"")+u:"\u2014"),e("td",{class:"px-4 py-2"},e("span",{class:"inline-block px-2 py-0.5 rounded-full text-xs font-medium",style:bd(l.confidence)},l.confidence||"n/a")))})))))}var Ed=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],Fv={Monday:"Mon",Tuesday:"Tue",Wednesday:"Wed",Thursday:"Thu",Friday:"Fri",Saturday:"Sat",Sunday:"Sun"},Gs=[{key:"power_watts",label:"Power",unit:"W",color:"var(--accent)",isNegative:!1},{key:"lights_on",label:"Lights",unit:"",color:"var(--accent)",isNegative:!1},{key:"devices_home",label:"Devices",unit:"",color:"var(--accent)",isNegative:!1},{key:"unavailable",label:"Unavail",unit:"",color:"var(--status-error)",isNegative:!0}];function Bv(t){let a={};for(let r of Gs){let s=1/0,n=-1/0;for(let o of Ed){let l=t[o];if(!l)continue;let i=l[r.key]?.mean;i!=null&&(i<s&&(s=i),i>n&&(n=i))}a[r.key]={min:s===1/0?0:s,max:n===-1/0?0:n}}return a}function jv(t,a,r){return r===a?.5:Math.max(0,Math.min(1,(t-a)/(r-a)))}function Uv(t,a){return t==null?"\u2014":a.key==="power_watts"?Math.round(t).toLocaleString():Math.round(t).toString()}function Wv({value:t,std:a,metric:r,range:s}){let n=t!=null,o=n?jv(t,s.min,s.max):0,l=Uv(t,r),i=n&&a!=null?`${r.label}: ${l}${r.unit?" "+r.unit:""} \xB1 ${Math.round(a*10)/10}`:r.label;return e("div",{class:"relative flex items-center justify-center rounded",style:"min-height: 2.5rem; min-width: 3.5rem;",title:i},e("div",{class:"absolute inset-0 rounded",style:`background: ${n?r.color:"var(--bg-surface-raised)"}; opacity: ${n?.12+o*.55:.15};`}),e("span",{class:"relative z-10 font-mono",style:"font-size: var(--type-micro); color: var(--text-primary);"},l))}function Pd({baselines:t}){if(!t||Object.keys(t).length===0)return e(ee,{title:"Baselines",subtitle:"This is what 'normal' looks like for each day. Deviations from these numbers trigger anomaly detection."},e(me,null,"No baselines yet. The first baseline is calculated after the first daily snapshot."));let a=new Date().toLocaleDateString("en-US",{weekday:"long"}),r=Bv(t);return e(ee,{title:"Baselines",subtitle:"This is 'normal' for each day of the week. The system flags deviations from these averages. More samples = tighter predictions.",summary:Object.keys(t).length+" days"},e("p",{class:"text-xs",style:"color: var(--text-tertiary)"},"Each cell shows what's typical for that day and metric. Darker color = higher value. Hover any cell to see the exact number with its margin of error. The 'n' column is how many readings were averaged."),e("div",{class:"t-frame","data-label":"baselines"},e("div",{style:`
            display: grid;
            grid-template-columns: auto repeat(${Gs.length}, 1fr) auto;
            gap: 0.25rem;
            padding: 0.5rem;
          `},e("div",null),Gs.map(s=>e("div",{key:s.key,class:"text-center text-xs uppercase",style:"color: var(--text-tertiary); padding-bottom: 0.25rem;"},s.label)),e("div",{class:"text-center text-xs uppercase",style:"color: var(--text-tertiary); padding-bottom: 0.25rem; padding-left: 0.5rem;"},"n"),Ed.map(s=>{let n=t[s],o=s===a;return[e("div",{key:s+"-label",class:"flex items-center text-xs font-medium pr-2",style:`
                  color: ${o?"var(--accent)":"var(--text-secondary)"};
                  ${o?"border-left: 2px solid var(--accent); padding-left: 0.375rem;":"padding-left: calc(2px + 0.375rem);"}
                `},Fv[s]),...Gs.map(l=>e(Wv,{key:s+"-"+l.key,value:n?.[l.key]?.mean,std:n?.[l.key]?.stddev,metric:l,range:r[l.key]})),e("div",{key:s+"-samples",class:"flex items-center justify-center text-xs",style:"color: var(--text-tertiary); padding-left: 0.5rem;"},n?.sample_count??"\u2014")]})),e("div",{class:"flex flex-wrap items-center gap-3 mt-2 pt-2",style:"border-top: 1px solid var(--border-subtle); font-size: var(--type-micro); color: var(--text-tertiary); padding: 0 0.5rem 0.5rem;"},e("div",{class:"flex items-center gap-1"},e("span",{style:"display: inline-block; width: 12px; height: 12px; border-radius: 2px; background: var(--accent); opacity: 0.2;"}),e("span",null,"Low")),e("div",{class:"flex items-center gap-1"},e("span",{style:"display: inline-block; width: 12px; height: 12px; border-radius: 2px; background: var(--accent); opacity: 0.65;"}),e("span",null,"High")),e("div",{class:"flex items-center gap-1"},e("span",{style:"display: inline-block; width: 12px; height: 12px; border-radius: 2px; background: var(--status-error); opacity: 0.65;"}),e("span",null,"High unavail (bad)")),e("span",{style:"color: var(--accent);"},"\\u25C0 today"))))}function $d({insight:t}){if(!t)return e(ee,{title:"Daily Insight",subtitle:"An AI-generated analysis of your home's patterns. Generated each night at 11:30 PM from the day's data."},e(me,null,"No insight report yet. The first report is generated after the first full pipeline run."));let a=(t.report||"").split(`
`);return e(ee,{title:"Daily Insight",subtitle:"AI analysis of what happened yesterday and what to watch for. Generated nightly from your full data set.",summary:t.date},e("div",{class:"t-frame p-4","data-label":"insight"},e("span",{class:"inline-block rounded px-2 py-0.5 text-xs mb-3",style:"background: var(--bg-surface-raised); color: var(--text-tertiary)"},t.date),e("div",{class:"space-y-2",style:"color: var(--text-secondary)"},a.map((r,s)=>r.startsWith("###")?e("h3",{key:s,class:"text-sm font-bold mt-3",style:"color: var(--text-primary)"},r.replace(/^###\s*/,"")):r.trim()===""?null:e("p",{key:s,class:"text-sm leading-relaxed"},r)))))}function Sr(t){let a=t.indexOf(".");return a>=0?t.slice(a+1):t}var Vv={very_strong:.9,strong:.7,moderate:.5,weak:.3};function Gv(t){let a=t.conditional_prob_a_given_b,r=t.conditional_prob_b_given_a;return a!=null&&r!=null?(a+r)/2/100:typeof t.strength=="string"?Vv[t.strength]??.5:parseFloat(t.strength!=null?t.strength:t[2])||0}function qv(t){let a=t.map(o=>({a:o.entity_a||o[0],b:o.entity_b||o[1],strength:Gv(o)})),r={};for(let o of a)for(let l of[o.a,o.b])r[l]||(r[l]={sum:0,count:0}),r[l].sum+=Math.abs(o.strength),r[l].count+=1;let s=Object.keys(r).sort((o,l)=>{let i=r[o].sum/r[o].count;return r[l].sum/r[l].count-i}),n={};for(let o of a)n[o.a+"|"+o.b]=o.strength,n[o.b+"|"+o.a]=o.strength;return{entities:s,pairMap:n}}function Yv(t){let a=Math.abs(t);if(t===1&&a===1)return"var(--bg-surface-raised)";if(a<=.3)return"var(--bg-surface)";let r=(.3+(a-.3)*(.7/.7)).toFixed(2);return t>0?`color-mix(in srgb, var(--accent) ${Math.round(r*100)}%, transparent)`:`color-mix(in srgb, var(--accent-purple) ${Math.round(r*100)}%, transparent)`}function Ld({correlations:t}){let a=t&&t.length>0;return e(ee,{title:"Correlations",subtitle:a?"Devices that change together. Strong correlations suggest automation opportunities or shared failure modes.":"Devices that tend to change together \u2014 useful for creating automations or finding shared failure points.",summary:a?t.length+" pairs":null},a?e(W,null,e("p",{class:"text-xs",style:"color: var(--text-tertiary)"},"This grid shows which devices tend to change at the same time. Blue means they move together (both turn on/off). Purple means they move opposite (one on, the other off). Faded cells are too weak to matter. Numbers closer to 1.0 or -1.0 are stronger relationships."),e(Kv,{correlations:t})):e(me,null,"No correlations yet. Needs enough data to detect statistically reliable relationships between devices."))}function Kv({correlations:t}){let{entities:a,pairMap:r}=qv(t),s=a.length,n={display:"grid",gridTemplateColumns:`auto repeat(${s}, minmax(2.5rem, 1fr))`,gridTemplateRows:`auto repeat(${s}, minmax(2rem, 1fr))`,gap:"1px",overflowX:"auto"};return e("div",{class:"t-frame overflow-x-auto","data-label":"correlation-matrix"},e("div",{style:n},e("div",{style:{gridRow:1,gridColumn:1}}),a.map((o,l)=>e("div",{key:"ch-"+l,style:{gridRow:1,gridColumn:l+2,display:"flex",alignItems:"flex-end",justifyContent:"flex-start",height:"5rem",overflow:"visible",paddingBottom:"0.25rem"}},e("span",{class:"data-mono",style:{fontSize:"var(--type-micro)",color:"var(--text-secondary)",transform:"rotate(-45deg)",transformOrigin:"bottom left",whiteSpace:"nowrap",display:"inline-block"}},Sr(o)))),a.map((o,l)=>e(W,null,e("div",{key:"rh-"+l,class:"data-mono",style:{gridRow:l+2,gridColumn:1,display:"flex",alignItems:"center",paddingRight:"0.5rem",fontSize:"var(--type-micro)",color:"var(--text-secondary)",whiteSpace:"nowrap"}},Sr(o)),a.map((i,u)=>{let d=l===u,y=d?1:r[o+"|"+i]??null,f=y!==null,m=f?Math.abs(y):0,b=f&&!d&&m<=.3;return e("div",{key:l+"-"+u,style:{gridRow:l+2,gridColumn:u+2,background:f?Yv(y):"transparent",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"2px",minHeight:"2rem"},title:f?`${Sr(o)} \u2194 ${Sr(i)}: ${y.toFixed(2)}`:`${Sr(o)} \u2194 ${Sr(i)}: no data`},f&&e("span",{style:{fontSize:"var(--type-micro)",color:b?"var(--text-tertiary)":m>.6?"var(--text-primary)":"var(--text-secondary)",fontVariantNumeric:"tabular-nums"}},d?"":y.toFixed(2)))})))),e("div",{style:{display:"flex",alignItems:"center",gap:"1rem",marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid var(--border-subtle)",fontSize:"var(--type-micro)",color:"var(--text-tertiary)",flexWrap:"wrap"}},e("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"}},e("span",{style:{display:"inline-block",width:"12px",height:"12px",borderRadius:"2px",background:"color-mix(in srgb, var(--accent-purple) 70%, transparent)"}}),e("span",null,"Negative")),e("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"}},e("span",{style:{display:"inline-block",width:"12px",height:"12px",borderRadius:"2px",background:"var(--bg-surface)"}}),e("span",null,"Weak (|r| \u2264 0.3)")),e("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"}},e("span",{style:{display:"inline-block",width:"12px",height:"12px",borderRadius:"2px",background:"color-mix(in srgb, var(--accent) 70%, transparent)"}}),e("span",null,"Positive"))))}function Dd({runLog:t,mlModels:a,metaLearning:r}){let s=t&&t.some(l=>l.status==="error"),n=t&&t.length>0?t[0]:null,o=s?"Errors detected in recent runs \u2014 the pipeline may be missing data.":n?`Last run ${St(n.timestamp)}. Everything healthy.`:"No runs recorded yet.";return e(ee,{title:"System Status",subtitle:`If something is red here, the intelligence pipeline is broken and won't catch issues in your home. ${o}`,summary:s?"errors":"healthy"},e("div",{class:"space-y-4"},e("div",{class:"t-frame overflow-x-auto","data-label":"run-log"},e("div",{class:"px-4 py-2 text-xs font-bold uppercase",style:"border-bottom: 1px solid var(--border-subtle); color: var(--text-tertiary)"},"Run Log"),!t||t.length===0?e("div",{class:"px-4 py-3 text-sm",style:"color: var(--text-tertiary)"},"No runs recorded yet."):e("table",{class:"w-full text-sm"},e("thead",null,e("tr",{class:"text-left text-xs",style:"border-bottom: 1px solid var(--border-subtle); color: var(--text-tertiary)"},e("th",{class:"px-4 py-1"},"When"),e("th",{class:"px-4 py-1"},"Type"),e("th",{class:"px-4 py-1"},"Status"))),e("tbody",null,t.map((l,i)=>e("tr",{key:i,style:"border-bottom: 1px solid var(--border-subtle)"},e("td",{class:"px-4 py-1.5",style:"color: var(--text-secondary)",title:l.timestamp},St(l.timestamp)),e("td",{class:"px-4 py-1.5"},e("span",{class:"rounded px-1.5 py-0.5 text-xs",style:"background: var(--bg-surface-raised)"},l.type)),e("td",{class:"px-4 py-1.5"},e("span",{class:"inline-block w-2 h-2 rounded-full",style:`background: ${l.status==="ok"?"var(--status-healthy)":"var(--status-error)"}`}),l.message&&e("span",{class:"ml-1 text-xs",style:"color: var(--status-error)"},l.message))))))),e("div",{class:"t-frame p-4","data-label":"ml-models"},e("div",{class:"text-xs font-bold uppercase mb-2",style:"color: var(--text-tertiary)"},"ML Models"),!a||a.count===0?e("p",{class:"text-sm",style:"color: var(--text-tertiary)"},"ML models activate after 14 days of data. Until then, predictions use statistical baselines only."):e("div",{class:"space-y-2"},e("div",{class:"flex gap-3 text-sm"},e("span",{class:"rounded px-2 py-0.5",style:"background: var(--bg-surface-raised)"},a.count," model",a.count!==1?"s":""),a.last_trained&&e("span",{style:"color: var(--text-tertiary)"},"Last trained: ",St(a.last_trained))),a.scores&&Object.keys(a.scores).length>0&&e("table",{class:"w-full text-xs"},e("thead",null,e("tr",{class:"text-left",style:"color: var(--text-tertiary)"},e("th",{class:"py-1"},"Model"),e("th",null,"R2"),e("th",null,"MAE"))),e("tbody",null,Object.entries(a.scores).map(([l,i])=>e("tr",{key:l},e("td",{class:"py-1 data-mono"},l),e("td",null,i.r2!=null?i.r2.toFixed(3):"\u2014"),e("td",null,i.mae!=null?i.mae.toFixed(2):"\u2014"))))))),e("div",{class:"t-frame p-4","data-label":"meta-learning"},e("div",{class:"text-xs font-bold uppercase mb-2",style:"color: var(--text-tertiary)"},"Meta-Learning"),!r||r.applied_count===0?e("p",{class:"text-sm",style:"color: var(--text-tertiary)"},"Meta-learning reviews model performance weekly and auto-tunes feature selection. Activates after the first training cycle."):e("div",{class:"space-y-2"},e("div",{class:"flex gap-3 text-sm"},e("span",{class:"rounded px-2 py-0.5",style:"background: var(--bg-surface-raised)"},r.applied_count," suggestion",r.applied_count!==1?"s":""," applied"),r.last_applied&&e("span",{style:"color: var(--text-tertiary)"},"Last: ",St(r.last_applied))),r.suggestions&&r.suggestions.length>0&&e("ul",{class:"text-xs space-y-1 list-disc ml-4",style:"color: var(--text-secondary)"},r.suggestions.map((l,i)=>e("li",{key:i},l.description||l.action||JSON.stringify(l))))))))}function Rd({drift:t}){if(!t||t.days_analyzed===0)return e(ee,{title:"Drift Detection",subtitle:"Concept drift means your home's patterns have changed \u2014 maybe a new schedule, seasonal shift, or new devices. ARIA uses Page-Hinkley and ADWIN algorithms to detect this automatically."},e(me,null,"Drift detection data is not yet available. It will populate after ARIA runs its drift check (aria check-drift) with enough prediction history."));let a=Object.keys(t.rolling_mae||{});return e(ee,{title:"Drift Detection",subtitle:"Concept drift means your home's patterns have changed \u2014 maybe a new schedule, seasonal shift, or new devices. ARIA uses Page-Hinkley and ADWIN algorithms to detect this and retrains when needed.",summary:t.needs_retrain?"drift detected":"stable"},e("div",{class:"space-y-3"},e("div",{class:"t-frame p-4","data-label":"status"},e("div",{class:"flex items-center gap-3"},e("span",{class:"inline-block w-3 h-3 rounded-full",style:`background: ${t.needs_retrain?"var(--status-warning)":"var(--status-healthy)"}`}),e("span",{class:"text-sm font-bold",style:`color: ${t.needs_retrain?"var(--status-warning)":"var(--status-healthy)"}`},t.needs_retrain?"Drift Detected":"Stable"),e("span",{class:"text-xs",style:"color: var(--text-tertiary)"},t.days_analyzed," days analyzed")),t.reason&&t.reason!=="no data"&&e("p",{class:"text-xs mt-2",style:"color: var(--text-secondary)"},t.reason)),a.length>0&&e("div",{class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3"},a.map(r=>{let s=(t.drifted_metrics||[]).includes(r),n=t.rolling_mae[r],o=t.current_mae?.[r],l=t.threshold?.[r],i=t.page_hinkley?.[r];return e("div",{key:r,class:"t-frame p-3","data-label":r.replace(/_/g," "),style:s?"border-left: 3px solid var(--status-warning)":""},e("div",{class:"flex items-center justify-between mb-2"},e("span",{class:"text-xs font-bold",style:"color: var(--text-primary)"},r.replace(/_/g," ")),e("span",{class:"inline-block w-2 h-2 rounded-full",style:`background: ${s?"var(--status-warning)":"var(--status-healthy)"}`})),e("div",{class:"space-y-1 text-xs",style:"color: var(--text-secondary)"},e("div",{class:"flex justify-between"},e("span",{style:"color: var(--text-tertiary)"},"Rolling MAE"),e("span",{class:"data-mono"},n??"\u2014")),o!=null&&e("div",{class:"flex justify-between"},e("span",{style:"color: var(--text-tertiary)"},"Current MAE"),e("span",{class:"data-mono",style:o>(l||1/0)?"color: var(--status-warning)":""},o)),l!=null&&e("div",{class:"flex justify-between"},e("span",{style:"color: var(--text-tertiary)"},"Threshold"),e("span",{class:"data-mono"},l)),i&&i.drift_detected&&e("div",{class:"text-xs mt-1",style:"color: var(--status-warning)"},"Page-Hinkley: drift at point ",i.drift_point," (score: ",i.drift_score,")")))})),e("div",{class:"flex items-center gap-4 text-xs pt-2",style:"color: var(--text-tertiary)"},e("div",{class:"flex items-center gap-1"},e("span",{class:"inline-block w-2 h-2 rounded-full",style:"background: var(--status-healthy)"}),e("span",null,"Stable")),e("div",{class:"flex items-center gap-1"},e("span",{class:"inline-block w-2 h-2 rounded-full",style:"background: var(--status-warning)"}),e("span",null,"Drift detected")))))}function Id({anomalies:t}){if(!t)return e(ee,{title:"Anomaly Detection",subtitle:"Anomaly detection flags things that look unusual compared to your home's normal patterns \u2014 like high power draw at 3 AM or unexpected device activity."},e(me,null,"Anomaly detection data is not yet available. It will appear after the first ML training cycle."));let a=t.anomalies||[],r=t.autoencoder,s=t.isolation_forest;return e(ee,{title:"Anomaly Detection",subtitle:"Anomaly detection flags things that look unusual compared to your home's normal patterns \u2014 like high power draw at 3 AM or unexpected device activity.",summary:a.length>0?`${a.length} anomal${a.length===1?"y":"ies"}`:"clear"},e("div",{class:"space-y-3"},e("div",{class:"flex items-center gap-3"},s&&e("span",{class:"text-xs font-medium rounded-full px-2.5 py-0.5",style:`background: ${s.contamination?"var(--accent-glow)":"var(--bg-inset)"}; color: ${s.contamination?"var(--accent)":"var(--text-tertiary)"}`},"Isolation Forest",s.contamination?` (${(s.contamination*100).toFixed(1)}%)`:""),r&&e("span",{class:"text-xs font-medium rounded-full px-2.5 py-0.5",style:`background: ${r.enabled?"var(--accent-glow)":"var(--bg-inset)"}; color: ${r.enabled?"var(--accent)":"var(--text-tertiary)"}`},"Autoencoder ",r.enabled?"active":"inactive")),a.length===0?e(me,null,"No anomalies detected. This means your home's behavior matches its normal patterns."):e("div",{class:"space-y-2"},a.map((n,o)=>e("div",{key:o,class:"t-frame p-3","data-label":"anomaly",style:"border-left: 3px solid var(--status-warning)"},e("div",{class:"flex items-center justify-between"},e("div",{class:"flex items-center gap-2"},e("span",{class:"inline-block w-2 h-2 rounded-full",style:"background: var(--status-warning)"}),e("span",{class:"text-xs font-bold",style:"color: var(--text-primary)"},n.entity_id||n.metric||"unknown")),e("span",{class:"text-xs",style:"color: var(--text-tertiary)"},St(n.timestamp))),e("div",{class:"flex items-center gap-4 mt-1 text-xs",style:"color: var(--text-secondary)"},e("span",null,"Score: ",e("span",{class:"data-mono",style:"color: var(--status-warning)"},typeof(n.score??n.severity)=="number"?(n.score??n.severity).toFixed(3):n.score??n.severity)),e("span",{class:"text-xs rounded-full px-2 py-0.5",style:"background: var(--bg-inset); color: var(--text-tertiary)"},n.type))))),e("div",{class:"flex items-center gap-4 text-xs pt-2",style:"color: var(--text-tertiary)"},e("div",{class:"flex items-center gap-1"},e("span",{class:"inline-block w-2 h-2 rounded-full",style:"background: var(--status-warning)"}),e("span",null,"Anomalous")),e("span",null,"Lower scores = more unusual"))))}function Nd({shap:t}){if(!t||!t.available)return e(ee,{title:"Feature Attributions (SHAP)",subtitle:"SHAP values explain WHY ARIA made a prediction. Each bar shows how much a feature pushed the prediction up or down. Longer bars = more influence."},e(me,null,"SHAP attributions are not yet available. They require trained ML models and are computed during prediction generation."));let a=t.attributions||[],r=Math.max(...a.map(s=>Math.abs(s.contribution)),.001);return e(ee,{title:"Feature Attributions (SHAP)",subtitle:"SHAP values explain WHY ARIA made a prediction. Each bar shows how much a feature pushed the prediction up or down. Longer bars = more influence.",summary:t.model_type||"active"},e("div",{class:"space-y-3"},t.model_type&&e("div",null,e("span",{class:"text-xs font-medium rounded-full px-2.5 py-0.5",style:"background: var(--accent-glow); color: var(--accent)"},t.model_type)),a.length>0?e("div",{class:"t-frame p-4","data-label":"attributions"},e("div",{class:"space-y-1"},a.map((s,n)=>e("div",{key:n,class:"flex items-center gap-2",style:"height: 24px;"},e("span",{class:"text-xs w-32 text-right truncate",style:"color: var(--text-secondary); flex-shrink: 0;"},s.feature.replace(/_/g," ")),e("div",{class:"flex-1 flex items-center",style:"position: relative; min-width: 0;"},e("div",{style:"position: absolute; left: 50%; width: 1px; height: 100%; background: var(--border-subtle);"}),e("div",{style:`
                      position: absolute;
                      ${s.direction==="positive"?"left: 50%":"right: 50%"};
                      width: ${Math.abs(s.contribution)/r*50}%;
                      height: 16px;
                      background: ${s.direction==="positive"?"var(--accent)":"var(--accent-purple)"};
                      opacity: 0.7;
                      border-radius: 2px;
                    `})),e("span",{class:"text-xs w-12 data-mono",style:"color: var(--text-tertiary); flex-shrink: 0;"},s.contribution>0?"+":"",s.contribution.toFixed(3)))))):e(me,null,"No feature attributions computed yet."),e("div",{class:"flex items-center gap-4 text-xs pt-2",style:"color: var(--text-tertiary)"},e("div",{class:"flex items-center gap-1"},e("span",{class:"inline-block w-3 h-3 rounded",style:"background: var(--accent); opacity: 0.7;"}),e("span",null,"Pushes prediction up")),e("div",{class:"flex items-center gap-1"},e("span",{class:"inline-block w-3 h-3 rounded",style:"background: var(--accent-purple); opacity: 0.7;"}),e("span",null,"Pushes prediction down")))))}function Jv({shadowAccuracy:t,pipeline:a}){if(!t&&!a)return null;let r=t?.predictions_total??0,s=t?.predictions_correct??0,n=t?.overall_accuracy??0,o=a?.current_stage||t?.stage||"backtest",l=Math.round(n*100),i=l>=70?"color: var(--status-healthy)":l>=40?"color: var(--status-warning)":"color: var(--status-error)",u=r>0?`${l}% accuracy`:o;return e(ee,{title:"Shadow Engine",subtitle:"Predict-compare-score loop running alongside the main engine.",summary:u},e("div",{class:"t-frame p-4","data-label":"shadow"},e("div",{class:"flex items-center justify-between"},e("div",{class:"flex items-center gap-4"},e("span",{class:"text-xs font-medium rounded-full px-2.5 py-0.5 capitalize",style:"background: var(--accent-glow); color: var(--accent)"},o),r>0?e("span",{class:"text-sm",style:"color: var(--text-secondary)"},e("span",{class:"font-bold",style:i},l,"%")," accuracy (",s,"/",r,")"):e("span",{class:"text-sm",style:"color: var(--text-tertiary)"},"No predictions yet")),e("a",{href:"#/shadow",class:"text-sm font-medium",style:"color: var(--accent)"},"Full details \u2192")),a&&(()=>{let d=a.current_stage||"backtest",f=(a.gates||{})[d];if(!f)return null;let m=a[f.field]??0,b=Math.min(100,Math.round(m/f.threshold*100)),h=m>=f.threshold;return e("div",{class:"mt-3 pt-3",style:"border-top: 1px solid var(--border-subtle)"},e("div",{class:"flex items-center justify-between text-xs mb-1"},e("span",{style:"color: var(--text-tertiary)"},"Gate: ",f.label," \u2265 ",Math.round(f.threshold*100),"%"),e("span",{class:h?"font-medium":"",style:h?"color: var(--status-healthy)":"color: var(--text-tertiary)"},Math.round(m*100),"%")),e("div",{class:"h-1.5 rounded-full",style:"background: var(--bg-inset)"},e("div",{class:"h-1.5 rounded-full",style:`background: ${h?"var(--status-healthy)":"var(--accent)"}; width: ${b}%`})))})()))}function Uo(){let{data:t,loading:a,error:r,refetch:s}=He("intelligence"),[n,o]=N(null),[l,i]=N(null),[u,d]=N(null),[y,f]=N(null),[m,b]=N(null);le(()=>{de("/api/shadow/accuracy").then(o).catch(()=>{}),de("/api/pipeline").then(i).catch(()=>{}),de("/api/ml/drift").then(d).catch(()=>{}),de("/api/ml/anomalies").then(f).catch(()=>{}),de("/api/ml/shap").then(b).catch(()=>{})},[]);let h=fe(()=>!t||!t.data?null:t.data,[t]);if(a&&!t)return e("div",{class:"space-y-6"},e("h1",{class:"text-2xl font-bold",style:"color: var(--text-primary)"},"Intelligence"),e(Se,{type:"cards"}));if(r)return e("div",{class:"space-y-6"},e("h1",{class:"text-2xl font-bold",style:"color: var(--text-primary)"},"Intelligence"),e(we,{error:r,onRetry:s}));if(!h)return e("div",{class:"space-y-6"},e("h1",{class:"text-2xl font-bold",style:"color: var(--text-primary)"},"Intelligence"),e(me,null,"Intelligence data is loading. The engine collects its first snapshot automatically via cron."));let A=(h.intraday_trend?.length>0?h.intraday_trend[h.intraday_trend.length-1]:null)?.power_watts??null,M=null;if(A!=null&&h.baselines){let k=new Date().toLocaleDateString("en-US",{weekday:"long"}),S=h.baselines[k];if(S?.power_watts?.mean!=null){let O=A-S.power_watts.mean,$=S.power_watts.mean>0?Math.round(O/S.power_watts.mean*100):0;Math.abs($)>=10?M=`${$>0?"+":""}${$}% vs ${k}`:M=`typical for ${k}`}}let _=Oe(()=>{let k=h.intraday_trend;if(!k||k.length<2)return null;let S=new Date;S.setHours(0,0,0,0);let O=Math.floor(S.getTime()/1e3),$=[],H=[];for(let I of k)$.push(O+(I.hour??0)*3600),H.push(I.power_watts??null);return[$,H]},[h.intraday_trend]);return e("div",{class:"space-y-8 animate-page-enter"},e(ie,{page:"INTELLIGENCE",subtitle:"Your home's learning engine \u2014 baselines, trends, correlations, and insights."}),e("div",{class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},e("div",{class:"sm:col-span-2"},e(Fe,{value:A,label:"home right now",unit:"W",delta:M,sparkData:_})),e(wd,{maturity:h.data_maturity,shadowStage:l?.current_stage,shadowAccuracy:n?.overall_accuracy}),e(Jv,{shadowAccuracy:n,pipeline:l}),e("div",{class:"sm:col-span-2"},e(Sd,{intraday:h.intraday_trend,baselines:h.baselines})),e("div",{class:"sm:col-span-2"},e(Cd,{activity:h.activity})),e(Td,{trendData:h.trend_data,intradayTrend:h.intraday_trend}),e(Md,{predictions:h.predictions,intradayTrend:h.intraday_trend}),e(Pd,{baselines:h.baselines}),e($d,{insight:h.daily_insight}),e(Ld,{correlations:h.entity_correlations?.top_co_occurrences}),e(Dd,{runLog:h.run_log,mlModels:h.ml_models,metaLearning:h.meta_learning}),e(Rd,{drift:u}),e(Id,{anomalies:y}),e("div",{class:"sm:col-span-2"},e(Nd,{shap:m})),e("div",{class:"sm:col-span-2"},e(ee,{title:"Configuration",subtitle:"Engine parameters are now managed in Settings."},e("div",{class:"t-callout p-3 text-sm flex items-center justify-between"},e("span",null,"Engine settings have moved to the dedicated Settings page."),e("a",{href:"#/settings",class:"font-medium whitespace-nowrap",style:"color: var(--accent)"},"Settings \u2192"))))))}function Go({children:t}){return e("div",{class:"t-callout p-3 text-sm"},t)}function qs({label:t,color:a}){return e("span",{class:"data-mono",style:`display: inline-block; font-size: var(--type-label); padding: 2px 8px; border-radius: var(--radius); background: ${a}; color: var(--bg-base); font-weight: 600;`},t)}function Zv(t){switch(t){case"stable":return"var(--status-healthy)";case"behavioral_drift":return"var(--status-warning)";case"meta_learner_error":return"var(--status-error)";case"meta_learner_improvement":return"var(--accent)";default:return"var(--text-tertiary)"}}function Vo(t){if(!t)return"\u2014";let a=new Date(t);return isNaN(a.getTime())?"\u2014":a.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}function Wo(t){return t==null?"\u2014":`${(t*100).toFixed(1)}%`}function Qv({features:t,loading:a}){let r=t?.selected||[],s=t?.total||0,n=t?.method||"none",o=t?.last_computed,l=r.length===0,i={mrmr:"mRMR",importance:"Importance",none:"None"};return e(vt,{title:"Feature Selection",subtitle:"mRMR-ranked input signals",summary:l?"not yet computed":`${r.length} of ${s}`,defaultOpen:!0,loading:a},l?e(Go,null,"Feature selection data is not yet available. It will populate once ML models are trained and mRMR feature ranking is computed."):e("div",{class:"space-y-4"},e(Fe,{value:`${r.length} of ${s}`,label:"Selected Features"}),e("div",{class:"flex items-center gap-3 flex-wrap",style:"margin-top: 12px;"},e(qs,{label:i[n]||n,color:"var(--accent)"}),o&&e("span",{class:"data-mono",style:"font-size: var(--type-label); color: var(--text-tertiary);"},"computed ",Vo(o))),e("div",{class:"t-frame","data-label":"Ranked Features"},e("ol",{style:"list-style: none; padding: 0; margin: 0;"},r.map((u,d)=>e("li",{key:u,style:`display: flex; align-items: center; gap: 8px; padding: 6px 0; font-family: var(--font-mono); font-size: var(--type-body); color: var(--text-primary);${d>0?" border-top: 1px solid var(--border-subtle);":""}`},e("span",{class:"data-mono",style:"min-width: 28px; text-align: right; color: var(--text-tertiary); font-size: var(--type-label);"},d+1,"."),e("span",null,u))))),e("p",{style:"font-size: var(--type-label); color: var(--text-tertiary); line-height: 1.5; margin-top: 8px;"},"Feature selection picks the most informative signals from your home's data. Using mRMR (minimum Redundancy Maximum Relevance), ARIA selects features that are individually useful but not redundant with each other.")))}function Xv({models:t,loading:a}){let r=t?.reference,s=t?.incremental,n=t?.forecaster,o=!r&&!s&&!n;return e(vt,{title:"Model Health",subtitle:"Reference comparison, training mode, forecaster",summary:o?"awaiting data":r?.interpretation||"active",defaultOpen:!0,loading:a},o?e(Go,null,"Model health data is not yet available. It will populate once ML models are trained and reference model comparison is active."):e("div",{class:"space-y-4"},r&&e("div",{class:"t-frame","data-label":"Reference Model"},e("div",{class:"flex items-center gap-3 flex-wrap",style:"margin-bottom: 12px;"},e(qs,{label:r.interpretation||"unknown",color:Zv(r.interpretation)})),e("div",{class:"grid grid-cols-1 sm:grid-cols-3 gap-3"},e("div",{class:"t-frame","data-label":"Primary Trend"},e("span",{class:"data-mono",style:"font-size: var(--type-headline); color: var(--text-primary);"},r.primary_trend!=null?Wo(r.primary_trend):"\u2014")),e("div",{class:"t-frame","data-label":"Reference Trend"},e("span",{class:"data-mono",style:"font-size: var(--type-headline); color: var(--text-primary);"},r.reference_trend!=null?Wo(r.reference_trend):"\u2014")),e("div",{class:"t-frame","data-label":"Divergence"},e("span",{class:"data-mono",style:"font-size: var(--type-headline); color: var(--text-primary);"},(r.divergence??r.divergence_pct)!=null?Wo(r.divergence??r.divergence_pct):"\u2014"))),e("p",{style:"font-size: var(--type-label); color: var(--text-tertiary); line-height: 1.5; margin-top: 12px;"},"A reference model runs alongside ARIA's main model without any meta-learning adjustments. Comparing the two reveals whether accuracy changes come from your home changing (drift) or from ARIA's learning process.")),s&&e("div",{class:"t-frame","data-label":"Incremental Training"},e("div",{class:"flex items-center gap-3 flex-wrap",style:"margin-bottom: 12px;"},e(qs,{label:s.mode==="incremental"?"Incremental":"Full Retrain",color:s.mode==="incremental"?"var(--accent)":"var(--text-secondary)"}),s.tree_count!=null&&e("span",{class:"data-mono",style:"font-size: var(--type-label); color: var(--text-tertiary);"},s.tree_count," / ",s.max_trees||"\u2014"," trees")),e("p",{style:"font-size: var(--type-label); color: var(--text-tertiary); line-height: 1.5;"},"Instead of rebuilding models from scratch, incremental training adds new trees to existing models \u2014 faster and preserves learned knowledge.")),n&&e("div",{class:"t-frame","data-label":"Forecaster Backend"},e("div",{class:"flex items-center gap-3 flex-wrap"},e(qs,{label:n.backend||"auto",color:"var(--accent)"}),n.backend==="neuralprophet"&&n.config&&e("span",{class:"data-mono",style:"font-size: var(--type-label); color: var(--text-tertiary);"},"AR(",n.config.ar_order||"?",") \xB7 ",n.config.epochs||"?"," epochs \xB7 lr ",n.config.learning_rate||"?")))))}function em({models:t,loading:a}){let r=t?.ml_models,s=!r,n=r?.last_trained,o=r?.scores,l=o&&typeof o=="object"&&Object.keys(o).length>0;return e(vt,{title:"Training History",subtitle:"Last retrain and model accuracy",summary:s?"no data":n?Vo(n):"pending",defaultOpen:!0,loading:a},s?e(Go,null,"Training history is not yet available. It will populate after ARIA completes its first model training run."):e("div",{class:"space-y-4"},n&&e("div",{class:"t-frame","data-label":"Last Trained"},e("span",{class:"data-mono",style:"font-size: var(--type-headline); color: var(--accent);"},Vo(n))),l&&e("div",{class:"t-frame","data-label":"Model Scores"},e("div",{style:"overflow-x: auto;"},e("table",{style:"width: 100%; border-collapse: collapse; font-family: var(--font-mono); font-size: var(--type-body);"},e("thead",null,e("tr",{style:"border-bottom: 2px solid var(--border-subtle);"},e("th",{style:"text-align: left; padding: 8px 12px; color: var(--text-secondary); font-weight: 600;"},"Model"),e("th",{style:"text-align: right; padding: 8px 12px; color: var(--text-secondary); font-weight: 600;"},"R\xB2"),e("th",{style:"text-align: right; padding: 8px 12px; color: var(--text-secondary); font-weight: 600;"},"MAE"))),e("tbody",null,Object.entries(o).map(([i,u])=>e("tr",{key:i,style:"border-bottom: 1px solid var(--border-subtle);"},e("td",{style:"padding: 8px 12px; color: var(--text-primary);"},i),e("td",{style:"text-align: right; padding: 8px 12px; color: var(--accent);"},u?.r2!=null?u.r2.toFixed(3):"\u2014"),e("td",{style:"text-align: right; padding: 8px 12px; color: var(--text-primary);"},u?.mae!=null?u.mae.toFixed(3):"\u2014"))))))),e("p",{style:"font-size: var(--type-label); color: var(--text-tertiary); line-height: 1.5; margin-top: 8px;"},"Training history shows when ARIA last retrained its models and how accurate they are. R\xB2 measures how well the model explains variance (1.0 = perfect), MAE measures average prediction error (lower = better).")))}function qo(){let[t,a]=N(null),[r,s]=N(null),[n,o]=N(null),[l,i]=N(!0),[u,d]=N(null);function y(){i(!0),d(null),Promise.all([de("/api/ml/features"),de("/api/ml/models"),de("/api/ml/drift")]).then(([f,m,b])=>{a(f),s(m),o(b)}).catch(f=>d(f)).finally(()=>i(!1))}return le(()=>{y()},[]),u?e("div",{class:"space-y-6"},e(ie,{page:"MLENGINE"}),e(we,{error:u,onRetry:y})):l?e("div",{class:"space-y-6"},e(ie,{page:"MLENGINE"}),e(Se,{type:"full"})):e("div",{class:"space-y-6 animate-page-enter"},e(ie,{page:"MLENGINE",subtitle:"Feature selection, model health, and training history"}),e(Qv,{features:t,loading:!1}),e(Xv,{models:r,loading:!1}),e(em,{models:r,loading:!1}))}var Od=["backtest","shadow","suggest","autonomous"],Hd={next_domain_action:"background: var(--accent-glow); color: var(--accent);",room_activation:"background: var(--accent-purple-glow); color: var(--accent-purple);",routine_trigger:"background: var(--status-warning-glow); color: var(--status-warning);"},zd={next_domain_action:"Domain",room_activation:"Room",routine_trigger:"Routine"},tm={correct:"background: var(--status-healthy-glow); color: var(--status-healthy);",disagreement:"background: var(--status-warning-glow); color: var(--status-warning);",nothing:"background: var(--bg-surface-raised); color: var(--text-tertiary);"},Fd={backtest:{field:"backtest_accuracy",threshold:.4,label:"backtest accuracy"},shadow:{field:"shadow_accuracy_7d",threshold:.5,label:"7-day shadow accuracy"},suggest:{field:"suggest_approval_rate_14d",threshold:.7,label:"14-day approval rate"}};function am({pipeline:t,onAdvance:a,onRetreat:r,advanceError:s}){let n=t?.stages||Od,o=t?.gates||Fd,l=t?.current_stage||"backtest",i=n.indexOf(l),u=Math.max((i+1)/n.length*100,10),d=t?.stage_entered_at,y=o[l],f=y?t?.[y.field]??0:null,m=y?f>=y.threshold:!1,b=i<n.length-1?n[i+1]:null;return e("section",{class:"space-y-3"},e("div",{class:"t-section-header",style:"padding-bottom: 6px;"},e("h2",{class:"text-lg font-bold",style:"color: var(--text-primary)"},"Pipeline Stage")),e("div",{class:"t-frame","data-label":`stage: ${l}`,style:"padding: 1rem;"},e("div",{class:"space-y-4"},e("div",null,e("div",{class:"flex justify-between text-xs mb-1",style:"color: var(--text-tertiary)"},n.map((h,C)=>e("span",{key:h,class:"capitalize",style:C<=i?"font-weight: 700; color: var(--accent)":""},h))),e("div",{class:"h-3 rounded-full",style:"background: var(--bg-inset)"},e("div",{class:"h-3 rounded-full transition-all",style:`background: var(--accent); width: ${u}%`}))),d&&e("p",{class:"text-xs",style:"color: var(--text-tertiary)"},"In ",l," since ",new Date(d).toLocaleDateString()),e("div",{class:"flex items-center gap-2 mt-3"},e("button",{onClick:r,disabled:i===0,class:"t-btn t-btn-secondary text-xs px-3 py-1.5"},"\u2190 Retreat"),e("button",{onClick:a,disabled:i===n.length-1,class:"t-btn t-btn-primary text-xs px-3 py-1.5"},"Advance \u2192")),y&&e("p",{class:"text-xs",style:m?"color: var(--status-healthy)":"color: var(--status-error)"},"Advance",b?` to ${b}`:""," requires >",Math.round(y.threshold*100),"% ",y.label," ","(current: ",Math.round(f*100),"%)"),s&&e("p",{class:"text-xs font-medium",style:"color: var(--status-error)"},s))))}function rm({accuracy:t,pipeline:a}){let r=t?.overall_accuracy??0,s=t?.predictions_total??0,n=t?.predictions_correct??0,o=t?.predictions_disagreement??0,l=t?.predictions_nothing??0,i=a?.current_stage||"backtest",u=[{label:"Accuracy",value:`${Math.round(r*100)}%`,colorStyle:fd(r*100)},{label:"Total Predictions",value:s},{label:"Correct",value:n},{label:"Disagreements",value:o}];return e("section",{class:"space-y-3"},e("div",{class:"flex items-center gap-3 t-section-header",style:"padding-bottom: 6px;"},e("h2",{class:"text-lg font-bold",style:"color: var(--text-primary)"},"Accuracy"),e("span",{class:"text-xs font-medium rounded-full px-2.5 py-0.5 capitalize",style:"background: var(--accent-glow); color: var(--accent)"},i)),e("div",{class:"grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-4 gap-4"},u.map((d,y)=>e("div",{key:y,class:"t-frame","data-label":d.label.toLowerCase(),style:"padding: 1rem;"},e("div",{class:"text-2xl font-bold",style:d.colorStyle||"color: var(--accent)"},d.value),e("div",{class:"text-sm mt-1",style:"color: var(--text-tertiary)"},d.label)))),l>0&&e("p",{class:"text-xs px-1",style:"color: var(--text-tertiary)"},l," prediction",l!==1?"s":""," had no matching outcome (expired with no activity)."))}function sm({accuracy:t}){let a=t?.thompson_sampling;if(!a||!a.buckets||Object.keys(a.buckets).length===0)return e("section",{class:"space-y-3"},e("div",{class:"t-section-header",style:"padding-bottom: 6px;"},e("h2",{class:"text-lg font-bold",style:"color: var(--text-primary)"},"Thompson Sampling")),e("div",{class:"t-callout",style:"padding: 0.75rem;"},e("span",{class:"text-sm",style:"color: var(--text-secondary)"},"Thompson sampling stats will appear after the shadow engine has made predictions.")));let r=Object.keys(a.buckets);return e("section",{class:"space-y-3"},e("div",{class:"t-section-header",style:"padding-bottom: 6px;"},e("h2",{class:"text-lg font-bold",style:"color: var(--text-primary)"},"Thompson Sampling")),e("p",{class:"text-xs",style:"color: var(--text-tertiary)"},"Thompson Sampling decides which predictions to try. Each time-of-day slot builds its own confidence \u2014 ARIA explores more in uncertain slots and exploits what works in confident ones."),e("div",{class:"flex items-center gap-3 flex-wrap"},e("span",{class:"text-xs font-medium rounded-full px-2.5 py-0.5 capitalize",style:"background: var(--accent-glow); color: var(--accent)"},a.strategy),e("span",{class:"text-xs",style:"color: var(--text-tertiary)"},"discount: ",e("span",{style:"color: var(--text-secondary); font-weight: 600;"},a.discount_factor)),e("span",{class:"text-xs",style:"color: var(--text-tertiary)"},"window: ",e("span",{style:"color: var(--text-secondary); font-weight: 600;"},a.window_size))),e("div",{class:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3"},r.map(s=>{let n=a.buckets[s],o=n.explore_rate>.5?"color: var(--status-warning)":"color: var(--status-healthy)";return e("div",{key:s,class:"t-frame","data-label":s,style:"padding: 0.75rem;"},e("div",{class:"text-lg font-bold",style:"color: var(--accent)"},n.alpha,"/",n.beta),e("div",{class:"text-xs mt-1",style:"color: var(--text-tertiary)"},"alpha/beta"),e("div",{class:"text-sm font-bold mt-2",style:o},Math.round(n.explore_rate*100),"%"),e("div",{class:"text-xs",style:"color: var(--text-tertiary)"},"explore rate"),e("div",{class:"text-xs mt-1",style:"color: var(--text-secondary)"},n.samples," samples"))})))}function nm({propagation:t}){if(!t||t.enabled===!1)return e("section",{class:"space-y-3"},e("div",{class:"t-section-header",style:"padding-bottom: 6px;"},e("h2",{class:"text-lg font-bold",style:"color: var(--text-primary)"},"Correction Propagation")),e("div",{class:"t-callout",style:"padding: 0.75rem;"},e("span",{class:"text-sm",style:"color: var(--text-secondary)"},"Correction propagation is not active. It will activate once the shadow engine has enough prediction data to propagate corrections.")));let a=t.stats||{},r=a.replay_buffer_size??0,s=a.replay_buffer_capacity??1,n=s>0?Math.round(r/s*100):0;return e("section",{class:"space-y-3"},e("div",{class:"flex items-center gap-3 t-section-header",style:"padding-bottom: 6px;"},e("h2",{class:"text-lg font-bold",style:"color: var(--text-primary)"},"Correction Propagation"),e("span",{class:"text-xs font-medium rounded-full px-2.5 py-0.5",style:"background: var(--status-healthy-glow); color: var(--status-healthy)"},"enabled")),e("p",{class:"text-xs",style:"color: var(--text-tertiary)"},"When ARIA gets a prediction wrong, it propagates the correction to similar situations nearby in time and space. The replay buffer stores recent corrections for learning."),e("div",{class:"grid grid-cols-1 sm:grid-cols-3 gap-4"},e("div",{class:"t-frame","data-label":"replay buffer",style:"padding: 1rem;"},e("div",{class:"text-2xl font-bold",style:"color: var(--accent)"},r," / ",s),e("div",{class:"text-sm mt-1",style:"color: var(--text-tertiary)"},"replay buffer"),e("div",{class:"h-1.5 rounded-full mt-2",style:"background: var(--bg-inset)"},e("div",{class:"h-1.5 rounded-full",style:`background: var(--accent); width: ${n}%`}))),e("div",{class:"t-frame","data-label":"cell observations",style:"padding: 1rem;"},e("div",{class:"text-2xl font-bold",style:"color: var(--accent)"},a.cell_observations??0),e("div",{class:"text-sm mt-1",style:"color: var(--text-tertiary)"},"cell observations")),e("div",{class:"t-frame","data-label":"kernel bandwidth",style:"padding: 1rem;"},e("div",{class:"text-2xl font-bold",style:"color: var(--accent)"},a.bandwidth??0),e("div",{class:"text-sm mt-1",style:"color: var(--text-tertiary)"},"kernel bandwidth"))))}function om({trend:t,pipeline:a}){let r=a?.gates||Fd,s=a?.stages||Od,n=a?.current_stage||"backtest",o=r[n],l=o?Math.round(o.threshold*100):null,i=s.indexOf(n),u=i<s.length-1?s[i+1]:null,{chartData:d,chartSeries:y}=Oe(()=>{if(!t||t.length===0)return{chartData:null,chartSeries:[]};let f=[],m=[],b=[];for(let C of t){let A=Math.floor(new Date(C.date+"T12:00:00Z").getTime()/1e3);f.push(A),m.push(C.accuracy??null),b.push(C.count??0)}let h=[];for(let C=0;C<m.length;C++){let A=Math.max(0,C-6),M=0,_=0;for(let k=A;k<=C;k++)m[k]!=null&&(M+=m[k],_++);h.push(_>0?M/_:null)}return{chartData:[f,h,b],chartSeries:[{label:"7-day Accuracy",color:"var(--accent)",width:2},{label:"Predictions",color:"var(--text-tertiary)",width:1}]}},[t]);return!t||t.length===0?e("section",{class:"space-y-3"},e("div",{class:"t-section-header",style:"padding-bottom: 6px;"},e("h2",{class:"text-lg font-bold",style:"color: var(--text-primary)"},"Daily Trend")),e("div",{class:"t-callout",style:"padding: 0.75rem;"},e("span",{class:"text-sm",style:"color: var(--text-secondary)"},"Accuracy trends will appear after 24-48 hours of predictions."))):e("section",{class:"space-y-3"},e("h2",{class:"text-lg font-bold",style:"color: var(--text-primary)"},"Daily Trend"),e("p",{class:"text-xs",style:"color: var(--text-tertiary)"},"How accurate are ARIA's predictions over time? The line smooths out daily swings to show the real trend. Higher = better guesses."),e("div",{class:"t-frame","data-label":"accuracy trend",style:"padding: 1rem;"},e(Ha,{data:d,series:y,height:160}),e("div",{class:"flex flex-wrap items-center gap-3 mt-2 pt-2",style:"border-top: 1px solid var(--border-subtle); font-size: var(--type-micro); color: var(--text-tertiary);"},e("div",{class:"flex items-center gap-1"},e("span",{style:"display: inline-block; width: 16px; height: 2px; background: var(--accent);"}),e("span",null,"7-day rolling accuracy")),e("div",{class:"flex items-center gap-1"},e("span",{style:"display: inline-block; width: 16px; height: 2px; background: var(--text-tertiary);"}),e("span",null,"Predictions per day"))),l!=null&&e("p",{class:"text-xs mt-2",style:"color: var(--text-tertiary)"},"Gate threshold: ",e("span",{style:"color: var(--accent); font-weight: 600;"},l,"%")," ",o.label," required",u?` to advance to ${u}`:"")))}function lm({predictions:t}){let a=t?.predictions||[];return a.length===0?e("section",{class:"space-y-3"},e("div",{class:"t-section-header",style:"padding-bottom: 6px;"},e("h2",{class:"text-lg font-bold",style:"color: var(--text-primary)"},"Recent Predictions")),e("div",{class:"t-callout",style:"padding: 0.75rem;"},e("span",{class:"text-sm",style:"color: var(--text-secondary)"},"No predictions yet. The shadow engine generates predictions when state changes occur."))):e("section",{class:"space-y-3"},e("h2",{class:"text-lg font-bold",style:"color: var(--text-primary)"},"Recent Predictions"),e("div",{class:"t-frame","data-label":"recent predictions",style:"padding: 0;"},a.map((r,s)=>{let n=Hd[r.prediction_type]||"background: var(--bg-surface-raised); color: var(--text-secondary);",o=zd[r.prediction_type]||r.prediction_type,l=r.outcome?tm[r.outcome]:null,i=r.confidence??0;return e("div",{key:s,class:"flex items-center gap-3 px-4 py-2.5",style:s>0?"border-top: 1px solid var(--border-subtle)":""},e("span",{class:"text-xs w-14 flex-shrink-0",style:"color: var(--text-tertiary)"},St(r.timestamp)),e("span",{class:"text-xs font-medium flex-shrink-0 px-1.5 py-0.5",style:`border-radius: var(--radius); ${n}`},o),e("span",{class:"text-sm flex-1 truncate",style:"color: var(--text-secondary)"},r.predicted_value||"\u2014"),e("div",{class:"w-16 flex-shrink-0"},e("div",{class:"h-1.5 rounded-full",style:"background: var(--bg-inset)"},e("div",{class:"h-1.5 rounded-full",style:`background: var(--accent-dim); width: ${Math.round(i*100)}%`}))),l&&e("span",{class:"text-xs font-medium flex-shrink-0 capitalize px-1.5 py-0.5",style:`border-radius: var(--radius); ${l}`},r.outcome))})))}function im({disagreements:t}){let a=t?.disagreements||[];return a.length===0?e("section",{class:"space-y-3"},e("div",{class:"t-section-header",style:"padding-bottom: 6px;"},e("h2",{class:"text-lg font-bold",style:"color: var(--text-primary)"},"Top Disagreements")),e("div",{class:"t-callout",style:"padding: 0.75rem;"},e("span",{class:"text-sm",style:"color: var(--status-healthy)"},"No disagreements recorded yet."))):e("section",{class:"space-y-3"},e("h2",{class:"text-lg font-bold",style:"color: var(--text-primary)"},"Top Disagreements"),e("p",{class:"text-xs",style:"color: var(--text-tertiary)"},"High-confidence wrong predictions \u2014 the most informative for learning."),e("div",{class:"space-y-2"},a.map((r,s)=>{let n=Hd[r.prediction_type]||"background: var(--bg-surface-raised); color: var(--text-secondary);",o=zd[r.prediction_type]||r.prediction_type,l=r.confidence??0;return e("div",{key:s,class:"t-frame p-3 space-y-1","data-label":"disagreement",style:"border-left: 4px solid var(--status-warning);"},e("div",{class:"flex items-center gap-2"},e("span",{class:"text-lg font-bold",style:"color: var(--status-warning)"},Math.round(l*100),"%"),e("span",{class:"text-xs font-medium px-1.5 py-0.5",style:`border-radius: var(--radius); ${n}`},o),e("span",{class:"text-xs ml-auto",style:"color: var(--text-tertiary)"},St(r.timestamp))),e("div",{class:"text-sm",style:"color: var(--text-secondary)"},e("span",{style:"color: var(--text-tertiary)"},"Predicted:")," ",r.predicted_value||"\u2014"),r.actual_value&&e("div",{class:"text-sm",style:"color: var(--text-secondary)"},e("span",{style:"color: var(--text-tertiary)"},"Actual:")," ",r.actual_value))})))}function Yo(){let[t,a]=N(null),[r,s]=N(null),[n,o]=N(null),[l,i]=N(null),[u,d]=N(null),[y,f]=N(!0),[m,b]=N(null),[h,C]=N(null);async function A(){C(null);try{let k=await fetch(`${pa}/api/pipeline/advance`,{method:"POST",headers:{"Content-Type":"application/json"},body:"{}"});if(!k.ok){let S=await k.json().catch(()=>({}));S.error==="Gate not met"?C(`Gate not met: ${S.gate} requires ${Math.round(S.required*100)}%, current ${Math.round(S.current*100)}%`):C(S.detail||S.error||`HTTP ${k.status}`);return}await _()}catch(k){C(k.message||String(k))}}async function M(){C(null);try{let k=await fetch(`${pa}/api/pipeline/retreat`,{method:"POST",headers:{"Content-Type":"application/json"},body:"{}"});if(!k.ok){let S=await k.json().catch(()=>({}));C(S.detail||S.error||`HTTP ${k.status}`);return}await _()}catch(k){C(k.message||String(k))}}async function _(){f(!0),b(null);try{let[k,S,O,$,H]=await Promise.all([de("/api/pipeline"),de("/api/shadow/accuracy"),de(`/api/shadow/predictions?limit=${vd}`),de(`/api/shadow/disagreements?limit=${md}`),de("/api/shadow/propagation")]);a(k),s(S),o(O),i($),d(H)}catch(k){b(k.message||String(k))}finally{f(!1)}}return le(()=>{_()},[]),y&&!t?e("div",{class:"space-y-6"},e("div",null,e("h1",{class:"text-2xl font-bold",style:"color: var(--text-primary)"},"Shadow Mode"),e("p",{class:"text-sm",style:"color: var(--text-tertiary)"},"Prediction accuracy, pipeline progress, and learning insights.")),e(Se,{type:"full"})):m?e("div",{class:"space-y-6"},e("div",null,e("h1",{class:"text-2xl font-bold",style:"color: var(--text-primary)"},"Shadow Mode"),e("p",{class:"text-sm",style:"color: var(--text-tertiary)"},"Prediction accuracy, pipeline progress, and learning insights.")),e(we,{error:m,onRetry:_})):e("div",{class:"space-y-8 animate-page-enter"},e(ie,{page:"SHADOW",subtitle:"Predict-compare-score validation loop."}),e(Fe,{value:Math.round((r?.overall_accuracy??0)*100),label:"shadow accuracy",unit:"%",delta:`${t?.current_stage||"backtest"} stage \u2022 ${r?.predictions_total??0} predictions`,sparkData:Oe(()=>{let k=r?.daily_trend;if(!k||k.length<2)return null;let S=[],O=[];for(let $ of k)S.push(Math.floor(new Date($.date+"T12:00:00Z").getTime()/1e3)),O.push($.accuracy??null);return[S,O]},[r])}),e(am,{pipeline:t,onAdvance:A,onRetreat:M,advanceError:h}),e(rm,{accuracy:r,pipeline:t}),e(sm,{accuracy:r}),e(om,{trend:r?.daily_trend,pipeline:t}),e("div",{class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},e(lm,{predictions:n}),e(im,{disagreements:l})),e(nm,{propagation:u}))}function cm(t){let a={};for(let r of t){let s=r.category||"Other";a[s]||(a[s]=[]),a[s].push(r)}return a}function dm({config:t,onUpdate:a}){let[r,s]=N(t.value),[n,o]=N(!1),l=$t(null),i=t.value===t.default_value;le(()=>{s(t.value)},[t.value]);function u(f){s(f),l.current&&clearTimeout(l.current),l.current=setTimeout(async()=>{o(!0);try{await fa(`/api/config/${t.key}`,{value:String(f)}),a()}catch(m){console.error("Config save failed:",m)}finally{o(!1)}},500)}async function d(){o(!0);try{await _s(`/api/config/reset/${t.key}`,{}),s(t.default_value),a()}catch(f){console.error("Config reset failed:",f)}finally{o(!1)}}let y=t.value_type;return e("div",{class:"flex flex-col sm:flex-row sm:items-center gap-2 py-3",style:"border-bottom: 1px solid var(--border-subtle)"},e("div",{class:"flex-1 min-w-0"},e("div",{class:"flex items-center gap-2"},e("span",{class:"text-sm font-medium",style:"color: var(--text-secondary)"},t.label||t.key),n&&e("span",{class:"text-xs",style:"color: var(--accent)"},"Saving...")),t.description&&e("p",{class:"text-xs mt-0.5",style:"color: var(--text-tertiary)"},t.description)),e("div",{class:"flex items-center gap-2 flex-shrink-0"},y==="number"&&e("div",{class:"flex items-center gap-2"},e("input",{type:"range",min:t.min_value??0,max:t.max_value??100,step:t.step??1,value:r,onInput:f=>u(f.target.value),class:"w-28",style:"accent-color: var(--accent)"}),e("span",{class:"text-sm w-16 text-right data-mono",style:"color: var(--text-secondary)"},r)),y==="boolean"&&e("button",{class:"relative w-10 h-5 rounded-full transition-colors",style:r==="true"||r==="1"?"background: var(--accent)":"background: var(--bg-inset)",onClick:()=>u(r==="true"||r==="1"?"false":"true")},e("span",{class:`absolute top-0.5 w-4 h-4 rounded-full shadow transition-transform ${r==="true"||r==="1"?"translate-x-5":"translate-x-0.5"}`,style:"background: var(--bg-surface)"})),y==="string"&&e("input",{type:"text",value:r,onInput:f=>u(f.target.value),class:"t-input px-2 py-1 text-sm w-48"}),y==="select"&&e("select",{value:r,onChange:f=>u(f.target.value),class:"t-input px-2 py-1 text-sm"},(t.options||"").split(",").map(f=>e("option",{key:f.trim(),value:f.trim()},f.trim()))),e("button",{onClick:d,disabled:i,class:"text-xs px-2 py-1",style:`border-radius: var(--radius); ${i?"color: var(--text-tertiary); cursor: default;":"color: var(--accent); cursor: pointer;"}`},"Reset")))}function um({category:t,configs:a,onUpdate:r}){let[s,n]=N(!0);return e("section",{class:"t-frame","data-label":t.toLowerCase()},e("button",{class:"w-full flex items-center justify-between px-4 py-3 text-left",onClick:()=>n(!s)},e("h3",{class:"text-sm font-bold",style:"color: var(--text-secondary)"},t),e("span",{class:"text-xs",style:"color: var(--text-tertiary)"},s?"\u25B2":"\u25BC"," ",a.length," param",a.length!==1?"s":"")),s&&e("div",{class:"px-4 pb-3"},a.map(o=>e(dm,{key:o.key,config:o,onUpdate:r}))))}function Ko(){let[t,a]=N([]),[r,s]=N(!0),[n,o]=N(null);async function l(){try{let d=await de("/api/config");a(d.configs||[])}catch(d){o(d.message||String(d))}finally{s(!1)}}if(le(()=>{l()},[]),r&&t.length===0)return e("div",{class:"space-y-6"},e("div",null,e("h1",{class:"text-2xl font-bold",style:"color: var(--text-primary)"},"Settings"),e("p",{class:"text-sm",style:"color: var(--text-tertiary)"},"Configure shadow engine, activity monitor, and data quality parameters.")),e(Se,{type:"full"}));if(n)return e("div",{class:"space-y-6"},e("div",null,e("h1",{class:"text-2xl font-bold",style:"color: var(--text-primary)"},"Settings"),e("p",{class:"text-sm",style:"color: var(--text-tertiary)"},"Configure shadow engine, activity monitor, and data quality parameters.")),e(we,{error:n,onRetry:l}));let i=cm(t),u=t.filter(d=>d.value!==d.default_value).length;return e("div",{class:"space-y-6 animate-page-enter"},e(ie,{page:"SETTINGS",subtitle:`${t.length} parameters across ${Object.keys(i).length} categories.${u>0?` ${u} modified from defaults.`:""}`}),e("div",{class:"space-y-4"},Object.entries(i).map(([d,y])=>e(um,{key:d,category:d,configs:y,onUpdate:l}))))}var pm={auto_excluded:"background: var(--bg-surface-raised); color: var(--text-tertiary);",excluded:"background: var(--status-error-glow); color: var(--status-error);",included:"background: var(--status-healthy-glow); color: var(--status-healthy);",promoted:"background: var(--accent-glow); color: var(--accent);"};function fm({summary:t}){let a=t?.total??0,r=t?.per_status??{},s=[{label:"Total",value:a,style:"color: var(--text-secondary)"},{label:"Auto-Excluded",value:r.auto_excluded??0,style:"color: var(--text-tertiary)"},{label:"Excluded",value:r.excluded??0,style:"color: var(--status-error)"},{label:"Included",value:r.included??0,style:"color: var(--status-healthy)"},{label:"Promoted",value:r.promoted??0,style:"color: var(--accent)"}];return e("div",{class:"grid grid-cols-2 sm:grid-cols-5 gap-3"},s.map(n=>e("div",{key:n.label,class:"t-frame","data-label":n.label,style:"padding: 0.75rem; text-align: center;"},e("div",{class:"text-xl font-bold",style:n.style},n.value),e("div",{class:"text-xs",style:"color: var(--text-tertiary)"},n.label))))}function Jo({tier:t,label:a,entities:r,defaultOpen:s,onOverride:n,onBulk:o}){let[l,i]=N(s),[u,d]=N(""),y=u?r.filter(m=>m.entity_id.toLowerCase().includes(u.toLowerCase())||(m.reason||"").toLowerCase().includes(u.toLowerCase())):r,f={};for(let m of y){let b=t===1?m.reason||"Other":m.group_id||m.entity_id;f[b]||(f[b]=[]),f[b].push(m)}return e("section",{class:"t-frame","data-label":`tier ${t}: ${a.toLowerCase()}`},e("button",{class:"w-full flex items-center justify-between px-4 py-3 text-left",onClick:()=>i(!l)},e("div",{class:"flex items-center gap-2"},e("h3",{class:"text-sm font-bold",style:"color: var(--text-secondary)"},"Tier ",t,": ",a),e("span",{class:"text-xs rounded-full px-2 py-0.5",style:"background: var(--bg-surface-raised); color: var(--text-tertiary)"},r.length)),e("span",{class:"text-xs",style:"color: var(--text-tertiary)"},l?"\u25B2":"\u25BC")),l&&e("div",{class:"px-4 pb-3 space-y-3"},r.length>10&&e("input",{type:"text",placeholder:"Search entity or reason...",value:u,onInput:m=>d(m.target.value),class:"t-input w-full px-3 py-1.5 text-sm"}),t<=2?Object.entries(f).map(([m,b])=>e("div",{key:m,class:"p-3 space-y-2",style:"border: 1px solid var(--border-subtle); border-radius: var(--radius)"},e("div",{class:"flex items-center justify-between"},e("span",{class:"text-xs font-medium truncate",style:"color: var(--text-secondary)"},m),e("div",{class:"flex gap-1 flex-shrink-0"},t===1&&e("button",{class:"t-btn text-xs px-2 py-0.5",style:"background: var(--status-healthy-glow); color: var(--status-healthy); border: none;",onClick:()=>o(b.map(h=>h.entity_id),"included")},"Include All"),t===2&&e(W,null,e("button",{class:"t-btn text-xs px-2 py-0.5",style:"background: var(--status-healthy-glow); color: var(--status-healthy); border: none;",onClick:()=>o(b.map(h=>h.entity_id),"included")},"Approve All"),e("button",{class:"t-btn text-xs px-2 py-0.5",style:"background: var(--status-error-glow); color: var(--status-error); border: none;",onClick:()=>o(b.map(h=>h.entity_id),"excluded")},"Reject All")))),e("div",{class:"space-y-1"},b.slice(0,Ws).map(h=>e(Bd,{key:h.entity_id,entity:h,onOverride:n,compact:!0})),b.length>Ws&&e("p",{class:"text-xs",style:"color: var(--text-tertiary)"},"...and ",b.length-Ws," more")))):e("div",{class:"space-y-1"},y.slice(0,Vs).map(m=>e(Bd,{key:m.entity_id,entity:m,onOverride:n})),y.length>Vs&&e("p",{class:"text-xs",style:"color: var(--text-tertiary)"},"Showing ",Vs," of ",y.length,". Use search to narrow."))))}function Bd({entity:t,onOverride:a,compact:r}){let s=pm[t.status]||"background: var(--bg-surface-raised); color: var(--text-secondary);";return e("div",{class:`flex items-center gap-2 ${r?"py-0.5":"py-1.5"}`,style:r?"":"border-bottom: 1px solid var(--border-subtle)"},e("span",{class:"text-xs truncate flex-1 data-mono",style:"color: var(--text-secondary)"},t.entity_id),e("span",{class:"text-[10px] font-medium flex-shrink-0 px-1.5 py-0.5",style:`border-radius: var(--radius); ${s}`},t.status),t.human_override&&e("span",{class:"text-[10px] flex-shrink-0",style:"color: var(--accent-dim)"},"manual"),!r&&e("div",{class:"flex gap-1 flex-shrink-0"},t.status!=="included"&&e("button",{class:"text-[10px]",style:"color: var(--status-healthy)",onClick:()=>a(t.entity_id,"included")},"Include"),t.status!=="excluded"&&e("button",{class:"text-[10px]",style:"color: var(--status-error)",onClick:()=>a(t.entity_id,"excluded")},"Exclude")))}function Zo(){let[t,a]=N([]),[r,s]=N(null),[n,o]=N(!0),[l,i]=N(null);async function u(){o(!0),i(null);try{let[h,C]=await Promise.all([de("/api/curation"),de("/api/curation/summary")]);a(h.curations||[]),s(C)}catch(h){i(h.message||String(h))}finally{o(!1)}}async function d(h,C){try{await fa(`/api/curation/${h}`,{status:C}),await u()}catch(A){console.error("Override failed:",A)}}async function y(h,C){try{await _s("/api/curation/bulk",{entity_ids:h,status:C}),await u()}catch(A){console.error("Bulk update failed:",A)}}le(()=>{u()},[]);let f=t.filter(h=>h.tier===1),m=t.filter(h=>h.tier===2),b=t.filter(h=>h.tier===3);return n&&t.length===0?e("div",{class:"space-y-6"},e("div",null,e("h1",{class:"text-2xl font-bold",style:"color: var(--text-primary)"},"Data Curation"),e("p",{class:"text-sm",style:"color: var(--text-tertiary)"},"Classify entities into include/exclude tiers for the shadow engine.")),e(Se,{type:"full"})):l?e("div",{class:"space-y-6"},e("div",null,e("h1",{class:"text-2xl font-bold",style:"color: var(--text-primary)"},"Data Curation"),e("p",{class:"text-sm",style:"color: var(--text-tertiary)"},"Classify entities into include/exclude tiers for the shadow engine.")),e(we,{error:l,onRetry:u})):t.length===0?e("div",{class:"space-y-6"},e(ie,{page:"CURATION",subtitle:"Entity-level noise control and classification."}),e("div",{class:"t-callout",style:"padding: 1rem;"},e("span",{class:"text-sm",style:"color: var(--text-secondary)"},"No entity classifications yet. The data quality module will classify entities after discovery runs."))):e("div",{class:"space-y-6 animate-page-enter"},e(ie,{page:"CURATION",subtitle:"Entity-level noise control and classification."}),e(Fe,{value:r?.per_status?.included??0,label:"entities included",delta:`${r?.per_status?.excluded??0} excluded`}),e(fm,{summary:r}),e("div",{class:"space-y-4 stagger-children"},e(Jo,{tier:1,label:"Auto-Excluded",entities:f,defaultOpen:!1,onOverride:d,onBulk:y}),e(Jo,{tier:2,label:"Edge Cases",entities:m,defaultOpen:!0,onOverride:d,onBulk:y}),e(Jo,{tier:3,label:"Included",entities:b,defaultOpen:!0,onOverride:d,onBulk:y})))}var jd=[{day:"Day 1",title:"Collecting",desc:"Connects to Home Assistant and starts watching. Every light switch, door sensor, thermostat change, and motion event gets recorded. Zero configuration."},{day:"Days 2\u20133",title:"Baselines",desc:'After 24 hours, ARIA knows what "normal" looks like. Builds hourly averages for every metric \u2014 lights on at 8pm, power draw at noon, motion patterns.'},{day:"Days 3\u20137",title:"ML Training",desc:"Six ML algorithms start training \u2014 predicting which room activates next, when devices turn on, energy patterns. Models improve with every snapshot."},{day:"Week 2+",title:"Shadow Mode",desc:'Predicts silently and scores itself. "What I predicted" vs "what happened." Accuracy climbs daily. Nothing changes in your home yet.'},{day:"When ready",title:"Suggestions",desc:"Once accuracy gates pass, generates automation YAML. You review and approve each one. Nothing runs without your sign-off."}],vm=[{title:"Home",path:"/",desc:"Live pipeline flowchart \u2014 data flow, module health, status chips."},{title:"Discovery",path:"/discovery",desc:"Every entity, device, and area HA knows about. Unavailable devices flagged."},{title:"Capabilities",path:"/capabilities",desc:"Detected capabilities \u2014 lighting, climate, presence. Scopes automations to your setup."},{title:"Data Curation",path:"/data-curation",desc:"Include or exclude entities. Filter noisy sensors that confuse models."},{title:"Intelligence",path:"/intelligence",desc:"Baselines, predictions vs actuals, trends, correlations, daily LLM insights."},{title:"Predictions",path:"/predictions",desc:"ML outputs with confidence scores. Green/yellow/red. Improves daily."},{title:"Patterns",path:"/patterns",desc:"Recurring event sequences \u2014 basis for automation suggestions."},{title:"Shadow Mode",path:"/shadow",desc:"Accuracy tracking, disagreements, pipeline stage progression."},{title:"Automations",path:"/automations",desc:"Ready-to-use YAML from detected patterns. Review, approve, or reject."},{title:"Settings",path:"/settings",desc:"Engine parameters \u2014 thresholds, schedules, weights. Defaults work well."}],Ud=[{q:"Does ARIA send my data anywhere?",a:"No. scikit-learn for ML, optionally Ollama for LLM. Zero data leaves your network."},{q:"Will it change my HA setup?",a:"Never without permission. Read-only from HA. Suggestions require manual approval."},{q:"How long until it's useful?",a:"Baselines within 24h. Patterns in 2\u20133 days. ML predictions after a week. Solid suggestions in 2\u20133 weeks."},{q:'Why does everything show "Blocked"?',a:"Normal for the first few days. Each module waits for upstream data. Home page shows exactly what\u2019s needed."},{q:"What is Shadow Mode?",a:"Silent predictions compared to reality. Like a co-pilot building a track record before acting."},{q:"Do I need to configure anything?",a:"No. Auto-discovers devices, classifies entities, builds models. Data Curation lets you fine-tune if needed."}],mm=[{term:"Entity",def:"Anything HA tracks \u2014 light, sensor, lock, motion detector."},{term:"Baseline",def:'Hourly averages of "normal." Flags when something is unusual for that time of day.'},{term:"Shadow Prediction",def:"Silent prediction scored against reality. Builds track record before action."},{term:"Pipeline",def:"Data path: collection \u2192 learning \u2192 action. Each stage gates the next."},{term:"Curation",def:"Choosing which entities ARIA watches. Filters noise so models learn clean signals."},{term:"Accuracy Gate",def:"Quality checkpoint. No suggestions until predictions hit minimum accuracy."}];function ym(){return e("div",{class:"relative overflow-hidden px-6 py-8 mb-6 t-terminal-bg",style:"background: var(--bg-surface); border-radius: var(--radius);"},e("div",{class:"absolute inset-0 pointer-events-none",style:"opacity: 0.04"},e("div",{class:"t1-scan-line",style:"width: 100%; height: 2px; background: var(--accent);"})),e("div",{class:"relative"},e(ie,{page:"GUIDE",subtitle:"How ARIA learns and what each page does."}),e("p",{class:"text-lg font-semibold leading-snug mb-3 animate-fade-in delay-200",style:"color: var(--text-primary);"},"Your home generates 22,000+ events every day."," ",e("span",{style:"color: var(--accent);"},"ARIA learns what they mean.")),e("p",{class:"text-sm leading-relaxed animate-fade-in delay-300",style:"color: var(--text-tertiary);"},"Local ML. No cloud. No subscriptions. Watches Home Assistant, learns patterns, generates automation suggestions.")))}function gm(){return e("div",{class:"px-4 py-3 mb-6",style:"background: var(--bg-surface-raised); border-left: 3px solid var(--accent); border-radius: var(--radius);"},e("p",{class:"text-sm",style:"color: var(--text-secondary);"},e("span",{class:"font-semibold",style:"color: var(--accent);"},"Fully local.")," ","ML via scikit-learn, optional LLM via Ollama. No API calls, no telemetry, no cloud accounts."))}function xm(){return e("div",{class:"mb-6 overflow-hidden",style:"background: var(--bg-surface-raised); border-radius: var(--radius);"},e("div",{class:"px-5 pt-4 pb-2"},e("h2",{class:"text-sm font-bold uppercase tracking-wider",style:"color: var(--accent); letter-spacing: 0.06em;"},"How ARIA Learns")),e("div",{class:"px-5 pb-4"},e("div",{class:"space-y-0 stagger-children"},jd.map((t,a)=>e("div",{key:a,class:"flex gap-4 items-start py-3",style:a<jd.length-1?"border-bottom: 1px solid var(--border-subtle);":""},e("div",{class:"shrink-0 w-6 h-6 flex items-center justify-center text-xs font-bold",style:"background: var(--accent); color: var(--bg-surface); border-radius: var(--radius);"},a+1),e("div",{class:"flex-1 min-w-0"},e("div",{class:"flex items-baseline gap-2 mb-0.5"},e("span",{class:"text-xs",style:"color: var(--accent-dim); font-family: var(--font-mono);"},t.day),e("span",{class:"text-sm font-semibold",style:"color: var(--text-primary);"},t.title)),e("p",{class:"text-sm leading-relaxed",style:"color: var(--text-tertiary);"},t.desc)))))))}function bm(){return e("div",{class:"mb-6 overflow-hidden",style:"background: var(--bg-surface-raised); border-radius: var(--radius);"},e("div",{class:"px-5 pt-4 pb-2"},e("h2",{class:"text-sm font-bold uppercase tracking-wider",style:"color: var(--accent); letter-spacing: 0.06em;"},"Key Concepts")),e("div",{class:"px-5 pb-4 grid grid-cols-1 sm:grid-cols-2 gap-3 stagger-children"},mm.map((t,a)=>e("div",{key:a,class:"px-3 py-2.5",style:"background: var(--bg-surface); border: 1px solid var(--border-subtle); border-radius: var(--radius);"},e("h3",{class:"text-sm font-bold mb-0.5",style:"color: var(--accent);"},t.term),e("p",{class:"text-xs leading-relaxed",style:"color: var(--text-tertiary);"},t.def)))))}function hm(){return e("div",{class:"mb-6 overflow-hidden",style:"background: var(--bg-surface-raised); border-radius: var(--radius);"},e("div",{class:"px-5 pt-4 pb-2"},e("h2",{class:"text-sm font-bold uppercase tracking-wider",style:"color: var(--accent); letter-spacing: 0.06em;"},"Pages")),e("div",{class:"stagger-children"},vm.map((t,a)=>e("a",{key:a,href:`#${t.path}`,class:"flex items-baseline gap-3 px-5 py-2.5 transition-colors",style:"border-bottom: 1px solid var(--border-subtle);",onMouseEnter:r=>{r.currentTarget.style.background="var(--bg-surface)"},onMouseLeave:r=>{r.currentTarget.style.background="transparent"}},e("span",{class:"text-sm font-semibold shrink-0",style:"color: var(--accent); min-width: 7rem;"},t.title),e("span",{class:"text-sm",style:"color: var(--text-tertiary);"},t.desc)))))}function _m(){return e("div",{class:"mb-6 overflow-hidden",style:"background: var(--bg-surface-raised); border-radius: var(--radius);"},e("div",{class:"px-5 pt-4 pb-2"},e("h2",{class:"text-sm font-bold uppercase tracking-wider",style:"color: var(--accent); letter-spacing: 0.06em;"},"FAQ")),e("div",{class:"px-5 pb-4 space-y-0 stagger-children"},Ud.map((t,a)=>e("div",{key:a,class:"py-3",style:a<Ud.length-1?"border-bottom: 1px solid var(--border-subtle);":""},e("h3",{class:"text-sm font-semibold mb-1",style:"color: var(--text-primary);"},t.q),e("p",{class:"text-sm leading-relaxed",style:"color: var(--text-tertiary);"},t.a)))))}function Qo(){return e("div",{class:"max-w-3xl mx-auto animate-page-enter"},e(ym,null),e(gm,null),e(xm,null),e(bm,null),e(hm,null),e(_m,null),e("div",{class:"text-center pb-6"},e("a",{href:"#/",class:"inline-flex items-center gap-2 px-5 py-2.5 text-sm font-semibold transition-colors",style:"background: var(--accent); color: var(--bg-surface); border-radius: var(--radius);"},"Go to Dashboard")))}var Wd={camera_person:"Camera",camera_face:"Face ID",motion:"Motion",light_interaction:"Light",dimmer_press:"Dimmer",door:"Door",device_tracker:"Tracker"},Xo={camera_person:"var(--accent)",camera_face:"var(--status-healthy)",motion:"var(--accent-purple)",light_interaction:"var(--accent-warm)",dimmer_press:"var(--accent-warm)",door:"var(--text-secondary)",device_tracker:"var(--status-healthy)"};function wm({value:t}){let a=Math.round(t*100),r=a>=70?"var(--status-healthy)":a>=30?"var(--status-warning)":"var(--accent)";return e("div",{class:"flex items-center gap-2"},e("div",{class:"flex-1 h-2 rounded-full",style:"background: var(--bg-inset)"},e("div",{class:"h-2 rounded-full transition-all",style:`width: ${a}%; background: ${r}; min-width: ${a>0?"4px":"0"}`})),e("span",{class:"text-xs font-bold",style:`color: ${r}; min-width: 32px; text-align: right;`},a,"%"))}function km({name:t,room:a}){let r=(a.signals||[]).length,s=(a.persons||[]).length,n=a.probability>=.5,o=a.signals&&a.signals.length>0?a.signals[a.signals.length-1]:null,l={};return(a.signals||[]).forEach(i=>{let u=i.type||"unknown";l[u]||(l[u]=0),l[u]++}),e("div",{class:"t-frame p-4",style:n?"border-left: 4px solid var(--status-healthy)":""},e("div",{class:"flex items-start justify-between mb-2"},e("div",null,e("div",{class:"text-sm font-bold",style:"color: var(--text-primary); text-transform: capitalize;"},t.replace(/_/g," ")),e("div",{class:"text-xs mt-0.5",style:"color: var(--text-tertiary)"},r," signal",r!==1?"s":"",s>0&&` \xB7 ${s} identified`)),e("span",{class:"text-xs font-medium rounded px-1.5 py-0.5",style:Us(a.probability)},a.confidence||(a.probability>=.7?"high":a.probability>=.3?"medium":"low"))),e(wm,{value:a.probability}),Object.keys(l).length>0&&e("div",{class:"flex flex-wrap gap-1.5 mt-2"},Object.entries(l).map(([i,u])=>e("span",{key:i,class:"text-xs rounded px-1.5 py-0.5",style:`background: var(--bg-surface-raised); color: ${Xo[i]||"var(--text-tertiary)"}`},Wd[i]||i," (",u,")"))),o&&e("div",{class:"text-xs mt-2 truncate",style:"color: var(--text-tertiary)",title:o.detail},o.detail))}function Sm({name:t,info:a}){return e("div",{class:"flex items-center gap-3 py-2",style:"border-bottom: 1px solid var(--border-subtle)"},e("div",{class:"flex items-center justify-center rounded-full",style:"width: 32px; height: 32px; background: var(--accent-glow); color: var(--accent); font-weight: 700; font-size: 14px; flex-shrink: 0;"},(t||"?")[0].toUpperCase()),e("div",{class:"flex-1 min-w-0"},e("div",{class:"text-sm font-medium truncate",style:"color: var(--text-primary); text-transform: capitalize;"},t),e("div",{class:"text-xs",style:"color: var(--text-tertiary)"},a.room?a.room.replace(/_/g," "):"Unknown room",a.confidence!=null&&` \xB7 ${Math.round(a.confidence*100)}%`)),a.last_seen&&e("div",{class:"text-xs flex-shrink-0",style:"color: var(--text-tertiary)"},St(a.last_seen)))}function Am({cameraRooms:t}){return!t||Object.keys(t).length===0?null:e("div",{class:"flex flex-wrap gap-2"},Object.entries(t).map(([a,r])=>e("div",{key:a,class:"text-xs rounded px-2 py-1",style:"background: var(--bg-surface-raised); color: var(--text-secondary);"},e("span",{style:"color: var(--status-healthy);"},"\u25CF"," "),e("span",{style:"text-transform: capitalize;"},a.replace(/_/g," ")),e("span",{style:"color: var(--text-tertiary);"}," \\u2192 ",r.replace(/_/g," ")))))}function Cm({rooms:t}){let a=[];Object.entries(t||{}).forEach(([s,n])=>{(n.signals||[]).forEach((o,l)=>{a.push({...o,room:s,_idx:l})})});let r=a.slice(-15).reverse();return r.length===0?e("p",{class:"text-sm",style:"color: var(--text-tertiary)"},"No signals received yet. Walk past a camera or trigger a motion sensor."):e("div",{class:"space-y-1"},r.map((s,n)=>{let o=Xo[s.type]||"var(--text-tertiary)";return e("div",{key:n,class:"flex items-center gap-2 py-1 px-1 rounded text-sm"},e("span",{class:"w-2 h-2 rounded-full flex-shrink-0",style:`background: ${o}`}),e("span",{class:"flex-1 truncate",style:"color: var(--text-secondary)",title:s.detail},s.detail||s.type),e("span",{class:"text-xs flex-shrink-0 rounded px-1",style:"background: var(--bg-surface-raised); color: var(--text-tertiary); text-transform: capitalize;"},s.room.replace(/_/g," ")))}))}function Tm({detection:t}){let r=t.event_id&&t.has_snapshot?`/api/frigate/thumbnail/${t.event_id}`:null;return e("div",{class:"t-frame p-2 flex gap-3",style:"min-width: 0;"},e("div",{class:"flex-shrink-0 rounded overflow-hidden",style:"width: 64px; height: 64px; background: var(--bg-inset);"},r?e("img",{src:r,alt:`Detection on ${t.camera}`,style:"width: 100%; height: 100%; object-fit: cover;",loading:"lazy"}):e("div",{class:"flex items-center justify-center w-full h-full",style:"color: var(--text-tertiary); font-size: 20px;"},"\u{1F464}")),e("div",{class:"flex-1 min-w-0"},e("div",{class:"flex items-center gap-2"},t.sub_label?e("span",{class:"text-sm font-bold",style:"color: var(--status-healthy); text-transform: capitalize;"},t.sub_label):e("span",{class:"text-sm font-medium",style:"color: var(--text-secondary)"},"Unknown person"),e("span",{class:"text-xs rounded px-1",style:"background: var(--bg-surface-raised); color: var(--text-tertiary);"},Math.round((t.score||0)*100),"%")),e("div",{class:"text-xs mt-0.5",style:"color: var(--text-tertiary); text-transform: capitalize;"},t.camera.replace(/_/g," ")," \\u2192 ",t.room.replace(/_/g," ")),t.timestamp&&e("div",{class:"text-xs mt-0.5",style:"color: var(--text-tertiary)"},St(t.timestamp))))}function Mm({faceConfig:t,labeledFaces:a}){let r=t&&t.enabled,s=t&&t.config||{},n=t&&t.labeled_count||0,o=a||{};return e("div",{class:"space-y-3"},e("div",{class:"flex flex-wrap gap-3"},e("div",{class:"t-frame p-3 flex-1",style:"min-width: 120px;"},e("div",{class:"text-xs",style:"color: var(--text-tertiary)"},"Status"),e("div",{class:"flex items-center gap-1.5 mt-1"},e("span",{class:"inline-block w-2 h-2 rounded-full",style:`background: ${r?"var(--status-healthy)":"var(--status-error)"}`}),e("span",{class:"text-sm font-medium",style:`color: ${r?"var(--status-healthy)":"var(--status-error)"}`},r?"Active":"Disabled"))),e("div",{class:"t-frame p-3 flex-1",style:"min-width: 120px;"},e("div",{class:"text-xs",style:"color: var(--text-tertiary)"},"Labeled Faces"),e("div",{class:"text-xl font-bold mt-1",style:`color: ${n>0?"var(--accent)":"var(--text-tertiary)"}`},n)),e("div",{class:"t-frame p-3 flex-1",style:"min-width: 120px;"},e("div",{class:"text-xs",style:"color: var(--text-tertiary)"},"Threshold"),e("div",{class:"text-sm font-bold mt-1",style:"color: var(--text-primary)"},s.recognition_threshold?`${Math.round(s.recognition_threshold*100)}%`:"--")),e("div",{class:"t-frame p-3 flex-1",style:"min-width: 120px;"},e("div",{class:"text-xs",style:"color: var(--text-tertiary)"},"Model"),e("div",{class:"text-sm font-medium mt-1",style:"color: var(--text-primary)"},s.model_size||"--"))),Object.keys(o).length>0&&e("div",null,e("div",{class:"text-xs font-medium mb-1.5",style:"color: var(--text-secondary)"},"Known Faces"),e("div",{class:"flex flex-wrap gap-2"},Object.entries(o).map(([l,i])=>e("span",{key:l,class:"text-xs rounded px-2 py-1",style:"background: var(--accent-glow); color: var(--accent); text-transform: capitalize;"},l," (",i," sample",i!==1?"s":"",")")))),n===0&&r&&e(me,null,"No faces labeled yet. Frigate automatically collects face samples from person detections. To enable face recognition: open Frigate UI, go to a person event, and assign a name to the detected face. After labeling ",s.min_faces||2,"+ samples per person, ARIA will identify them automatically across all cameras."))}function el(){let{data:t,loading:a,error:r,refetch:s}=He("presence");if(a&&!t)return e(Se,{type:"cards"});if(r)return e(we,{error:r,onRetry:s});let n=t&&t.data||{},o=n.rooms||{},l=n.occupied_rooms||[],i=n.identified_persons||{},u=n.camera_rooms||{},d=n.mqtt_connected,y=n.face_recognition||{},f=n.recent_detections||[],m=Object.keys(o),b=Object.keys(i),h=m.reduce((k,S)=>k+(o[S].signals||[]).length,0),C=Object.keys(u).length,A=l.length,M=A===1?"1 room occupied":`${A} rooms occupied`,_=new Set(f.map(k=>k.camera));return e("div",{class:"space-y-6 animate-page-enter"},e(ie,{page:"PRESENCE",subtitle:"Room-level occupancy from cameras, motion sensors, and device signals fused through Bayesian probability."}),e("div",{class:"flex items-center gap-3 flex-wrap"},e("div",{class:"flex items-center gap-2 text-xs"},e("span",{class:"inline-block w-2.5 h-2.5 rounded-full",style:`background: ${d?"var(--status-healthy)":"var(--status-error)"}`}),e("span",{style:`color: ${d?"var(--status-healthy)":"var(--status-error)"}`},"MQTT ",d?"Connected":"Disconnected")),e("div",{class:"text-xs",style:"color: var(--text-tertiary)"},m.length," room",m.length!==1?"s":""," \\u00B7 ",h," signal",h!==1?"s":""," \\u00B7 ",C," camera",C!==1?"s":"",_.size>0&&` \xB7 ${_.size} detecting`)),!d&&e(me,null,"MQTT is disconnected. Camera-based presence signals are unavailable. Check that Frigate and Mosquitto are running."),e("div",{class:"grid grid-cols-1 lg:grid-cols-3 gap-4"},e("div",{class:"t-frame p-4",style:`border-left: 4px solid ${A>0?"var(--status-healthy)":"var(--border-subtle)"}`},e("div",{class:"text-4xl font-bold",style:`color: ${A>0?"var(--status-healthy)":"var(--text-tertiary)"}`},A),e("div",{class:"text-sm mt-1",style:"color: var(--text-tertiary)"},M),l.length>0&&e("div",{class:"text-xs mt-1",style:"color: var(--text-secondary); text-transform: capitalize;"},l.map(k=>k.replace(/_/g," ")).join(", "))),e("div",{class:"lg:col-span-2 t-frame p-4","data-label":"who's home"},b.length===0?e("div",null,e("p",{class:"text-sm",style:"color: var(--text-tertiary)"},"No identified persons yet."),e("p",{class:"text-xs mt-1",style:"color: var(--text-tertiary)"},"Face recognition builds over time. Frigate collects unknown faces automatically",y.labeled_count>0?` \u2014 ${y.labeled_count} face${y.labeled_count!==1?"s":""} labeled so far.`:" \u2014 label them in the Frigate UI to enable identification.")):e("div",null,b.map(k=>e(Sm,{key:k,name:k,info:i[k]}))))),e(ee,{title:"Recent Detections",subtitle:"Person detections across all cameras, newest first. Thumbnails from Frigate event snapshots.",summary:`${f.length} events`,defaultOpen:f.length>0},f.length===0?e(me,null,"No person detections yet. Walk past a camera to trigger a detection event."):e("div",{class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3"},f.slice(0,12).map((k,S)=>e(Tm,{key:k.event_id||S,detection:k})))),e(ee,{title:"Room Occupancy",subtitle:"Per-room probability from fused sensor signals. Rooms above 50% are considered occupied.",summary:`${m.length} rooms`},m.length===0?e(me,null,"No rooms detected yet. Rooms appear when cameras detect people or HA sensors report activity in mapped areas."):e("div",{class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"},m.sort((k,S)=>(o[S].probability||0)-(o[k].probability||0)).map(k=>e(km,{key:k,name:k,room:o[k]})))),e(ee,{title:"Face Recognition",subtitle:"Frigate collects face samples from person detections. Label faces in the Frigate UI to enable cross-camera identification.",summary:y.enabled?`${y.labeled_count||0} labeled`:"disabled",defaultOpen:!1},e(Mm,{faceConfig:y,labeledFaces:y.labeled_faces||{}})),e(ee,{title:"Signal Feed",subtitle:"Recent detection events across all rooms. Each signal decays over time based on its type.",summary:`${h} active`,defaultOpen:h>0},e("div",{class:"t-frame p-4","data-label":"signals"},e(Cm,{rooms:o})),e("div",{class:"flex flex-wrap items-center gap-3 mt-3",style:"font-size: 10px; color: var(--text-tertiary);"},Object.entries(Wd).map(([k,S])=>e("div",{key:k,class:"flex items-center gap-1"},e("span",{class:"inline-block w-2 h-2 rounded-full",style:`background: ${Xo[k]}`}),e("span",null,S))))),e(ee,{title:"Cameras",subtitle:"Active camera-to-room mappings. Cameras publish person detections to MQTT via Frigate.",summary:`${C} mapped`,defaultOpen:!1},e("div",{class:"t-frame p-4","data-label":"camera map"},e(Am,{cameraRooms:u}))))}function Em(){let t=[];function a(){let n=(window.location.hash||"#/").replace(/^#/,"")||"/",o=n.indexOf("?");return{pathname:o>=0?n.slice(0,o):n,search:o>=0?n.slice(o):""}}function r(){let s=a();t.forEach(n=>n({location:s}))}return window.addEventListener("hashchange",r),window.location.hash||(window.location.hash="#/"),{get location(){return a()},listen(s){return t.push(s),()=>{let n=t.indexOf(s);n>=0&&t.splice(n,1)}},push(s){window.location.hash="#"+s},replace(s){let n=window.location.pathname+window.location.search+"#"+s;window.history.replaceState(null,"",n),window.dispatchEvent(new HashChangeEvent("hashchange"))}}}var Pm=Em(),tl=class extends Jt{state={error:null};componentDidCatch(a){this.setState({error:a})}render(){return this.state.error?e(we,{error:this.state.error,onRetry:()=>this.setState({error:null})}):this.props.children}};function al(){return le(()=>(Hn(),()=>ki()),[]),e("div",{class:"min-h-screen",style:"background: var(--bg-base); color: var(--text-primary); transition: background 0.3s ease, color 0.3s ease;"},e(Wn,null),e("main",{class:"lg:ml-60 sm:ml-14 pb-16 sm:pb-0 min-h-screen"},e("div",{class:"max-w-7xl mx-auto px-4 py-6 sm:px-6 lg:px-8"},e(tl,null,e(Ln,{history:Pm},e(Co,{path:"/"}),e(Lo,{path:"/discovery"}),e(Io,{path:"/capabilities"}),e(Oo,{path:"/predictions"}),e(Ho,{path:"/patterns"}),e(Fo,{path:"/automations"}),e(Uo,{path:"/intelligence"}),e(qo,{path:"/ml-engine"}),e(Yo,{path:"/shadow"}),e(Ko,{path:"/settings"}),e(Zo,{path:"/data-curation"}),e(el,{path:"/presence"}),e(Qo,{path:"/guide"}))))))}Yl(e(al,null),document.getElementById("app"));
